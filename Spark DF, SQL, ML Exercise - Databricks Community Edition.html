<!DOCTYPE html>
<!-- saved from url=(0107)https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298405 -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="google" content="notranslate">
    <meta http-equiv="Content-Language" content="en">

    <title>Spark DF, SQL, ML Exercise - Databricks Community Edition</title>
<link rel="shortcut icon" href="https://community.cloud.databricks.com/favicon.ico"><link href="./Spark DF, SQL, ML Exercise - Databricks Community Edition_files/main.6c99dd10.css" rel="stylesheet"><link href="./Spark DF, SQL, ML Exercise - Databricks Community Edition_files/print.6c99dd10.css" rel="stylesheet" media="print"><style data-emotion=""></style><style id="plotly.js-style-global"></style></head>
<body>
<noscript>
    You need to enable JavaScript to run this app.
</noscript>


<div id="toolbar"></div>
<div id="tooltip" class="hidden">
    <p><span id="value"></span></p>
</div>

<div id="global-notification-container"><div class="databricks-notification-wrapper"><div class="notifications-wrapper"></div></div></div>

<div id="topbar" style="">
    <div class="tb-title-wrapper tb-title-wrapper-central" style="left: 76px;">
        <span class="tb-title" data-name="Spark DF, SQL, ML Exercise"><span class="notebook-title-wrapper"><span id="nbTitle">Spark DF, SQL, ML Exercise</span></span></span>
        <span class="tb-title-lang" data-lang="python">(Python)</span>
        <div class="tb-status">
            <span class="tb-status-msg tb-status-msg-error"></span>
            <span class="tb-status-msg tb-status-msg-banner"></span>
            <span class="tb-status-msg tb-status-msg-locked"></span>
            <span class="tb-status-msg tb-status-msg-connecting">Connecting...&nbsp;</span>
            <span class="tb-status-msg tb-status-msg-waiting">Still working...&nbsp;</span>
            <img class="tb-status-spinner" src="./Spark DF, SQL, ML Exercise - Databricks Community Edition_files/spinner.gif" alt="spinner">
        </div>
    </div>
    <div class="tb-title-wrapper tb-title-wrapper-right">
        <div class="tb-trial-msg"></div>
        <div class="tb-title-icons tb-title-icons-right"></div>
        <div class="tb-status presence">
            <span class="tb-status-msg tb-status-presence" style="display: inline;"><!-- presenceTemplate -->

<ul class="noselect">
  
  <li title="Recent Activity" class="presence-history">
    <div><i class="fa fa-clock-o"></i></div>
  </li>
</ul>

</span>
        </div>
    </div>
    <a class="tb-button tb-button-right tb-button-user" title="Account">
        <i class="fa fa-user fa-lg"></i>
    </a>
    <a class="tb-button tb-button-right tb-button-help" title="Help and Support">
        <i class="fa fa-question fa-lg"></i>
    </a>
    <a class="tb-button tb-button-right tb-button-upgrade" title="Upgrade" target="_blank" href="https://accounts.cloud.databricks.com/registration.html#login" style="display: none;">
    <span>
        <i class="fa fa-arrow-circle-up"></i>Upgrade
    </span>
    </a>
</div>

<div id="sidebar-and-notebook">
    <div id="sidebar" class="sidebar"><div class="sidebar-outer"><div class="sidebar-main" data-panel="Workspace"><ul class="sidebar-ul"><li><a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="sidebar-element" data-name="Databricks"><div class="sidebar-element-icon"><div class="sidebar-element-icon-inner"><img src="./Spark DF, SQL, ML Exercise - Databricks Community Edition_files/Databricks_Logo_Side_Nav_Gray.81457fbd.svg" alt="databricks-logo"></div></div><div><span>databricks</span></div></a></li><div class="sidebar-spacer"></div><li><a class="sidebar-element" data-name="Home"><div class="sidebar-element-icon"><div class="sidebar-element-icon-inner"><i class="fa fa-fw fa-home"></i></div></div><div><span>Home</span></div></a></li><li><a class="sidebar-element selected" data-name="Workspace"><div class="sidebar-element-icon"><div class="sidebar-element-icon-inner"><i class="fa fa-fw fa-folder-open-o"></i></div></div><div><span>Workspace</span></div></a></li><li><a class="sidebar-element" data-name="Recents"><div class="sidebar-element-icon"><div class="sidebar-element-icon-inner"><i class="fa fa-fw fa-clock-o"></i></div></div><div><span>Recents</span></div></a></li><div class="sidebar-spacer"></div><li><a class="sidebar-element" data-name="Tables"><div class="sidebar-element-icon"><div class="sidebar-element-icon-inner"><i class="fa fa-fw fa-database"></i></div></div><div><span>Data</span></div></a></li><li><a href="https://community.cloud.databricks.com/?o=2015575843351761#setting/clusters" class="sidebar-element" data-name="Clusters"><div class="sidebar-element-icon"><div class="sidebar-element-icon-inner"><i class="fa fa-fw fa-sitemap"></i></div></div><div><span>Clusters</span></div></a></li><li><a href="https://community.cloud.databricks.com/?o=2015575843351761#joblist" class="sidebar-element" data-name="Jobs"><div class="sidebar-element-icon"><div class="sidebar-element-icon-inner"><i class="fa fa-fw fa-calendar"></i></div></div><div><span>Jobs</span></div></a></li><li><a class="sidebar-element" data-name="Search"><div class="sidebar-element-icon"><div class="sidebar-element-icon-inner"><i class="fa fa-fw fa-search"></i></div></div><div><span>Search</span></div></a></li></ul></div><div class="sidebar-alt"><div></div></div></div></div>
    <div id="overallView" style="left: 76px;" class="new-notebook"><div style="height: 100%;"><div><div class="databricks-notification-wrapper"><div class="notifications-wrapper"></div></div><div class="new-notebook context-bar" id="context-bar"><div class="context-bar__left"><div class="attach-cluster-select-wrapper"><i class="fa fa-sitemap" style="text-align: center;"></i><div class="css-fowcdj-container control-field clusters attach-cluster-select"><div class="css-1kbq6lx-control react-select__control"><div class="css-1g471u6 react-select__value-container"><div class="css-151xaom-placeholder react-select__placeholder">Detached</div><div class="css-92gm0r"><div class="react-select__input" style="display: inline-block;"><input autocapitalize="none" autocomplete="off" autocorrect="off" id="react-select-2-input" spellcheck="false" tabindex="0" type="text" aria-autocomplete="list" value="" style="box-sizing: content-box; width: 2px; background: 0px center; border: 0px; font-size: inherit; opacity: 1; outline: 0px; padding: 0px; color: inherit;"><div style="position: absolute; top: 0px; left: 0px; visibility: hidden; height: 0px; overflow: scroll; white-space: pre; font-size: 13px; font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif, FontAwesome; font-weight: 400; font-style: normal; letter-spacing: normal; text-transform: none;"></div></div></div></div><div class="css-1wy0on6 react-select__indicators"><span class="css-bgvzuu-indicatorSeparator react-select__indicator-separator"></span><div aria-hidden="true" class="css-acgw76-indicatorContainer react-select__indicator react-select__dropdown-indicator"><svg height="20" width="20" viewBox="0 0 20 20" aria-hidden="true" focusable="false" class="css-19bqh2r"><path d="M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"></path></svg></div></div></div></div></div><div class="dropdown actions-dropdown"><div class="tooltip-react-outer"><div class="tooltip-react-element"><div class="highlight-inactive"><a class="context-bar-item" id="actions-dropdown-link" data-name="File"><i class="fa fa-file-text-o contextBarIcon--js"></i> <span class="context-bar-link-text">File</span> <i class="fa fa-caret-down caretDown--js"></i></a></div></div><div id="actions-dropdown-link" class="tooltip-react-content" style="left: 10px; top: 26px; width: 200px;"><div class="tooltip-react-arrow" style="left: 36.5px;"></div><div class="tooltip-react-inner"></div></div></div></div><div class="dropdown view-dropdown"><div class="tooltip-react-outer"><div class="tooltip-react-element"><div class="highlight-inactive"><a class="context-bar-item" id="view-mode-link" data-name="View: Code"><i class="fa fa-picture-o contextBarIcon--js"></i> <span class="context-bar-link-text">View: Code</span> <i class="fa fa-caret-down caretDown--js"></i></a></div></div><div id="view-mode-link" class="tooltip-react-content" style="left: 10px; top: 26px; width: 200px;"><div class="tooltip-react-arrow" style="left: 60.5px;"></div><div class="tooltip-react-inner"></div></div></div></div><a class="no-click context-bar-item permissions" id="share" data-name="Permissions" disabled=""><i class="fa fa-lock contextBarIcon--js"></i> <span class="context-bar-link-text">Permissions</span></a><div class="tooltip-react-outer"><div class="tooltip-react-element"><div class="highlight-inactive"><a class="context-bar-item" id="0.4653299015679868" data-name="Run All"><i class="fa fa-play-circle-o contextBarIcon--js"></i> <span class="context-bar-link-text">Run All</span></a></div></div><div id="0.4653299015679868" class="tooltip-react-content" style="left: 501.388px; top: 26px; width: 200px;"><div class="tooltip-react-arrow" style="left: 100px;"></div><div class="tooltip-react-inner"></div></div></div><div class="dropdown clear-dropdown"><div class="tooltip-react-outer"><div class="tooltip-react-element"><div class="highlight-inactive"><a class="context-bar-item" id="clear-results-link" data-name="Clear"><i class="fa fa-eraser contextBarIcon--js"></i> <span class="context-bar-link-text">Clear</span> <i class="fa fa-caret-down caretDown--js"></i></a></div></div><div id="clear-results-link" class="tooltip-react-content" style="left: 10px; top: 26px; width: 200px;"><div class="tooltip-react-arrow" style="left: 43px;"></div><div class="tooltip-react-inner"></div></div></div></div></div><div class="context-bar__right"><div class="context-bar-right-links"><div id="shortcut-wrapper"><a class="shortcut-menu-icon"><i class="fa fa-keyboard-o"></i></a></div><a class="context-bar-item" id="publish-notebook" data-name="Publish"><i class="fa fa-share-square-o contextBarIcon--js"></i> <span class="context-bar-link-text">Publish</span></a><div class="tooltip-react-outer"><div class="tooltip-react-element"><div class="highlight-inactive"><a class="context-bar-item" id="show-comments" data-name="Comments"><i class="fa fa-comments contextBarIcon--js"></i> <span class="context-bar-link-text">Comments</span></a></div></div><div id="show-comments" class="tooltip-react-content" style="left: 1095.66px; top: 26.8px; width: 200px;"><div class="tooltip-react-arrow" style="left: 100px;"></div><div class="tooltip-react-inner"></div></div></div><a class="context-bar-item" id="view-mlflow-runs" data-name="Runs"><i class="view-mlflow-runs-icon contextBarIcon--js"></i> <span class="context-bar-link-text">Runs</span></a><div class="tooltip-react-outer"><div class="tooltip-react-element"><div class="highlight-inactive"><a class="context-bar-item" id="show-history" data-name="Revision history"><i class="fa fa-history contextBarIcon--js"></i> <span class="context-bar-link-text">Revision history</span></a></div></div><div id="show-history" class="tooltip-react-content" style="left: 1293.97px; top: 26.8px; width: 122.525px;"><div class="tooltip-react-arrow" style="left: 1393.97px;"></div><div class="tooltip-react-inner"></div></div></div></div></div></div><div id="content" class="new-notebook"><div class="notebook-view"><div id="notebook-input-widget-panel" class="input-widget-panel empty pinned"><ul></ul><div class="widget-panel-settings"><i class="settings fa fa-cog"></i><i class="pinning fa fa-thumb-tack pinned"></i></div></div><div class="new-notebook overallContainer" style="margin-top: 0px;"><div class="sessionPane"></div><div class="has-headings shell-top new-notebook"><img class="load-spinner" src="./Spark DF, SQL, ML Exercise - Databricks Community Edition_files/spinner.7eb0071e.svg"><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"><i class="fa fa-minus-square-o"></i></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298315"><i class="fa fa-link"></i>Cmd 1</a><div class="new-notebook command mainCommand command-finished cellIndex-0 cell-825169771298314-825169771298315"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-0 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-0 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>#</span><span>#</span><span>Exercise</span><span> </span><span>Overview</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span>In</span><span> </span><span>this</span><span> </span><span>exercise</span><span> </span><span>we</span><span> </span><span>will</span><span> </span><span>play</span><span> </span><span>with</span><span> </span><span>Spark</span><span> </span><span class="cm-link">[</span><span class="cm-link">Datasets</span><span class="cm-link"> </span><span class="cm-link">&amp;</span><span class="cm-link"> </span><span class="cm-link">Dataframes</span><span class="cm-link">]</span><span class="cm-string url">(</span><span class="cm-string url">https://spark.apache.org/docs/latest/sql-programming-guide.html#datasets-and-dataframes</span><span class="cm-string url">)</span><span>,</span><span> </span><span>some</span><span> </span><span class="cm-link">[</span><span class="cm-link">Spark</span><span class="cm-link"> </span><span class="cm-link">SQL</span><span class="cm-link">]</span><span class="cm-string url">(</span><span class="cm-string url">https://spark.apache.org/docs/latest/sql-programming-guide.html#sql</span><span class="cm-string url">)</span><span>,</span><span> </span><span>and</span><span> </span><span>build</span><span> </span><span>a</span><span> </span><span>couple</span><span> </span><span>of</span><span> </span><span>binary</span><span> </span><span>classifiaction</span><span> </span><span>models</span><span> </span><span>using</span><span> </span><span class="cm-link">[</span><span class="cm-link">Spark</span><span class="cm-link"> </span><span class="cm-link">ML</span><span class="cm-link">]</span><span class="cm-string url">(</span><span class="cm-string url">https://spark.apache.org/docs/latest/ml-guide.html</span><span class="cm-string url">)</span><span> </span><span>(</span><span>with</span><span> </span><span>some</span><span> </span><span class="cm-link">[</span><span class="cm-link">MLlib</span><span class="cm-link">]</span><span class="cm-string url">(</span><span class="cm-string url">https://spark.apache.org/mllib/</span><span class="cm-string url">)</span><span> </span><span>too).</span><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span class="cm-tag bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag bracket">&gt;</span><span class="cm-tag bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag bracket">&gt;</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">5</div></div><span>The</span><span> </span><span>set</span><span> </span><span>up</span><span> </span><span>and</span><span> </span><span>approach</span><span> </span><span>will</span><span> </span><span>not</span><span> </span><span>be</span><span> </span><span>too</span><span> </span><span>dissimilar</span><span> </span><span>to</span><span> </span><span>the</span><span> </span><span>standard</span><span> </span><span>type</span><span> </span><span>of</span><span> </span><span>approach</span><span> </span><span>you</span><span> </span><span>might</span><span> </span><span>do</span><span> </span><span>in</span><span> </span><span class="cm-link">[</span><span class="cm-link">Sklearn</span><span class="cm-link">]</span><span class="cm-string url">(</span><span class="cm-string url">http://scikit-learn.org/stable/index.html</span><span class="cm-string url">)</span><span>.</span><span> </span><span>Spark</span><span> </span><span>has</span><span> </span><span>matured</span><span> </span><span>to</span><span> </span><span>the</span><span> </span><span>stage</span><span> </span><span>now</span><span> </span><span>where</span><span> </span><span>for</span><span> </span><span>90%</span><span> </span><span>of</span><span> </span><span>what</span><span> </span><span>you</span><span> </span><span>need</span><span> </span><span>to</span><span> </span><span>do</span><span> </span><span>(</span><span>when</span><span> </span><span>analysing</span><span> </span><span>tabular</span><span> </span><span>data)</span><span> </span><span>should</span><span> </span><span>be</span><span> </span><span>possible</span><span> </span><span>with</span><span> </span><span>Spark</span><span> </span><span>dataframes,</span><span> </span><span>SQL,</span><span> </span><span>and</span><span> </span><span>ML</span><span> </span><span>libraries.</span><span> </span><span>This</span><span> </span><span>is</span><span> </span><span>where</span><span> </span><span>this</span><span> </span><span>exercise</span><span> </span><span>is</span><span> </span><span>mainly</span><span> </span><span>trying</span><span> </span><span>to</span><span> </span><span>focus.</span><span class="cm-trailing-space-a"> </span><span class="cm-trailing-space-new-line"> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">6</div></div><span class="cm-tag bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag bracket">&gt;</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">7</div></div><span>Feel</span><span> </span><span>free</span><span> </span><span>to</span><span> </span><span>adapt</span><span> </span><span>this</span><span> </span><span>exercise</span><span> </span><span>to</span><span> </span><span>play</span><span> </span><span>with</span><span> </span><span>other</span><span> </span><span>datasets</span><span> </span><span>readily</span><span> </span><span>availabe</span><span> </span><span>in</span><span> </span><span>the</span><span> </span><span>Databricks</span><span> </span><span>enviornment</span><span> </span><span>(</span><span>they</span><span> </span><span>are</span><span> </span><span>listed</span><span> </span><span>in</span><span> </span><span>a</span><span> </span><span>cell</span><span> </span><span>below).</span><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">8</div></div><span>#</span><span>#</span><span>#</span><span>#</span><span>#</span><span>Getting</span><span> </span><span>Started</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">9</div></div><span>To</span><span> </span><span>get</span><span> </span><span>started</span><span> </span><span>you</span><span> </span><span>will</span><span> </span><span>need</span><span> </span><span>to</span><span> </span><span>create</span><span> </span><span>and</span><span> </span><span>attach</span><span> </span><span>a</span><span> </span><span>databricks</span><span> </span><span>spark</span><span> </span><span>cluster</span><span> </span><span>to</span><span> </span><span>this</span><span> </span><span>notebook.</span><span> </span><span>This</span><span> </span><span>notebook</span><span> </span><span>was</span><span> </span><span>developed</span><span> </span><span>on</span><span> </span><span>a</span><span> </span><span>cluster</span><span> </span><span>created</span><span> </span><span>with</span><span>:</span><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">10</div></div><span class="cm-variable-2">- </span><span class="cm-variable-2">Databricks</span><span class="cm-variable-2"></span><span class="cm-variable-2"> </span><span class="cm-variable-2">Runtime</span><span class="cm-variable-2"> </span><span class="cm-variable-2">Version</span><span class="cm-variable-2"> </span><span class="cm-variable-2">4.0</span><span class="cm-variable-2"> </span><span class="cm-variable-2">(</span><span class="cm-variable-2">includes</span><span class="cm-variable-2"> </span><span class="cm-variable-2">Apache</span><span class="cm-variable-2"> </span><span class="cm-variable-2">Spark</span><span class="cm-variable-2"> </span><span class="cm-variable-2">2.3.0,</span><span class="cm-variable-2"> </span><span class="cm-variable-2">Scala</span><span class="cm-variable-2"> </span><span class="cm-variable-2">2.11)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">11</div></div><span class="cm-variable-2">- </span><span class="cm-variable-2">Python</span><span class="cm-variable-2"></span><span class="cm-variable-2"> </span><span class="cm-variable-2">Version</span><span class="cm-variable-2"> </span><span class="cm-variable-2">3</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">12</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">13</div></div><span>#</span><span>#</span><span>#</span><span>#</span><span>#</span><span>Links</span><span> </span><span>&amp;</span><span> </span><span>References</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">14</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">15</div></div><span>Some</span><span> </span><span>useful</span><span> </span><span>links</span><span> </span><span>and</span><span> </span><span>references</span><span> </span><span>of</span><span> </span><span>sources</span><span> </span><span>used</span><span> </span><span>in</span><span> </span><span>creating</span><span> </span><span>this</span><span> </span><span>exercise</span><span>:</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">16</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">17</div></div><span class="cm-strong">**</span><span class="cm-strong">Note</span><span class="cm-strong">**</span><span>:</span><span> </span><span>Right</span><span> </span><span>click</span><span> </span><span>and</span><span> </span><span>open</span><span> </span><span>as</span><span> </span><span>new</span><span> </span><span>tab</span><span>!</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">18</div></div><span class="cm-tag bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag bracket">&gt;</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">19</div></div><span class="cm-variable-2">1. </span><span class="cm-variable-2"></span><span class="cm-link variable-2">[</span><span class="cm-link variable-2">Latest</span><span class="cm-link variable-2"> </span><span class="cm-link variable-2">Spark</span><span class="cm-link variable-2"> </span><span class="cm-link variable-2">Docs</span><span class="cm-link variable-2">]</span><span class="cm-string url variable-2">(</span><span class="cm-string url variable-2">https://spark.apache.org/docs/latest/index.html</span><span class="cm-string url variable-2">)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">20</div></div><span class="cm-variable-2">1. </span><span class="cm-variable-2"></span><span class="cm-link variable-2">[</span><span class="cm-link variable-2">Databricks</span><span class="cm-link variable-2"> </span><span class="cm-link variable-2">Homepage</span><span class="cm-link variable-2">]</span><span class="cm-string url variable-2">(</span><span class="cm-string url variable-2">https://databricks.com/</span><span class="cm-string url variable-2">)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">21</div></div><span class="cm-variable-2">1. </span><span class="cm-variable-2"></span><span class="cm-link variable-2">[</span><span class="cm-link variable-2">Databricks</span><span class="cm-link variable-2"> </span><span class="cm-link variable-2">Community</span><span class="cm-link variable-2"> </span><span class="cm-link variable-2">Edition</span><span class="cm-link variable-2"> </span><span class="cm-link variable-2">FAQ</span><span class="cm-link variable-2">]</span><span class="cm-string url variable-2">(</span><span class="cm-string url variable-2">https://databricks.com/product/faq/community-edition</span><span class="cm-string url variable-2">)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">22</div></div><span class="cm-variable-2">1. </span><span class="cm-variable-2"></span><span class="cm-link variable-2">[</span><span class="cm-link variable-2">Databricks</span><span class="cm-link variable-2"> </span><span class="cm-link variable-2">Self</span><span class="cm-link variable-2"> </span><span class="cm-link variable-2">Paced</span><span class="cm-link variable-2"> </span><span class="cm-link variable-2">Training</span><span class="cm-link variable-2">]</span><span class="cm-string url variable-2">(</span><span class="cm-string url variable-2">https://databricks.com/training-overview/training-self-paced</span><span class="cm-string url variable-2">)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">23</div></div><span class="cm-variable-2">1. </span><span class="cm-variable-2"></span><span class="cm-link variable-2">[</span><span class="cm-link variable-2">Databricks</span><span class="cm-link variable-2"> </span><span class="cm-link variable-2">Notebook</span><span class="cm-link variable-2"> </span><span class="cm-link variable-2">Guide</span><span class="cm-link variable-2">]</span><span class="cm-string url variable-2">(</span><span class="cm-string url variable-2">https://docs.databricks.com/user-guide/notebooks/index.html</span><span class="cm-string url variable-2">)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">24</div></div><span class="cm-variable-2">1. </span><span class="cm-variable-2"></span><span class="cm-link variable-2">[</span><span class="cm-link variable-2">Databricks</span><span class="cm-link variable-2"> </span><span class="cm-link variable-2">Binary</span><span class="cm-link variable-2"> </span><span class="cm-link variable-2">Classification</span><span class="cm-link variable-2"> </span><span class="cm-link variable-2">Tutorial</span><span class="cm-link variable-2">]</span><span class="cm-string url variable-2">(</span><span class="cm-string url variable-2">https://docs.databricks.com/spark/latest/mllib/binary-classification-mllib-pipelines.html#binary-classification</span><span class="cm-string url variable-2">)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">25</div></div><span> </span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="0aa7d622-8fd3-411c-9320-ebd686f0c8b6" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h2>Exercise Overview</h2>
<p>In this exercise we will play with Spark <a href="https://spark.apache.org/docs/latest/sql-programming-guide.html#datasets-and-dataframes">Datasets &amp; Dataframes</a>, some <a href="https://spark.apache.org/docs/latest/sql-programming-guide.html#sql">Spark SQL</a>, and build a couple of binary classifiaction models using <a href="https://spark.apache.org/docs/latest/ml-guide.html">Spark ML</a> (with some <a href="https://spark.apache.org/mllib/">MLlib</a> too). 
<br><br>
The set up and approach will not be too dissimilar to the standard type of approach you might do in <a href="http://scikit-learn.org/stable/index.html">Sklearn</a>. Spark has matured to the stage now where for 90% of what you need to do (when analysing tabular data) should be possible with Spark dataframes, SQL, and ML libraries. This is where this exercise is mainly trying to focus.<br><br>
Feel free to adapt this exercise to play with other datasets readily availabe in the Databricks enviornment (they are listed in a cell below). </p>
<h5>Getting Started</h5>
<p>To get started you will need to create and attach a databricks spark cluster to this notebook. This notebook was developed on a cluster created with: </p>
<ul>
<li>Databricks Runtime Version 4.0 (includes Apache Spark 2.3.0, Scala 2.11)</li>
<li>Python Version 3</li>
</ul>
<h5>Links &amp; References</h5>
<p>Some useful links and references of sources used in creating this exercise:</p>
<p><strong>Note</strong>: Right click and open as new tab!
<br></p>
<ol>
<li><a href="https://spark.apache.org/docs/latest/index.html">Latest Spark Docs</a></li>
<li><a href="https://databricks.com/">Databricks Homepage</a></li>
<li><a href="https://databricks.com/product/faq/community-edition">Databricks Community Edition FAQ</a></li>
<li><a href="https://databricks.com/training-overview/training-self-paced">Databricks Self Paced Training</a></li>
<li><a href="https://docs.databricks.com/user-guide/notebooks/index.html">Databricks Notebook Guide</a></li>
<li><a href="https://docs.databricks.com/spark/latest/mllib/binary-classification-mllib-pipelines.html#binary-classification">Databricks Binary Classification Tutorial</a></li>
</ol>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"><i class="fa fa-minus-square-o"></i></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298316"><i class="fa fa-link"></i>Cmd 2</a><div class="new-notebook command mainCommand command-finished cellIndex-1 cell-825169771298314-825169771298316"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-1 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-1 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span>#</span><span>#</span><span>#</span><span>#</span><span>Get</span><span> </span><span>Data</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">5</div></div><span>Here</span><span> </span><span>we</span><span> </span><span>will</span><span> </span><span>pull</span><span> </span><span>in</span><span> </span><span>some</span><span> </span><span>sample</span><span> </span><span>data</span><span> </span><span>that</span><span> </span><span>is</span><span> </span><span>already</span><span> </span><span>pre-loaded</span><span> </span><span>onto</span><span> </span><span>all</span><span> </span><span>databricks</span><span> </span><span>clusters.</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">6</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">7</div></div><span>Feel</span><span> </span><span>free</span><span> </span><span>to</span><span> </span><span>adapt</span><span> </span><span>this</span><span> </span><span>notebook</span><span> </span><span>later</span><span> </span><span>to</span><span> </span><span>play</span><span> </span><span>around</span><span> </span><span>with</span><span> </span><span>a</span><span> </span><span>different</span><span> </span><span>dataset</span><span> </span><span>if</span><span> </span><span>you</span><span> </span><span>like</span><span> </span><span>(</span><span>all</span><span> </span><span>available</span><span> </span><span>are</span><span> </span><span>listed</span><span> </span><span>in</span><span> </span><span>a</span><span> </span><span>cell</span><span> </span><span>below).</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="250ac128-c62f-4313-848a-cc0d8b448b1d" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h4>Get Data</h4>
<p>Here we will pull in some sample data that is already pre-loaded onto all databricks clusters.</p>
<p>Feel free to adapt this notebook later to play around with a different dataset if you like (all available are listed in a cell below).</p>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298317"><i class="fa fa-link"></i>Cmd 3</a><div class="new-notebook command mainCommand command-finished cellIndex-2 cell-825169771298314-825169771298317"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="dashboard-button dashboard-button-2 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-2 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-comment"># display datasets already in databricks</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-variable">display</span><span>(</span><span class="cm-variable">dbutils</span><span>.</span><span class="cm-property">fs</span><span>.</span><span class="cm-property">ls</span><span>(</span><span class="cm-string">"/databricks-datasets"</span><span>)</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-fw fa-caret-right"></i>(3) Spark Jobs</p></div></div><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget ui-resizable" data-guid="6a4e8f8c-7003-495f-b70e-5d775b12bed5" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se" style="z-index: 90; display: block;"></div><div class="widget-content dashboard"><div class="results"><div class="results-table noscroll" tabindex="-1"><div class="floatThead-wrapper" style="position: relative; clear:both;"><div class="inner"><table class="table table-bordered table-condensed table-hover" style="table-layout: fixed; min-width: 1384px;"><colgroup><col style="width: 823.2px;"><col style="width: 409.6px;"><col style="width: 151.2px;"></colgroup><thead><tr class="size-row" style="height: 18px;"><th class="floatThead-col" style="height: 17px;"></th><th class="floatThead-col" style="height: 17px;"></th><th class="floatThead-col" style="height: 17px;"></th></tr></thead><tbody><tr><td>dbfs:/databricks-datasets/</td><td>databricks-datasets/</td><td>0</td></tr><tr><td>dbfs:/databricks-datasets/README.md</td><td>README.md</td><td>976</td></tr><tr><td>dbfs:/databricks-datasets/Rdatasets/</td><td>Rdatasets/</td><td>0</td></tr><tr><td>dbfs:/databricks-datasets/SPARK_README.md</td><td>SPARK_README.md</td><td>3359</td></tr><tr><td>dbfs:/databricks-datasets/adult/</td><td>adult/</td><td>0</td></tr><tr><td>dbfs:/databricks-datasets/airlines/</td><td>airlines/</td><td>0</td></tr><tr><td>dbfs:/databricks-datasets/amazon/</td><td>amazon/</td><td>0</td></tr><tr><td>dbfs:/databricks-datasets/asa/</td><td>asa/</td><td>0</td></tr><tr><td>dbfs:/databricks-datasets/atlas_higgs/</td><td>atlas_higgs/</td><td>0</td></tr><tr><td>dbfs:/databricks-datasets/bikeSharing/</td><td>bikeSharing/</td><td>0</td></tr><tr><td>dbfs:/databricks-datasets/cctvVideos/</td><td>cctvVideos/</td><td>0</td></tr><tr><td>dbfs:/databricks-datasets/credit-card-fraud/</td><td>credit-card-fraud/</td><td>0</td></tr><tr><td>dbfs:/databricks-datasets/cs100/</td><td>cs100/</td><td>0</td></tr><tr><td>dbfs:/databricks-datasets/cs110x/</td><td>cs110x/</td><td>0</td></tr><tr><td>dbfs:/databricks-datasets/cs190/</td><td>cs190/</td><td>0</td></tr><tr><td>dbfs:/databricks-datasets/data.gov/</td><td>data.gov/</td><td>0</td></tr><tr><td>dbfs:/databricks-datasets/definitive-guide/</td><td>definitive-guide/</td><td>0</td></tr><tr><td>dbfs:/databricks-datasets/flights/</td><td>flights/</td><td>0</td></tr><tr><td>dbfs:/databricks-datasets/flower_photos/</td><td>flower_photos/</td><td>0</td></tr><tr><td>dbfs:/databricks-datasets/genomics/</td><td>genomics/</td><td>0</td></tr><tr><td>dbfs:/databricks-datasets/hail/</td><td>hail/</td><td>0</td></tr><tr><td>dbfs:/databricks-datasets/iot/</td><td>iot/</td><td>0</td></tr><tr><td>dbfs:/databricks-datasets/iot-stream/</td><td>iot-stream/</td><td>0</td></tr><tr><td>dbfs:/databricks-datasets/learning-spark/</td><td>learning-spark/</td><td>0</td></tr><tr><td>dbfs:/databricks-datasets/learning-spark-v2/</td><td>learning-spark-v2/</td><td>0</td></tr><tr><td>dbfs:/databricks-datasets/lending-club-loan-stats/</td><td>lending-club-loan-stats/</td><td>0</td></tr><tr><td>dbfs:/databricks-datasets/med-images/</td><td>med-images/</td><td>0</td></tr><tr><td>dbfs:/databricks-datasets/mnist-digits/</td><td>mnist-digits/</td><td>0</td></tr><tr><td>dbfs:/databricks-datasets/news20.binary/</td><td>news20.binary/</td><td>0</td></tr><tr><td>dbfs:/databricks-datasets/online_retail/</td><td>online_retail/</td><td>0</td></tr><tr><td>dbfs:/databricks-datasets/overlap-join/</td><td>overlap-join/</td><td>0</td></tr><tr><td>dbfs:/databricks-datasets/power-plant/</td><td>power-plant/</td><td>0</td></tr><tr><td>dbfs:/databricks-datasets/rwe/</td><td>rwe/</td><td>0</td></tr><tr><td>dbfs:/databricks-datasets/sai-summit-2019-sf/</td><td>sai-summit-2019-sf/</td><td>0</td></tr><tr><td>dbfs:/databricks-datasets/sample_logs/</td><td>sample_logs/</td><td>0</td></tr><tr><td>dbfs:/databricks-datasets/samples/</td><td>samples/</td><td>0</td></tr><tr><td>dbfs:/databricks-datasets/sfo_customer_survey/</td><td>sfo_customer_survey/</td><td>0</td></tr><tr><td>dbfs:/databricks-datasets/sms_spam_collection/</td><td>sms_spam_collection/</td><td>0</td></tr><tr><td>dbfs:/databricks-datasets/songs/</td><td>songs/</td><td>0</td></tr><tr><td>dbfs:/databricks-datasets/structured-streaming/</td><td>structured-streaming/</td><td>0</td></tr><tr><td>dbfs:/databricks-datasets/timeseries/</td><td>timeseries/</td><td>0</td></tr><tr><td>dbfs:/databricks-datasets/tpch/</td><td>tpch/</td><td>0</td></tr><tr><td>dbfs:/databricks-datasets/weather/</td><td>weather/</td><td>0</td></tr><tr><td>dbfs:/databricks-datasets/wiki/</td><td>wiki/</td><td>0</td></tr><tr><td>dbfs:/databricks-datasets/wikipedia-datasets/</td><td>wikipedia-datasets/</td><td>0</td></tr></tbody><fthfoot style="display:table-footer-group;border-spacing:0;height:0;border-collapse:collapse;"><fthtr style="display:table-row;border-spacing:0;height:0;border-collapse:collapse"><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd></fthtr></fthfoot></table></div><div style="overflow: hidden; position: absolute; margin-top: 0px; top: 0px; z-index: 1; left: 0px; width: 1385px;" aria-hidden="true" class="floatThead-floatContainer floatThead-container"><table class="table table-bordered table-condensed table-hover floatThead-table" style="margin: 0px; border-bottom-width: 0px; table-layout: fixed; width: 99.9278%;"><colgroup><col style="width: 823.2px;"><col style="width: 409.6px;"><col style="width: 151.2px;"></colgroup><thead><tr><th data-column-name="path" style="padding-right: 23px;">path</th><th data-column-name="name" style="padding-right: 23px;">name</th><th data-column-name="size" style="padding-right: 23px;">size</th></tr></thead></table></div></div></div></div><div class="control-wrapper"><!-- plotControlsTemplate -->
<div class="plot-controls">
  
  <a class="btn btn-small display-type-button active" data-type="table" title="Raw table">
    <i class="fa fa-table"></i>
  </a>
  <div class="btn-group btn-small" style="padding-left: 4px; padding-right: 4px;">
    <a class="btn btn-small display-type-button" data-type="barChart" title="Bar chart">
      <i class="icon-db-bar"></i>
    </a><a class="btn btn-small dropdown-toggle" data-toggle="dropdown" style="padding-left: 6px; padding-right: 6px">
    <b class="caret"></b>
  </a>
    
    <div class="dropdown-menu" role="menu">
      <div class="row-fluid" style="width: 240px">
        
        <ul class="span6 multicol-menu" style="width: 80px">
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="barChart">
              <i class="icon-db-bar fa fa-fw"></i>
              Bar
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="scatterPlot">
              <i class="icon-db-scatter fa fa-fw"></i>
              Scatter
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="mapPlot">
              <i class="icon-db-map fa fa-fw"></i>
              Map
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="mgLine">
              <i class="icon-db-line fa fa-fw"></i>
              Line
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="areaChart">
              <i class="fa fa-area-chart fa fa-fw"></i>
              Area
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="pieChart">
              <i class="icon-db-pie fa fa-fw"></i>
              Pie
            </a>
          </li>
          
          
        </ul>

        
        <ul class="span6 multicol-menu" style="width: 140px">
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="quantilePlot">
              <i class="icon-db-quantile fa fa-fw"></i>
              Quantile
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="histogram">
              <i class="icon-db-histogram fa fa-fw"></i>
              Histogram
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="boxPlot">
              <i class="icon-db-boxplot fa fa-fw"></i>
              Box plot
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="qqPlot">
              <i class="icon-db-qq fa fa-fw"></i>
              Q-Q plot
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="pivotTable">
              <i class="icon-db-pivot fa fa-fw"></i>
              Pivot
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="lineChart">
              <i class="icon-db-line fa fa-fw"></i>
              Line (deprecated)
            </a>
          </li>
          
          
        </ul>

        
      </div>
      
    </div>
  </div>
  
</div><!-- downloadControlsTemplate -->
<div class="download-controls">
  
  <a class="btn btn-small results-download-preview" title="Download CSV">
    <i class="fa fa-download"></i>
  </a>
  
</div></div><div style="height: 32px;"></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div><div class="command-result-stats"><span>Command took</span> <span>5.46 seconds</span> <span class="command-provenance">-- by jeffreyzhangma@gmail.com</span><span> at 12/24/2019, 12:06:05 PM</span><span title="1224-170603-cleat207"> on My Cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298318"><i class="fa fa-link"></i>Cmd 4</a><div class="new-notebook command mainCommand command-finished cellIndex-3 cell-825169771298314-825169771298318"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-3 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-3 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span>Lets</span><span> </span><span>take</span><span> </span><span>a</span><span> </span><span>look</span><span> </span><span>at</span><span> </span><span>the</span><span> </span><span>'</span><span class="cm-strong">**</span><span class="cm-strong">adult</span><span class="cm-strong">**</span><span>'</span><span> </span><span>dataset</span><span> </span><span>on</span><span> </span><span>the</span><span> </span><span>filesystem.</span><span> </span><span>This</span><span> </span><span>is</span><span> </span><span>the</span><span> </span><span>typical</span><span> </span><span>US</span><span> </span><span>Census</span><span> </span><span>data</span><span> </span><span>you</span><span> </span><span>often</span><span> </span><span>see</span><span> </span><span>online</span><span> </span><span>in</span><span> </span><span>tutorials.</span><span> </span><span class="cm-link">[</span><span class="cm-link">Here</span><span class="cm-link">]</span><span class="cm-string url">(</span><span class="cm-string url">https://archive.ics.uci.edu/ml/datasets/adult</span><span class="cm-string url">)</span><span> </span><span>is</span><span> </span><span>the</span><span> </span><span>same</span><span> </span><span>data</span><span> </span><span>in</span><span> </span><span>the</span><span> </span><span>UCI</span><span> </span><span>repository.</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">5</div></div><span class="cm-em">_</span><span class="cm-em">As</span><span class="cm-em"> </span><span class="cm-em">an</span><span class="cm-em"> </span><span class="cm-em">aside</span><span class="cm-em">:</span><span class="cm-em"> </span><span class="cm-em link">[</span><span class="cm-em link">here</span><span class="cm-em link">]</span><span class="cm-string url">(</span><span class="cm-string url">https://github.com/GoogleCloudPlatform/cloudml-samples/tree/master/census</span><span class="cm-string url">)</span><span class="cm-em"> </span><span class="cm-em">this</span><span class="cm-em"> </span><span class="cm-em">same</span><span class="cm-em"> </span><span class="cm-em">dataset</span><span class="cm-em"> </span><span class="cm-em">is</span><span class="cm-em"> </span><span class="cm-em">used</span><span class="cm-em"> </span><span class="cm-em">as</span><span class="cm-em"> </span><span class="cm-em">a</span><span class="cm-em"> </span><span class="cm-em">quickstart</span><span class="cm-em"> </span><span class="cm-em">example</span><span class="cm-em"> </span><span class="cm-em">for</span><span class="cm-em"> </span><span class="cm-em">Google</span><span class="cm-em"> </span><span class="cm-em">CLoud</span><span class="cm-em"> </span><span class="cm-em">ML</span><span class="cm-em"> </span><span class="cm-em">&amp;</span><span class="cm-em"> </span><span class="cm-em">Tensorflow</span><span class="cm-em"> </span><span class="cm-em">Estimator</span><span class="cm-em"> </span><span class="cm-em">API</span><span class="cm-em"> </span><span class="cm-em">(</span><span class="cm-em">in</span><span class="cm-em"> </span><span class="cm-em">case</span><span class="cm-em"> </span><span class="cm-em">youd</span><span class="cm-em"> </span><span class="cm-em">be</span><span class="cm-em"> </span><span class="cm-em">interested</span><span class="cm-em"> </span><span class="cm-em">in</span><span class="cm-em"> </span><span class="cm-em">playing</span><span class="cm-em"> </span><span class="cm-em">with</span><span class="cm-em"> </span><span class="cm-em">tensorflow</span><span class="cm-em"> </span><span class="cm-em">on</span><span class="cm-em"> </span><span class="cm-em">the</span><span class="cm-em"> </span><span class="cm-em">same</span><span class="cm-em"> </span><span class="cm-em">dataset</span><span class="cm-em"> </span><span class="cm-em">as</span><span class="cm-em"> </span><span class="cm-em">here).</span><span class="cm-em">_</span><span> </span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="6b13e531-4a3d-4746-a50f-be9e9883027e" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><p>Lets take a look at the '<strong>adult</strong>' dataset on the filesystem. This is the typical US Census data you often see online in tutorials. <a href="https://archive.ics.uci.edu/ml/datasets/adult">Here</a> is the same data in the UCI repository.</p>
<p><em>As an aside: <a href="https://github.com/GoogleCloudPlatform/cloudml-samples/tree/master/census">here</a> this same dataset is used as a quickstart example for Google CLoud ML &amp; Tensorflow Estimator API (in case youd be interested in playing with tensorflow on the same dataset as here).</em> </p>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298319"><i class="fa fa-link"></i>Cmd 5</a><div class="new-notebook command mainCommand command-finished cellIndex-4 cell-825169771298314-825169771298319"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="dashboard-button dashboard-button-4 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-4 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%fs ls databricks-datasets/adult/adult.data</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget ui-resizable" data-guid="25ae99b8-5bc1-437d-a3c8-00e9e069d64e" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se" style="z-index: 90; display: block;"></div><div class="widget-content dashboard"><div class="results"><div class="results-table noscroll" tabindex="-1"><div class="floatThead-wrapper" style="position: relative; clear:both;"><div class="inner"><table class="table table-bordered table-condensed table-hover" style="table-layout: fixed; min-width: 1384px;"><colgroup><col style="width: 907.2px;"><col style="width: 249.6px;"><col style="width: 227.2px;"></colgroup><thead><tr class="size-row" style="height: 18px;"><th class="floatThead-col" style="height: 17px;"></th><th class="floatThead-col" style="height: 17px;"></th><th class="floatThead-col" style="height: 17px;"></th></tr></thead><tbody><tr><td>dbfs:/databricks-datasets/adult/adult.data</td><td>adult.data</td><td>3974305</td></tr></tbody><fthfoot style="display:table-footer-group;border-spacing:0;height:0;border-collapse:collapse;"><fthtr style="display:table-row;border-spacing:0;height:0;border-collapse:collapse"><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd></fthtr></fthfoot></table></div><div style="overflow: hidden; position: absolute; margin-top: 0px; top: 0px; z-index: 1; left: 0px; width: 1385px;" aria-hidden="true" class="floatThead-floatContainer floatThead-container"><table class="table table-bordered table-condensed table-hover floatThead-table" style="margin: 0px; border-bottom-width: 0px; table-layout: fixed; width: 99.9278%;"><colgroup><col style="width: 907.2px;"><col style="width: 249.6px;"><col style="width: 227.2px;"></colgroup><thead><tr><th data-column-name="path" style="padding-right: 23px;">path</th><th data-column-name="name" style="padding-right: 23px;">name</th><th data-column-name="size" style="padding-right: 23px;">size</th></tr></thead></table></div></div></div></div><div class="control-wrapper"><!-- plotControlsTemplate -->
<div class="plot-controls">
  
  <a class="btn btn-small display-type-button active" data-type="table" title="Raw table">
    <i class="fa fa-table"></i>
  </a>
  <div class="btn-group btn-small" style="padding-left: 4px; padding-right: 4px;">
    <a class="btn btn-small display-type-button" data-type="barChart" title="Bar chart">
      <i class="icon-db-bar"></i>
    </a><a class="btn btn-small dropdown-toggle" data-toggle="dropdown" style="padding-left: 6px; padding-right: 6px">
    <b class="caret"></b>
  </a>
    
    <div class="dropdown-menu" role="menu">
      <div class="row-fluid" style="width: 240px">
        
        <ul class="span6 multicol-menu" style="width: 80px">
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="barChart">
              <i class="icon-db-bar fa fa-fw"></i>
              Bar
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="scatterPlot">
              <i class="icon-db-scatter fa fa-fw"></i>
              Scatter
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="mapPlot">
              <i class="icon-db-map fa fa-fw"></i>
              Map
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="mgLine">
              <i class="icon-db-line fa fa-fw"></i>
              Line
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="areaChart">
              <i class="fa fa-area-chart fa fa-fw"></i>
              Area
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="pieChart">
              <i class="icon-db-pie fa fa-fw"></i>
              Pie
            </a>
          </li>
          
          
        </ul>

        
        <ul class="span6 multicol-menu" style="width: 140px">
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="quantilePlot">
              <i class="icon-db-quantile fa fa-fw"></i>
              Quantile
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="histogram">
              <i class="icon-db-histogram fa fa-fw"></i>
              Histogram
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="boxPlot">
              <i class="icon-db-boxplot fa fa-fw"></i>
              Box plot
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="qqPlot">
              <i class="icon-db-qq fa fa-fw"></i>
              Q-Q plot
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="pivotTable">
              <i class="icon-db-pivot fa fa-fw"></i>
              Pivot
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="lineChart">
              <i class="icon-db-line fa fa-fw"></i>
              Line (deprecated)
            </a>
          </li>
          
          
        </ul>

        
      </div>
      
    </div>
  </div>
  
</div><!-- downloadControlsTemplate -->
<div class="download-controls">
  
  <a class="btn btn-small results-download-preview" title="Download CSV">
    <i class="fa fa-download"></i>
  </a>
  
</div></div><div style="height: 32px;"></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div><div class="command-result-stats"><span>Command took</span> <span>11.18 seconds</span> <span class="command-provenance">-- by jeffreyzhangma@gmail.com</span><span> at 12/24/2019, 12:07:29 PM</span><span title="1224-170603-cleat207"> on My Cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298320"><i class="fa fa-link"></i>Cmd 6</a><div class="new-notebook command mainCommand command-finished cellIndex-5 cell-825169771298314-825169771298320"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-5 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-5 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-strong">**</span><span class="cm-strong">Note</span><span class="cm-strong">**</span><span>:</span><span> </span><span>Above</span><span> </span><span> </span><span>%fs</span><span> </span><span>is</span><span> </span><span>just</span><span> </span><span>some</span><span> </span><span>file</span><span> </span><span>system</span><span> </span><span>cell</span><span> </span><span>magic</span><span> </span><span>that</span><span> </span><span>is</span><span> </span><span>specific</span><span> </span><span>to</span><span> </span><span>databricks.</span><span> </span><span>More</span><span> </span><span>info</span><span> </span><span class="cm-link">[</span><span class="cm-link">here</span><span class="cm-link">]</span><span class="cm-string url">(</span><span class="cm-string url">https://docs.databricks.com/user-guide/notebooks/index.html#mix-languages</span><span class="cm-string url">)</span><span>.</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="709057a1-33aa-450e-b3f7-fe2d77409185" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><p><strong>Note</strong>: Above  %fs is just some file system cell magic that is specific to databricks. More info <a href="https://docs.databricks.com/user-guide/notebooks/index.html#mix-languages">here</a>.</p>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"><i class="fa fa-minus-square-o"></i></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298321"><i class="fa fa-link"></i>Cmd 7</a><div class="new-notebook command mainCommand command-finished cellIndex-6 cell-825169771298314-825169771298321"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-6 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-6 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>#</span><span>#</span><span>#</span><span>#</span><span>Spark</span><span> </span><span>SQL</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span>Below</span><span> </span><span>we</span><span> </span><span>will</span><span> </span><span>use</span><span> </span><span>Spark</span><span> </span><span>SQL</span><span> </span><span>to</span><span> </span><span>load</span><span> </span><span>in</span><span> </span><span>the</span><span> </span><span>data</span><span> </span><span>and</span><span> </span><span>then</span><span> </span><span>register</span><span> </span><span>it</span><span> </span><span>as</span><span> </span><span>a</span><span> </span><span>Dataframe</span><span> </span><span>aswell.</span><span> </span><span>So</span><span> </span><span>the</span><span> </span><span>end</span><span> </span><span>result</span><span> </span><span>will</span><span> </span><span>be</span><span> </span><span>a</span><span> </span><span>Spark</span><span> </span><span>SQL</span><span> </span><span>table</span><span> </span><span>called</span><span> </span><span class="cm-em">_</span><span class="cm-em">adult</span><span class="cm-em">_</span><span> </span><span>and</span><span> </span><span>a</span><span> </span><span>Spark</span><span> </span><span>Dataframe</span><span> </span><span>called</span><span> </span><span class="cm-em">_</span><span class="cm-em">df</span><span class="cm-em">_</span><span class="cm-em">adult</span><span class="cm-em">_</span><span>.</span><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span class="cm-tag bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag bracket">&gt;</span><span class="cm-tag bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag bracket">&gt;</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">5</div></div><span>This</span><span> </span><span>is</span><span> </span><span>an</span><span> </span><span>example</span><span> </span><span>of</span><span> </span><span>the</span><span> </span><span>flexibility</span><span> </span><span>in</span><span> </span><span>Spark</span><span> </span><span>in</span><span> </span><span>that</span><span> </span><span>you</span><span> </span><span>could</span><span> </span><span>do</span><span> </span><span>lots</span><span> </span><span>of</span><span> </span><span>you</span><span> </span><span>ETL</span><span> </span><span>and</span><span> </span><span>data</span><span> </span><span>wrangling</span><span> </span><span>using</span><span> </span><span>either</span><span> </span><span>Spark</span><span> </span><span>SQL</span><span> </span><span>or</span><span> </span><span>Dataframes</span><span> </span><span>and</span><span> </span><span>pyspark.</span><span> </span><span>Most</span><span> </span><span>of</span><span> </span><span>the</span><span> </span><span>time</span><span> </span><span>it</span><span>'</span><span>s</span><span> </span><span>a</span><span> </span><span>case</span><span> </span><span>of</span><span> </span><span>using</span><span> </span><span>whatever</span><span> </span><span>you</span><span> </span><span>are</span><span> </span><span>most</span><span> </span><span>comfortable</span><span> </span><span>with.</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">6</div></div><span class="cm-tag bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag bracket">&gt;</span><span class="cm-tag bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag bracket">&gt;</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">7</div></div><span>When</span><span> </span><span>you</span><span> </span><span>get</span><span> </span><span>more</span><span> </span><span>advanced</span><span> </span><span>then</span><span> </span><span>you</span><span> </span><span>might</span><span> </span><span>looking</span><span> </span><span>the</span><span> </span><span>pro</span><span>'</span><span>s</span><span> </span><span>and</span><span> </span><span>con</span><span>'</span><span>s</span><span> </span><span>of</span><span> </span><span>each</span><span> </span><span>and</span><span> </span><span>when</span><span> </span><span>you</span><span> </span><span>might</span><span> </span><span>favour</span><span> </span><span>one</span><span> </span><span>or</span><span> </span><span>the</span><span> </span><span>other</span><span> </span><span>(</span><span>or</span><span> </span><span>operating</span><span> </span><span>direclty</span><span> </span><span>on</span><span> </span><span>RDD</span><span>'</span><span>s),</span><span> </span><span class="cm-link">[</span><span class="cm-link">here</span><span class="cm-link">]</span><span class="cm-string url">(</span><span class="cm-string url">https://databricks.com/blog/2016/07/14/a-tale-of-three-apache-spark-apis-rdds-dataframes-and-datasets.html</span><span class="cm-string url">)</span><span> </span><span>is</span><span> </span><span>a</span><span> </span><span>good</span><span> </span><span>article</span><span> </span><span>on</span><span> </span><span>the</span><span> </span><span>issues.</span><span> </span><span>For</span><span> </span><span>now,</span><span> </span><span>no</span><span> </span><span>need</span><span> </span><span>to</span><span> </span><span>overthink</span><span> </span><span>it</span><span>!</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="e3832cdd-4de0-45a4-bdb2-d79b42d2ed1c" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h4>Spark SQL</h4>
<p>Below we will use Spark SQL to load in the data and then register it as a Dataframe aswell. So the end result will be a Spark SQL table called <em>adult</em> and a Spark Dataframe called <em>df_adult</em>. 
<br><br>
This is an example of the flexibility in Spark in that you could do lots of you ETL and data wrangling using either Spark SQL or Dataframes and pyspark. Most of the time it's a case of using whatever you are most comfortable with.
<br><br>
When you get more advanced then you might looking the pro's and con's of each and when you might favour one or the other (or operating direclty on RDD's), <a href="https://databricks.com/blog/2016/07/14/a-tale-of-three-apache-spark-apis-rdds-dataframes-and-datasets.html">here</a> is a good article on the issues. For now, no need to overthink it!</p>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298322"><i class="fa fa-link"></i>Cmd 8</a><div class="new-notebook command mainCommand command-finished cellIndex-7 cell-825169771298314-825169771298322"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="edit-button edit-button-7 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-operator">%</span><span>sql</span><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-comment">-- drop the table if it already exists</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span class="cm-keyword">DROP</span><span> </span><span class="cm-keyword">TABLE</span><span> </span><span class="cm-keyword">IF</span><span> </span><span class="cm-keyword">EXISTS</span><span> </span><span>adult</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="results command-result-simple">OK</div><div class="command-result-stats"><span>Command took</span> <span>0.23 seconds</span> <span class="command-provenance">-- by jeffreyzhangma@gmail.com</span><span> at 12/24/2019, 12:07:45 PM</span><span title="1224-170603-cleat207"> on My Cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298323"><i class="fa fa-link"></i>Cmd 9</a><div class="new-notebook command mainCommand command-finished cellIndex-8 cell-825169771298314-825169771298323"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="edit-button edit-button-8 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-operator">%</span><span>sql</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-comment">-- create a new table in Spark SQL from the datasets already loaded in the underlying filesystem.</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span class="cm-comment">-- In the real world you might be pointing at a file on HDFS or a hive table etc. </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span class="cm-keyword">CREATE</span><span> </span><span class="cm-keyword">TABLE</span><span> </span><span>adult</span><span> </span><span class="cm-bracket">(</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">5</div></div><span>  </span><span>age</span><span> </span><span class="cm-builtin">DOUBLE</span><span class="cm-punctuation">,</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">6</div></div><span>  </span><span>workclass</span><span> </span><span class="cm-builtin">STRING</span><span class="cm-punctuation">,</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">7</div></div><span>  </span><span>fnlwgt</span><span> </span><span class="cm-builtin">DOUBLE</span><span class="cm-punctuation">,</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">8</div></div><span>  </span><span>education</span><span> </span><span class="cm-builtin">STRING</span><span class="cm-punctuation">,</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">9</div></div><span>  </span><span>education_num</span><span> </span><span class="cm-builtin">DOUBLE</span><span class="cm-punctuation">,</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">10</div></div><span>  </span><span>marital_status</span><span> </span><span class="cm-builtin">STRING</span><span class="cm-punctuation">,</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">11</div></div><span>  </span><span>occupation</span><span> </span><span class="cm-builtin">STRING</span><span class="cm-punctuation">,</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">12</div></div><span>  </span><span>relationship</span><span> </span><span class="cm-builtin">STRING</span><span class="cm-punctuation">,</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">13</div></div><span>  </span><span>race</span><span> </span><span class="cm-builtin">STRING</span><span class="cm-punctuation">,</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">14</div></div><span>  </span><span>sex</span><span> </span><span class="cm-builtin">STRING</span><span class="cm-punctuation">,</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">15</div></div><span>  </span><span>capital_gain</span><span> </span><span class="cm-builtin">DOUBLE</span><span class="cm-punctuation">,</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">16</div></div><span>  </span><span>capital_loss</span><span> </span><span class="cm-builtin">DOUBLE</span><span class="cm-punctuation">,</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">17</div></div><span>  </span><span>hours_per_week</span><span> </span><span class="cm-builtin">DOUBLE</span><span class="cm-punctuation">,</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">18</div></div><span>  </span><span>native_country</span><span> </span><span class="cm-builtin">STRING</span><span class="cm-punctuation">,</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">19</div></div><span>  </span><span>income</span><span> </span><span class="cm-builtin">STRING</span><span class="cm-bracket">)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">20</div></div><span class="cm-keyword">USING</span><span> </span><span>com</span><span class="cm-variable-2">.databricks</span><span class="cm-variable-2">.spark</span><span class="cm-variable-2">.csv</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">21</div></div><span class="cm-keyword">OPTIONS</span><span> </span><span class="cm-bracket">(</span><span>path</span><span> </span><span class="cm-string">"/databricks-datasets/adult/adult.data"</span><span class="cm-punctuation">,</span><span> </span><span>header</span><span> </span><span class="cm-string">"true"</span><span class="cm-bracket">)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="results command-result-simple">OK</div><div class="command-result-stats"><span>Command took</span> <span>1.58 seconds</span> <span class="command-provenance">-- by jeffreyzhangma@gmail.com</span><span> at 12/24/2019, 12:07:49 PM</span><span title="1224-170603-cleat207"> on My Cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298324"><i class="fa fa-link"></i>Cmd 10</a><div class="new-notebook command mainCommand command-finished cellIndex-9 cell-825169771298314-825169771298324"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="dashboard-button dashboard-button-9 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-9 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-comment"># look at the data</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-comment">#spark.sql("SELECT * FROM adult LIMIT 5").show() </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span class="cm-comment"># this will look prettier in Databricks if you use display() instead</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span class="cm-variable">display</span><span>(</span><span class="cm-variable">spark</span><span>.</span><span class="cm-property">sql</span><span>(</span><span class="cm-string">"SELECT * FROM adult LIMIT 5"</span><span>)</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-fw fa-caret-right"></i>(1) Spark Jobs</p></div></div><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget ui-resizable" data-guid="82d8932c-9c4f-4f28-a160-112657fa2f39" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se" style="z-index: 90; display: block;"></div><div class="widget-content dashboard"><div class="results"><div class="results-table noscroll" tabindex="-1"><div class="floatThead-wrapper" style="position: relative; clear:both;"><div class="inner"><table class="table table-bordered table-condensed table-hover" style="table-layout: fixed; min-width: 1392px;"><colgroup><col style="width: 51.2px;"><col style="width: 92px;"><col style="width: 67.2px;"><col style="width: 90.4px;"><col style="width: 125.6px;"><col style="width: 117.6px;"><col style="width: 98.4px;"><col style="width: 103.2px;"><col style="width: 56px;"><col style="width: 54.4px;"><col style="width: 104px;"><col style="width: 104px;"><col style="width: 132px;"><col style="width: 121.6px;"><col style="width: 74.4px;"></colgroup><thead><tr class="size-row" style="height: 36px;"><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th></tr></thead><tbody><tr><td>50</td><td> Self-emp-not-inc</td><td>83311</td><td> Bachelors</td><td>13</td><td> Married-civ-spouse</td><td> Exec-managerial</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>13</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>38</td><td> Private</td><td>215646</td><td> HS-grad</td><td>9</td><td> Divorced</td><td> Handlers-cleaners</td><td> Not-in-family</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>53</td><td> Private</td><td>234721</td><td> 11th</td><td>7</td><td> Married-civ-spouse</td><td> Handlers-cleaners</td><td> Husband</td><td> Black</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>28</td><td> Private</td><td>338409</td><td> Bachelors</td><td>13</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Wife</td><td> Black</td><td> Female</td><td>0</td><td>0</td><td>40</td><td> Cuba</td><td> &lt;=50K</td></tr><tr><td>37</td><td> Private</td><td>284582</td><td> Masters</td><td>14</td><td> Married-civ-spouse</td><td> Exec-managerial</td><td> Wife</td><td> White</td><td> Female</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr></tbody><fthfoot style="display:table-footer-group;border-spacing:0;height:0;border-collapse:collapse;"><fthtr style="display:table-row;border-spacing:0;height:0;border-collapse:collapse"><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd></fthtr></fthfoot></table></div><div style="overflow: hidden; position: absolute; margin-top: 0px; top: 0px; z-index: 1; left: 0px; width: 1385px;" aria-hidden="true" class="floatThead-floatContainer floatThead-container"><table class="table table-bordered table-condensed table-hover floatThead-table" style="margin: 0px; border-bottom-width: 0px; table-layout: fixed; width: 100.505%;"><colgroup><col style="width: 51.2px;"><col style="width: 92px;"><col style="width: 67.2px;"><col style="width: 90.4px;"><col style="width: 125.6px;"><col style="width: 117.6px;"><col style="width: 98.4px;"><col style="width: 103.2px;"><col style="width: 56px;"><col style="width: 54.4px;"><col style="width: 104px;"><col style="width: 104px;"><col style="width: 132px;"><col style="width: 121.6px;"><col style="width: 74.4px;"></colgroup><thead><tr><th data-column-name="age" style="padding-right: 23px;">age</th><th data-column-name="workclass" style="padding-right: 23px;">workclass</th><th data-column-name="fnlwgt" style="padding-right: 23px;">fnlwgt</th><th data-column-name="education" style="padding-right: 23px;">education</th><th data-column-name="education_num" style="padding-right: 23px;">education_num</th><th data-column-name="marital_status" style="padding-right: 23px;">marital_status</th><th data-column-name="occupation" style="padding-right: 23px;">occupation</th><th data-column-name="relationship" style="padding-right: 23px;">relationship</th><th data-column-name="race" style="padding-right: 23px;">race</th><th data-column-name="sex" style="padding-right: 23px;">sex</th><th data-column-name="capital_gain" style="padding-right: 23px;">capital_gain</th><th data-column-name="capital_loss" style="padding-right: 23px;">capital_loss</th><th data-column-name="hours_per_week" style="padding-right: 23px;">hours_per_week</th><th data-column-name="native_country" style="padding-right: 23px;">native_country</th><th data-column-name="income" style="padding-right: 23px;">income</th></tr></thead></table></div></div></div></div><div class="control-wrapper"><!-- plotControlsTemplate -->
<div class="plot-controls">
  
  <a class="btn btn-small display-type-button active" data-type="table" title="Raw table">
    <i class="fa fa-table"></i>
  </a>
  <div class="btn-group btn-small" style="padding-left: 4px; padding-right: 4px;">
    <a class="btn btn-small display-type-button" data-type="barChart" title="Bar chart">
      <i class="icon-db-bar"></i>
    </a><a class="btn btn-small dropdown-toggle" data-toggle="dropdown" style="padding-left: 6px; padding-right: 6px">
    <b class="caret"></b>
  </a>
    
    <div class="dropdown-menu" role="menu">
      <div class="row-fluid" style="width: 240px">
        
        <ul class="span6 multicol-menu" style="width: 80px">
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="barChart">
              <i class="icon-db-bar fa fa-fw"></i>
              Bar
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="scatterPlot">
              <i class="icon-db-scatter fa fa-fw"></i>
              Scatter
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="mapPlot">
              <i class="icon-db-map fa fa-fw"></i>
              Map
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="mgLine">
              <i class="icon-db-line fa fa-fw"></i>
              Line
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="areaChart">
              <i class="fa fa-area-chart fa fa-fw"></i>
              Area
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="pieChart">
              <i class="icon-db-pie fa fa-fw"></i>
              Pie
            </a>
          </li>
          
          
        </ul>

        
        <ul class="span6 multicol-menu" style="width: 140px">
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="quantilePlot">
              <i class="icon-db-quantile fa fa-fw"></i>
              Quantile
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="histogram">
              <i class="icon-db-histogram fa fa-fw"></i>
              Histogram
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="boxPlot">
              <i class="icon-db-boxplot fa fa-fw"></i>
              Box plot
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="qqPlot">
              <i class="icon-db-qq fa fa-fw"></i>
              Q-Q plot
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="pivotTable">
              <i class="icon-db-pivot fa fa-fw"></i>
              Pivot
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="lineChart">
              <i class="icon-db-line fa fa-fw"></i>
              Line (deprecated)
            </a>
          </li>
          
          
        </ul>

        
      </div>
      
    </div>
  </div>
  
</div><!-- downloadControlsTemplate -->
<div class="download-controls">
  
  <a class="btn btn-small results-download-preview" title="Download CSV">
    <i class="fa fa-download"></i>
  </a>
  
</div></div><div style="height: 32px;"></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div><div class="command-result-stats"><span>Command took</span> <span>1.37 seconds</span> <span class="command-provenance">-- by jeffreyzhangma@gmail.com</span><span> at 12/24/2019, 12:07:53 PM</span><span title="1224-170603-cleat207"> on My Cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298325"><i class="fa fa-link"></i>Cmd 11</a><div class="new-notebook command mainCommand command-finished cellIndex-10 cell-825169771298314-825169771298325"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-10 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-10 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>If</span><span> </span><span>you</span><span> </span><span>are</span><span> </span><span>more</span><span> </span><span>comfortable</span><span> </span><span>with</span><span> </span><span>SQL</span><span> </span><span>then</span><span> </span><span>as</span><span> </span><span>you</span><span> </span><span>can</span><span> </span><span>see</span><span> </span><span>below,</span><span> </span><span>its</span><span> </span><span>very</span><span> </span><span>easy</span><span> </span><span>to</span><span> </span><span>just</span><span> </span><span>get</span><span> </span><span>going</span><span> </span><span>with</span><span> </span><span>writing</span><span> </span><span>standard</span><span> </span><span>SQL</span><span> </span><span>type</span><span> </span><span>code</span><span> </span><span>to</span><span> </span><span>analyse</span><span> </span><span>your</span><span> </span><span>data,</span><span> </span><span>do</span><span> </span><span>data</span><span> </span><span>wrangling</span><span> </span><span>and</span><span> </span><span>create</span><span> </span><span>new</span><span> </span><span>dataframes.</span><span> </span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="eec36730-2b05-4130-ba67-71585555915b" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><p>If you are more comfortable with SQL then as you can see below, its very easy to just get going with writing standard SQL type code to analyse your data, do data wrangling and create new dataframes. </p>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298326"><i class="fa fa-link"></i>Cmd 12</a><div class="new-notebook command mainCommand command-finished cellIndex-11 cell-825169771298314-825169771298326"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="dashboard-button dashboard-button-11 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-11 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-comment"># Lets get some summary marital status rates by occupation</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-variable">result</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">spark</span><span>.</span><span class="cm-property">sql</span><span>(</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span>  </span><span class="cm-string">"""</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span class="cm-string">  SELECT </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">5</div></div><span class="cm-string">    occupation,</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">6</div></div><span class="cm-string">    SUM(1) as n,</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">7</div></div><span class="cm-string">    ROUND(AVG(if(LTRIM(marital_status) LIKE 'Married-%',1,0)),2) as married_rate,</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">8</div></div><span class="cm-string">    ROUND(AVG(if(lower(marital_status) LIKE '%widow%',1,0)),2) as widow_rate,</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">9</div></div><span class="cm-string">    ROUND(AVG(if(LTRIM(marital_status) = 'Divorced',1,0)),2) as divorce_rate,</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">10</div></div><span class="cm-string">    ROUND(AVG(if(LTRIM(marital_status) = 'Separated',1,0)),2) as separated_rate,</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">11</div></div><span class="cm-string">    ROUND(AVG(if(LTRIM(marital_status) = 'Never-married',1,0)),2) as bachelor_rate</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">12</div></div><span class="cm-string">  FROM </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">13</div></div><span class="cm-string">    adult </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">14</div></div><span class="cm-string">  GROUP BY 1</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">15</div></div><span class="cm-string">  ORDER BY n DESC</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">16</div></div><span class="cm-string">  """</span><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">17</div></div><span class="cm-variable">display</span><span>(</span><span class="cm-variable">result</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-fw fa-caret-right"></i>(1) Spark Jobs</p></div></div><div class="dataset-info-view"><div class=""><a class="tree-toggler"><i class="fa fa-caret-right fa-fw"></i><i class="fa fa-list-alt fa-fw"></i><span class="spacing-left">result:</span><span class="spacing-left">pyspark.sql.dataframe.DataFrame = [occupation: string, n: long ... 5 more fields]</span></a></div><div class="outer-most-struct"></div></div><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget ui-resizable" data-guid="91f5e9cd-ba05-4d7d-88f5-03b7e418936d" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se" style="z-index: 90; display: block;"></div><div class="widget-content dashboard"><div class="results"><div class="results-table noscroll" tabindex="-1"><div class="floatThead-wrapper" style="position: relative; clear:both;"><div class="inner"><table class="table table-bordered table-condensed table-hover" style="table-layout: fixed; min-width: 1384px;"><colgroup><col style="width: 233.6px;"><col style="width: 77.6px;"><col style="width: 210.4px;"><col style="width: 194.4px;"><col style="width: 207.2px;"><col style="width: 236.8px;"><col style="width: 224px;"></colgroup><thead><tr class="size-row" style="height: 18px;"><th class="floatThead-col" style="height: 17px;"></th><th class="floatThead-col" style="height: 17px;"></th><th class="floatThead-col" style="height: 17px;"></th><th class="floatThead-col" style="height: 17px;"></th><th class="floatThead-col" style="height: 17px;"></th><th class="floatThead-col" style="height: 17px;"></th><th class="floatThead-col" style="height: 17px;"></th></tr></thead><tbody><tr><td> Prof-specialty</td><td>4140</td><td>0.53</td><td>0.02</td><td>0.13</td><td>0.02</td><td>0.3</td></tr><tr><td> Craft-repair</td><td>4099</td><td>0.64</td><td>0.01</td><td>0.11</td><td>0.03</td><td>0.21</td></tr><tr><td> Exec-managerial</td><td>4066</td><td>0.61</td><td>0.02</td><td>0.15</td><td>0.02</td><td>0.2</td></tr><tr><td> Adm-clerical</td><td>3769</td><td>0.28</td><td>0.04</td><td>0.22</td><td>0.04</td><td>0.42</td></tr><tr><td> Sales</td><td>3650</td><td>0.47</td><td>0.03</td><td>0.12</td><td>0.03</td><td>0.36</td></tr><tr><td> Other-service</td><td>3295</td><td>0.24</td><td>0.05</td><td>0.15</td><td>0.06</td><td>0.5</td></tr><tr><td> Machine-op-inspct</td><td>2002</td><td>0.51</td><td>0.03</td><td>0.14</td><td>0.04</td><td>0.29</td></tr><tr><td> ?</td><td>1843</td><td>0.36</td><td>0.08</td><td>0.1</td><td>0.04</td><td>0.42</td></tr><tr><td> Transport-moving</td><td>1597</td><td>0.63</td><td>0.02</td><td>0.11</td><td>0.02</td><td>0.21</td></tr><tr><td> Handlers-cleaners</td><td>1370</td><td>0.36</td><td>0.01</td><td>0.09</td><td>0.03</td><td>0.51</td></tr><tr><td> Farming-fishing</td><td>994</td><td>0.6</td><td>0.02</td><td>0.06</td><td>0.02</td><td>0.29</td></tr><tr><td> Tech-support</td><td>928</td><td>0.44</td><td>0.02</td><td>0.15</td><td>0.03</td><td>0.36</td></tr><tr><td> Protective-serv</td><td>649</td><td>0.6</td><td>0.01</td><td>0.12</td><td>0.02</td><td>0.24</td></tr><tr><td> Priv-house-serv</td><td>149</td><td>0.13</td><td>0.15</td><td>0.19</td><td>0.08</td><td>0.45</td></tr><tr><td> Armed-Forces</td><td>9</td><td>0.33</td><td>0</td><td>0</td><td>0</td><td>0.67</td></tr></tbody><fthfoot style="display:table-footer-group;border-spacing:0;height:0;border-collapse:collapse;"><fthtr style="display:table-row;border-spacing:0;height:0;border-collapse:collapse"><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd></fthtr></fthfoot></table></div><div style="overflow: hidden; position: absolute; margin-top: 0px; top: 0px; z-index: 1; left: 0px; width: 1385px;" aria-hidden="true" class="floatThead-floatContainer floatThead-container"><table class="table table-bordered table-condensed table-hover floatThead-table" style="margin: 0px; border-bottom-width: 0px; table-layout: fixed; width: 99.9278%;"><colgroup><col style="width: 233.6px;"><col style="width: 77.6px;"><col style="width: 210.4px;"><col style="width: 194.4px;"><col style="width: 207.2px;"><col style="width: 236.8px;"><col style="width: 224px;"></colgroup><thead><tr><th data-column-name="occupation" style="padding-right: 23px;">occupation</th><th data-column-name="n" style="padding-right: 23px;">n</th><th data-column-name="married_rate" style="padding-right: 23px;">married_rate</th><th data-column-name="widow_rate" style="padding-right: 23px;">widow_rate</th><th data-column-name="divorce_rate" style="padding-right: 23px;">divorce_rate</th><th data-column-name="separated_rate" style="padding-right: 23px;">separated_rate</th><th data-column-name="bachelor_rate" style="padding-right: 23px;">bachelor_rate</th></tr></thead></table></div></div></div></div><div class="control-wrapper"><!-- plotControlsTemplate -->
<div class="plot-controls">
  
  <a class="btn btn-small display-type-button active" data-type="table" title="Raw table">
    <i class="fa fa-table"></i>
  </a>
  <div class="btn-group btn-small" style="padding-left: 4px; padding-right: 4px;">
    <a class="btn btn-small display-type-button" data-type="barChart" title="Bar chart">
      <i class="icon-db-bar"></i>
    </a><a class="btn btn-small dropdown-toggle" data-toggle="dropdown" style="padding-left: 6px; padding-right: 6px">
    <b class="caret"></b>
  </a>
    
    <div class="dropdown-menu" role="menu">
      <div class="row-fluid" style="width: 240px">
        
        <ul class="span6 multicol-menu" style="width: 80px">
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="barChart">
              <i class="icon-db-bar fa fa-fw"></i>
              Bar
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="scatterPlot">
              <i class="icon-db-scatter fa fa-fw"></i>
              Scatter
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="mapPlot">
              <i class="icon-db-map fa fa-fw"></i>
              Map
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="mgLine">
              <i class="icon-db-line fa fa-fw"></i>
              Line
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="areaChart">
              <i class="fa fa-area-chart fa fa-fw"></i>
              Area
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="pieChart">
              <i class="icon-db-pie fa fa-fw"></i>
              Pie
            </a>
          </li>
          
          
        </ul>

        
        <ul class="span6 multicol-menu" style="width: 140px">
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="quantilePlot">
              <i class="icon-db-quantile fa fa-fw"></i>
              Quantile
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="histogram">
              <i class="icon-db-histogram fa fa-fw"></i>
              Histogram
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="boxPlot">
              <i class="icon-db-boxplot fa fa-fw"></i>
              Box plot
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="qqPlot">
              <i class="icon-db-qq fa fa-fw"></i>
              Q-Q plot
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="pivotTable">
              <i class="icon-db-pivot fa fa-fw"></i>
              Pivot
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="lineChart">
              <i class="icon-db-line fa fa-fw"></i>
              Line (deprecated)
            </a>
          </li>
          
          
        </ul>

        
      </div>
      
    </div>
  </div>
  
</div><!-- downloadControlsTemplate -->
<div class="download-controls">
  
  <a class="btn btn-small results-download-preview" title="Download CSV">
    <i class="fa fa-download"></i>
  </a>
  
</div></div><div style="height: 32px;"></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div><div class="command-result-stats"><span>Command took</span> <span>4.63 seconds</span> <span class="command-provenance">-- by jeffreyzhangma@gmail.com</span><span> at 12/24/2019, 12:08:01 PM</span><span title="1224-170603-cleat207"> on My Cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298327"><i class="fa fa-link"></i>Cmd 13</a><div class="new-notebook command mainCommand command-finished cellIndex-12 cell-825169771298314-825169771298327"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-12 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-12 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>You</span><span> </span><span>can</span><span> </span><span>easily</span><span> </span><span>register</span><span> </span><span>dataframes</span><span> </span><span>as</span><span> </span><span>a</span><span> </span><span>table</span><span> </span><span>for</span><span> </span><span>Spark</span><span> </span><span>SQL</span><span> </span><span>too.</span><span> </span><span>So</span><span> </span><span>this</span><span> </span><span>way</span><span> </span><span>you</span><span> </span><span>can</span><span> </span><span>easily</span><span> </span><span>move</span><span> </span><span>between</span><span> </span><span>Dataframes</span><span> </span><span>and</span><span> </span><span>Spark</span><span> </span><span>SQL</span><span> </span><span>for</span><span> </span><span>whatever</span><span> </span><span>reason.</span><span class="cm-trailing-space-a"> </span><span class="cm-trailing-space-new-line"> </span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="a2fdf2f1-346a-4981-a5ab-c3df83415fa2" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><p>You can easily register dataframes as a table for Spark SQL too. So this way you can easily move between Dataframes and Spark SQL for whatever reason.  </p>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298328"><i class="fa fa-link"></i>Cmd 14</a><div class="new-notebook command mainCommand command-finished cellIndex-13 cell-825169771298314-825169771298328"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="edit-button edit-button-13 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-comment"># register the df we just made as a table for spark sql</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-variable">sqlContext</span><span>.</span><span class="cm-property">registerDataFrameAsTable</span><span>(</span><span class="cm-variable">result</span><span>,</span><span> </span><span class="cm-string">"result"</span><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span class="cm-variable">spark</span><span>.</span><span class="cm-property">sql</span><span>(</span><span class="cm-string">"SELECT * FROM result"</span><span>)</span><span>.</span><span class="cm-property">show</span><span>(</span><span class="cm-number">5</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-fw fa-caret-right"></i>(1) Spark Jobs</p></div></div><div class="results"><div class="ansiout">+----------------+----+------------+----------+------------+--------------+-------------+
|      occupation|   n|married_rate|widow_rate|divorce_rate|separated_rate|bachelor_rate|
+----------------+----+------------+----------+------------+--------------+-------------+
|  Prof-specialty|4140|        0.53|      0.02|        0.13|          0.02|          0.3|
|    Craft-repair|4099|        0.64|      0.01|        0.11|          0.03|         0.21|
| Exec-managerial|4066|        0.61|      0.02|        0.15|          0.02|          0.2|
|    Adm-clerical|3769|        0.28|      0.04|        0.22|          0.04|         0.42|
|           Sales|3650|        0.47|      0.03|        0.12|          0.03|         0.36|
+----------------+----+------------+----------+------------+--------------+-------------+
only showing top 5 rows

</div></div><div class="command-result-stats"><span>Command took</span> <span>2.79 seconds</span> <span class="command-provenance">-- by jeffreyzhangma@gmail.com</span><span> at 12/24/2019, 12:08:10 PM</span><span title="1224-170603-cleat207"> on My Cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"><i class="fa fa-minus-square-o"></i></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298329"><i class="fa fa-link"></i>Cmd 15</a><div class="new-notebook command mainCommand command-finished cellIndex-14 cell-825169771298314-825169771298329"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-14 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-14 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>#</span><span>#</span><span>#</span><span>#</span><span class="cm-tag bracket">&lt;</span><span class="cm-tag">span</span><span> </span><span class="cm-attribute">style</span><span>=</span><span class="cm-string">"color:darkblue"</span><span class="cm-tag bracket">&gt;</span><span>Question 1</span><span class="cm-tag bracket">&lt;/</span><span class="cm-tag">span</span><span class="cm-tag bracket">&gt;</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span class="cm-variable-2">1. </span><span class="cm-variable-2">Write</span><span class="cm-variable-2"></span><span class="cm-variable-2"> </span><span class="cm-variable-2">some</span><span class="cm-variable-2"> </span><span class="cm-variable-2">spark</span><span class="cm-variable-2"> </span><span class="cm-variable-2">sql</span><span class="cm-variable-2"> </span><span class="cm-variable-2">to</span><span class="cm-variable-2"> </span><span class="cm-variable-2">get</span><span class="cm-variable-2"> </span><span class="cm-variable-2">the</span><span class="cm-variable-2"> </span><span class="cm-variable-2">top</span><span class="cm-variable-2"> </span><span class="cm-variable-2">'</span><span class="cm-variable-2">bachelor</span><span class="cm-variable-2">_</span><span class="cm-variable-2">rate</span><span class="cm-variable-2">'</span><span class="cm-variable-2"> </span><span class="cm-variable-2">by</span><span class="cm-variable-2"> </span><span class="cm-variable-2">'</span><span class="cm-variable-2">education</span><span class="cm-variable-2">'</span><span class="cm-variable-2"> </span><span class="cm-variable-2">group?</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="83a5c17d-8d98-4a70-a49d-d019b815ce23" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h4><span style="color:darkblue;">Question 1</span></h4>
<ol>
<li>Write some spark sql to get the top 'bachelor_rate' by 'education' group?</li>
</ol>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298330"><i class="fa fa-link"></i>Cmd 16</a><div class="new-notebook command mainCommand command-finished cellIndex-15 cell-825169771298314-825169771298330"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="edit-button edit-button-15 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 104px; left: 336.4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="1"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="false"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 238px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>12</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 306.4px; top: 92px; height: 18.4px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">### Question 1.1 Answer ###</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">result</span> <span class="cm-operator">=</span> <span class="cm-variable">spark</span>.<span class="cm-property">sql</span>(</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-string">"""</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">  SELECT </span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string"> &nbsp;  education,</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string"> &nbsp;  ROUND(AVG(if(LTRIM</span><span class="cm-string CodeMirror-matchingbracket">(</span><span class="cm-string">marital_status</span><span class="cm-string CodeMirror-matchingbracket">)</span><span class="cm-string"> = 'Never-married',1,0)),2) as bachelor_rate</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">  FROM </span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string"> &nbsp;  adult </span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">  GROUP BY 1</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">10</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">  ORDER BY bachelor_rate DESC</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">11</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-string">  """</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">12</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">result</span>.<span class="cm-property">show</span>(<span class="cm-number">1</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 238px;"></div><div class="CodeMirror-gutters" style="height: 251px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-fw fa-caret-right"></i>(1) Spark Jobs</p></div></div><div class="dataset-info-view"><div class=""><a class="tree-toggler"><i class="fa fa-caret-right fa-fw"></i><i class="fa fa-list-alt fa-fw"></i><span class="spacing-left">result:</span><span class="spacing-left">pyspark.sql.dataframe.DataFrame = [education: string, bachelor_rate: double]</span></a></div><div class="outer-most-struct"></div></div><div class="results"><div class="ansiout">+---------+-------------+
|education|bachelor_rate|
+---------+-------------+
|     12th|         0.54|
+---------+-------------+
only showing top 1 row

</div></div><div class="command-result-stats"><span>Command took</span> <span>1.64 seconds</span> <span class="command-provenance">-- by jeffreyzhangma@gmail.com</span><span> at 12/24/2019, 12:25:19 PM</span><span title="1224-170603-cleat207"> on My Cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"><i class="fa fa-minus-square-o"></i></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298331"><i class="fa fa-link"></i>Cmd 17</a><div class="new-notebook command mainCommand command-finished cellIndex-16 cell-825169771298314-825169771298331"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-16 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-16 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>#</span><span>#</span><span>#</span><span>#</span><span>Spark</span><span> </span><span>DataFrames</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span>Below</span><span> </span><span>we</span><span> </span><span>will</span><span> </span><span>create</span><span> </span><span>our</span><span> </span><span>DataFrame</span><span> </span><span>from</span><span> </span><span>the</span><span> </span><span>SQL</span><span> </span><span>table</span><span> </span><span>and</span><span> </span><span>do</span><span> </span><span>some</span><span> </span><span>similar</span><span> </span><span>analysis</span><span> </span><span>as</span><span> </span><span>we</span><span> </span><span>did</span><span> </span><span>with</span><span> </span><span>Spark</span><span> </span><span>SQL</span><span> </span><span>but</span><span> </span><span>using</span><span> </span><span>the</span><span> </span><span>DataFrames</span><span> </span><span>API.</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="b37088e8-c063-4f4f-ab94-9c3303a54560" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h4>Spark DataFrames</h4>
<p>Below we will create our DataFrame from the SQL table and do some similar analysis as we did with Spark SQL but using the DataFrames API.</p>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298332"><i class="fa fa-link"></i>Cmd 18</a><div class="new-notebook command mainCommand command-finished cellIndex-17 cell-825169771298314-825169771298332"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="edit-button edit-button-17 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-comment"># register a df from the sql df</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-variable">df_adult</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">spark</span><span>.</span><span class="cm-property">table</span><span>(</span><span class="cm-string">"adult"</span><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span class="cm-variable">cols</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">df_adult</span><span>.</span><span class="cm-property">columns</span><span> </span><span class="cm-comment"># this will be used much later in the notebook, ignore for now</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="dataset-info-view"><div class=""><a class="tree-toggler"><i class="fa fa-caret-right fa-fw"></i><i class="fa fa-list-alt fa-fw"></i><span class="spacing-left">df_adult:</span><span class="spacing-left">pyspark.sql.dataframe.DataFrame = [age: double, workclass: string ... 13 more fields]</span></a></div><div class="outer-most-struct"></div></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.23 seconds</span> <span class="command-provenance">-- by jeffreyzhangma@gmail.com</span><span> at 12/24/2019, 12:17:28 PM</span><span title="1224-170603-cleat207"> on My Cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298333"><i class="fa fa-link"></i>Cmd 19</a><div class="new-notebook command mainCommand command-finished cellIndex-18 cell-825169771298314-825169771298333"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="edit-button edit-button-18 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-comment"># look at df schema</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-variable">df_adult</span><span>.</span><span class="cm-property">printSchema</span><span>(</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="results"><div class="ansiout">root
 |-- age: double (nullable = true)
 |-- workclass: string (nullable = true)
 |-- fnlwgt: double (nullable = true)
 |-- education: string (nullable = true)
 |-- education_num: double (nullable = true)
 |-- marital_status: string (nullable = true)
 |-- occupation: string (nullable = true)
 |-- relationship: string (nullable = true)
 |-- race: string (nullable = true)
 |-- sex: string (nullable = true)
 |-- capital_gain: double (nullable = true)
 |-- capital_loss: double (nullable = true)
 |-- hours_per_week: double (nullable = true)
 |-- native_country: string (nullable = true)
 |-- income: string (nullable = true)

</div></div><div class="command-result-stats"><span>Command took</span> <span>0.05 seconds</span> <span class="command-provenance">-- by jeffreyzhangma@gmail.com</span><span> at 12/24/2019, 12:17:34 PM</span><span title="1224-170603-cleat207"> on My Cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298334"><i class="fa fa-link"></i>Cmd 20</a><div class="new-notebook command mainCommand command-finished cellIndex-19 cell-825169771298314-825169771298334"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="dashboard-button dashboard-button-19 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-19 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-comment"># look at the df</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-variable">display</span><span>(</span><span class="cm-variable">df_adult</span><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span class="cm-comment">#df_adult.show(5)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-fw fa-caret-right"></i>(1) Spark Jobs</p></div></div><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget ui-resizable" data-guid="24a1f163-109d-4a16-8fff-fe9aeb7a4b1b" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se" style="z-index: 90; display: block;"></div><div class="widget-content dashboard"><div class="results"><div class="results-table noscroll" tabindex="-1"><div class="floatThead-wrapper" style="position: relative; clear:both;"><div class="inner"><table class="table table-bordered table-condensed table-hover" style="table-layout: fixed; min-width: 1394px;"><colgroup><col style="width: 51.2px;"><col style="width: 92px;"><col style="width: 67.2px;"><col style="width: 90.4px;"><col style="width: 125.6px;"><col style="width: 117.6px;"><col style="width: 98.4px;"><col style="width: 103.2px;"><col style="width: 57.6px;"><col style="width: 54.4px;"><col style="width: 104px;"><col style="width: 104px;"><col style="width: 132px;"><col style="width: 121.6px;"><col style="width: 74.4px;"></colgroup><thead><tr class="size-row" style="height: 36px;"><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th></tr></thead><tbody><tr><td>50</td><td> Self-emp-not-inc</td><td>83311</td><td> Bachelors</td><td>13</td><td> Married-civ-spouse</td><td> Exec-managerial</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>13</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>38</td><td> Private</td><td>215646</td><td> HS-grad</td><td>9</td><td> Divorced</td><td> Handlers-cleaners</td><td> Not-in-family</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>53</td><td> Private</td><td>234721</td><td> 11th</td><td>7</td><td> Married-civ-spouse</td><td> Handlers-cleaners</td><td> Husband</td><td> Black</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>28</td><td> Private</td><td>338409</td><td> Bachelors</td><td>13</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Wife</td><td> Black</td><td> Female</td><td>0</td><td>0</td><td>40</td><td> Cuba</td><td> &lt;=50K</td></tr><tr><td>37</td><td> Private</td><td>284582</td><td> Masters</td><td>14</td><td> Married-civ-spouse</td><td> Exec-managerial</td><td> Wife</td><td> White</td><td> Female</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>49</td><td> Private</td><td>160187</td><td> 9th</td><td>5</td><td> Married-spouse-absent</td><td> Other-service</td><td> Not-in-family</td><td> Black</td><td> Female</td><td>0</td><td>0</td><td>16</td><td> Jamaica</td><td> &lt;=50K</td></tr><tr><td>52</td><td> Self-emp-not-inc</td><td>209642</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Exec-managerial</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>45</td><td> United-States</td><td> &gt;50K</td></tr><tr><td>31</td><td> Private</td><td>45781</td><td> Masters</td><td>14</td><td> Never-married</td><td> Prof-specialty</td><td> Not-in-family</td><td> White</td><td> Female</td><td>14084</td><td>0</td><td>50</td><td> United-States</td><td> &gt;50K</td></tr><tr><td>42</td><td> Private</td><td>159449</td><td> Bachelors</td><td>13</td><td> Married-civ-spouse</td><td> Exec-managerial</td><td> Husband</td><td> White</td><td> Male</td><td>5178</td><td>0</td><td>40</td><td> United-States</td><td> &gt;50K</td></tr><tr><td>37</td><td> Private</td><td>280464</td><td> Some-college</td><td>10</td><td> Married-civ-spouse</td><td> Exec-managerial</td><td> Husband</td><td> Black</td><td> Male</td><td>0</td><td>0</td><td>80</td><td> United-States</td><td> &gt;50K</td></tr><tr><td>30</td><td> State-gov</td><td>141297</td><td> Bachelors</td><td>13</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Husband</td><td> Asian-Pac-Islander</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> India</td><td> &gt;50K</td></tr><tr><td>23</td><td> Private</td><td>122272</td><td> Bachelors</td><td>13</td><td> Never-married</td><td> Adm-clerical</td><td> Own-child</td><td> White</td><td> Female</td><td>0</td><td>0</td><td>30</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>32</td><td> Private</td><td>205019</td><td> Assoc-acdm</td><td>12</td><td> Never-married</td><td> Sales</td><td> Not-in-family</td><td> Black</td><td> Male</td><td>0</td><td>0</td><td>50</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>40</td><td> Private</td><td>121772</td><td> Assoc-voc</td><td>11</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> Asian-Pac-Islander</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> ?</td><td> &gt;50K</td></tr><tr><td>34</td><td> Private</td><td>245487</td><td> 7th-8th</td><td>4</td><td> Married-civ-spouse</td><td> Transport-moving</td><td> Husband</td><td> Amer-Indian-Eskimo</td><td> Male</td><td>0</td><td>0</td><td>45</td><td> Mexico</td><td> &lt;=50K</td></tr><tr><td>25</td><td> Self-emp-not-inc</td><td>176756</td><td> HS-grad</td><td>9</td><td> Never-married</td><td> Farming-fishing</td><td> Own-child</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>35</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>32</td><td> Private</td><td>186824</td><td> HS-grad</td><td>9</td><td> Never-married</td><td> Machine-op-inspct</td><td> Unmarried</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>38</td><td> Private</td><td>28887</td><td> 11th</td><td>7</td><td> Married-civ-spouse</td><td> Sales</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>50</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>43</td><td> Self-emp-not-inc</td><td>292175</td><td> Masters</td><td>14</td><td> Divorced</td><td> Exec-managerial</td><td> Unmarried</td><td> White</td><td> Female</td><td>0</td><td>0</td><td>45</td><td> United-States</td><td> &gt;50K</td></tr><tr><td>40</td><td> Private</td><td>193524</td><td> Doctorate</td><td>16</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>60</td><td> United-States</td><td> &gt;50K</td></tr><tr><td>54</td><td> Private</td><td>302146</td><td> HS-grad</td><td>9</td><td> Separated</td><td> Other-service</td><td> Unmarried</td><td> Black</td><td> Female</td><td>0</td><td>0</td><td>20</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>35</td><td> Federal-gov</td><td>76845</td><td> 9th</td><td>5</td><td> Married-civ-spouse</td><td> Farming-fishing</td><td> Husband</td><td> Black</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>43</td><td> Private</td><td>117037</td><td> 11th</td><td>7</td><td> Married-civ-spouse</td><td> Transport-moving</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>2042</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>59</td><td> Private</td><td>109015</td><td> HS-grad</td><td>9</td><td> Divorced</td><td> Tech-support</td><td> Unmarried</td><td> White</td><td> Female</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>56</td><td> Local-gov</td><td>216851</td><td> Bachelors</td><td>13</td><td> Married-civ-spouse</td><td> Tech-support</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &gt;50K</td></tr><tr><td>19</td><td> Private</td><td>168294</td><td> HS-grad</td><td>9</td><td> Never-married</td><td> Craft-repair</td><td> Own-child</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>54</td><td> ?</td><td>180211</td><td> Some-college</td><td>10</td><td> Married-civ-spouse</td><td> ?</td><td> Husband</td><td> Asian-Pac-Islander</td><td> Male</td><td>0</td><td>0</td><td>60</td><td> South</td><td> &gt;50K</td></tr><tr><td>39</td><td> Private</td><td>367260</td><td> HS-grad</td><td>9</td><td> Divorced</td><td> Exec-managerial</td><td> Not-in-family</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>80</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>49</td><td> Private</td><td>193366</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>23</td><td> Local-gov</td><td>190709</td><td> Assoc-acdm</td><td>12</td><td> Never-married</td><td> Protective-serv</td><td> Not-in-family</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>52</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>20</td><td> Private</td><td>266015</td><td> Some-college</td><td>10</td><td> Never-married</td><td> Sales</td><td> Own-child</td><td> Black</td><td> Male</td><td>0</td><td>0</td><td>44</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>45</td><td> Private</td><td>386940</td><td> Bachelors</td><td>13</td><td> Divorced</td><td> Exec-managerial</td><td> Own-child</td><td> White</td><td> Male</td><td>0</td><td>1408</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>30</td><td> Federal-gov</td><td>59951</td><td> Some-college</td><td>10</td><td> Married-civ-spouse</td><td> Adm-clerical</td><td> Own-child</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>22</td><td> State-gov</td><td>311512</td><td> Some-college</td><td>10</td><td> Married-civ-spouse</td><td> Other-service</td><td> Husband</td><td> Black</td><td> Male</td><td>0</td><td>0</td><td>15</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>48</td><td> Private</td><td>242406</td><td> 11th</td><td>7</td><td> Never-married</td><td> Machine-op-inspct</td><td> Unmarried</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> Puerto-Rico</td><td> &lt;=50K</td></tr><tr><td>21</td><td> Private</td><td>197200</td><td> Some-college</td><td>10</td><td> Never-married</td><td> Machine-op-inspct</td><td> Own-child</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>19</td><td> Private</td><td>544091</td><td> HS-grad</td><td>9</td><td> Married-AF-spouse</td><td> Adm-clerical</td><td> Wife</td><td> White</td><td> Female</td><td>0</td><td>0</td><td>25</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>31</td><td> Private</td><td>84154</td><td> Some-college</td><td>10</td><td> Married-civ-spouse</td><td> Sales</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>38</td><td> ?</td><td> &gt;50K</td></tr><tr><td>48</td><td> Self-emp-not-inc</td><td>265477</td><td> Assoc-acdm</td><td>12</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>31</td><td> Private</td><td>507875</td><td> 9th</td><td>5</td><td> Married-civ-spouse</td><td> Machine-op-inspct</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>43</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>53</td><td> Self-emp-not-inc</td><td>88506</td><td> Bachelors</td><td>13</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>24</td><td> Private</td><td>172987</td><td> Bachelors</td><td>13</td><td> Married-civ-spouse</td><td> Tech-support</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>50</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>49</td><td> Private</td><td>94638</td><td> HS-grad</td><td>9</td><td> Separated</td><td> Adm-clerical</td><td> Unmarried</td><td> White</td><td> Female</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>25</td><td> Private</td><td>289980</td><td> HS-grad</td><td>9</td><td> Never-married</td><td> Handlers-cleaners</td><td> Not-in-family</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>35</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>57</td><td> Federal-gov</td><td>337895</td><td> Bachelors</td><td>13</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Husband</td><td> Black</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &gt;50K</td></tr><tr><td>53</td><td> Private</td><td>144361</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Machine-op-inspct</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>38</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>44</td><td> Private</td><td>128354</td><td> Masters</td><td>14</td><td> Divorced</td><td> Exec-managerial</td><td> Unmarried</td><td> White</td><td> Female</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>41</td><td> State-gov</td><td>101603</td><td> Assoc-voc</td><td>11</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>29</td><td> Private</td><td>271466</td><td> Assoc-voc</td><td>11</td><td> Never-married</td><td> Prof-specialty</td><td> Not-in-family</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>43</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>25</td><td> Private</td><td>32275</td><td> Some-college</td><td>10</td><td> Married-civ-spouse</td><td> Exec-managerial</td><td> Wife</td><td> Other</td><td> Female</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>18</td><td> Private</td><td>226956</td><td> HS-grad</td><td>9</td><td> Never-married</td><td> Other-service</td><td> Own-child</td><td> White</td><td> Female</td><td>0</td><td>0</td><td>30</td><td> ?</td><td> &lt;=50K</td></tr><tr><td>47</td><td> Private</td><td>51835</td><td> Prof-school</td><td>15</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Wife</td><td> White</td><td> Female</td><td>0</td><td>1902</td><td>60</td><td> Honduras</td><td> &gt;50K</td></tr><tr><td>50</td><td> Federal-gov</td><td>251585</td><td> Bachelors</td><td>13</td><td> Divorced</td><td> Exec-managerial</td><td> Not-in-family</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>55</td><td> United-States</td><td> &gt;50K</td></tr><tr><td>47</td><td> Self-emp-inc</td><td>109832</td><td> HS-grad</td><td>9</td><td> Divorced</td><td> Exec-managerial</td><td> Not-in-family</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>60</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>43</td><td> Private</td><td>237993</td><td> Some-college</td><td>10</td><td> Married-civ-spouse</td><td> Tech-support</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &gt;50K</td></tr><tr><td>46</td><td> Private</td><td>216666</td><td> 5th-6th</td><td>3</td><td> Married-civ-spouse</td><td> Machine-op-inspct</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> Mexico</td><td> &lt;=50K</td></tr><tr><td>35</td><td> Private</td><td>56352</td><td> Assoc-voc</td><td>11</td><td> Married-civ-spouse</td><td> Other-service</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> Puerto-Rico</td><td> &lt;=50K</td></tr><tr><td>41</td><td> Private</td><td>147372</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Adm-clerical</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>48</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>30</td><td> Private</td><td>188146</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Machine-op-inspct</td><td> Husband</td><td> White</td><td> Male</td><td>5013</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>30</td><td> Private</td><td>59496</td><td> Bachelors</td><td>13</td><td> Married-civ-spouse</td><td> Sales</td><td> Husband</td><td> White</td><td> Male</td><td>2407</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>32</td><td> ?</td><td>293936</td><td> 7th-8th</td><td>4</td><td> Married-spouse-absent</td><td> ?</td><td> Not-in-family</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> ?</td><td> &lt;=50K</td></tr><tr><td>48</td><td> Private</td><td>149640</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Transport-moving</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>42</td><td> Private</td><td>116632</td><td> Doctorate</td><td>16</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>45</td><td> United-States</td><td> &gt;50K</td></tr><tr><td>29</td><td> Private</td><td>105598</td><td> Some-college</td><td>10</td><td> Divorced</td><td> Tech-support</td><td> Not-in-family</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>58</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>36</td><td> Private</td><td>155537</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>28</td><td> Private</td><td>183175</td><td> Some-college</td><td>10</td><td> Divorced</td><td> Adm-clerical</td><td> Not-in-family</td><td> White</td><td> Female</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>53</td><td> Private</td><td>169846</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Adm-clerical</td><td> Wife</td><td> White</td><td> Female</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &gt;50K</td></tr><tr><td>49</td><td> Self-emp-inc</td><td>191681</td><td> Some-college</td><td>10</td><td> Married-civ-spouse</td><td> Exec-managerial</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>50</td><td> United-States</td><td> &gt;50K</td></tr><tr><td>25</td><td> ?</td><td>200681</td><td> Some-college</td><td>10</td><td> Never-married</td><td> ?</td><td> Own-child</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>19</td><td> Private</td><td>101509</td><td> Some-college</td><td>10</td><td> Never-married</td><td> Prof-specialty</td><td> Own-child</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>32</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>31</td><td> Private</td><td>309974</td><td> Bachelors</td><td>13</td><td> Separated</td><td> Sales</td><td> Own-child</td><td> Black</td><td> Female</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>29</td><td> Self-emp-not-inc</td><td>162298</td><td> Bachelors</td><td>13</td><td> Married-civ-spouse</td><td> Sales</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>70</td><td> United-States</td><td> &gt;50K</td></tr><tr><td>23</td><td> Private</td><td>211678</td><td> Some-college</td><td>10</td><td> Never-married</td><td> Machine-op-inspct</td><td> Not-in-family</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>79</td><td> Private</td><td>124744</td><td> Some-college</td><td>10</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Other-relative</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>20</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>27</td><td> Private</td><td>213921</td><td> HS-grad</td><td>9</td><td> Never-married</td><td> Other-service</td><td> Own-child</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> Mexico</td><td> &lt;=50K</td></tr><tr><td>40</td><td> Private</td><td>32214</td><td> Assoc-acdm</td><td>12</td><td> Married-civ-spouse</td><td> Adm-clerical</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>67</td><td> ?</td><td>212759</td><td> 10th</td><td>6</td><td> Married-civ-spouse</td><td> ?</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>2</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>18</td><td> Private</td><td>309634</td><td> 11th</td><td>7</td><td> Never-married</td><td> Other-service</td><td> Own-child</td><td> White</td><td> Female</td><td>0</td><td>0</td><td>22</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>31</td><td> Local-gov</td><td>125927</td><td> 7th-8th</td><td>4</td><td> Married-civ-spouse</td><td> Farming-fishing</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>18</td><td> Private</td><td>446839</td><td> HS-grad</td><td>9</td><td> Never-married</td><td> Sales</td><td> Not-in-family</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>30</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>52</td><td> Private</td><td>276515</td><td> Bachelors</td><td>13</td><td> Married-civ-spouse</td><td> Other-service</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> Cuba</td><td> &lt;=50K</td></tr><tr><td>46</td><td> Private</td><td>51618</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Other-service</td><td> Wife</td><td> White</td><td> Female</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>59</td><td> Private</td><td>159937</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Sales</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>48</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>44</td><td> Private</td><td>343591</td><td> HS-grad</td><td>9</td><td> Divorced</td><td> Craft-repair</td><td> Not-in-family</td><td> White</td><td> Female</td><td>14344</td><td>0</td><td>40</td><td> United-States</td><td> &gt;50K</td></tr><tr><td>53</td><td> Private</td><td>346253</td><td> HS-grad</td><td>9</td><td> Divorced</td><td> Sales</td><td> Own-child</td><td> White</td><td> Female</td><td>0</td><td>0</td><td>35</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>49</td><td> Local-gov</td><td>268234</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Protective-serv</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &gt;50K</td></tr><tr><td>33</td><td> Private</td><td>202051</td><td> Masters</td><td>14</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>50</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>30</td><td> Private</td><td>54334</td><td> 9th</td><td>5</td><td> Never-married</td><td> Sales</td><td> Not-in-family</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>43</td><td> Federal-gov</td><td>410867</td><td> Doctorate</td><td>16</td><td> Never-married</td><td> Prof-specialty</td><td> Not-in-family</td><td> White</td><td> Female</td><td>0</td><td>0</td><td>50</td><td> United-States</td><td> &gt;50K</td></tr><tr><td>57</td><td> Private</td><td>249977</td><td> Assoc-voc</td><td>11</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>37</td><td> Private</td><td>286730</td><td> Some-college</td><td>10</td><td> Divorced</td><td> Craft-repair</td><td> Unmarried</td><td> White</td><td> Female</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>28</td><td> Private</td><td>212563</td><td> Some-college</td><td>10</td><td> Divorced</td><td> Machine-op-inspct</td><td> Unmarried</td><td> Black</td><td> Female</td><td>0</td><td>0</td><td>25</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>30</td><td> Private</td><td>117747</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Sales</td><td> Wife</td><td> Asian-Pac-Islander</td><td> Female</td><td>0</td><td>1573</td><td>35</td><td> ?</td><td> &lt;=50K</td></tr><tr><td>34</td><td> Local-gov</td><td>226296</td><td> Bachelors</td><td>13</td><td> Married-civ-spouse</td><td> Protective-serv</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &gt;50K</td></tr><tr><td>29</td><td> Local-gov</td><td>115585</td><td> Some-college</td><td>10</td><td> Never-married</td><td> Handlers-cleaners</td><td> Not-in-family</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>50</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>48</td><td> Self-emp-not-inc</td><td>191277</td><td> Doctorate</td><td>16</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>1902</td><td>60</td><td> United-States</td><td> &gt;50K</td></tr><tr><td>37</td><td> Private</td><td>202683</td><td> Some-college</td><td>10</td><td> Married-civ-spouse</td><td> Sales</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>48</td><td> United-States</td><td> &gt;50K</td></tr><tr><td>48</td><td> Private</td><td>171095</td><td> Assoc-acdm</td><td>12</td><td> Divorced</td><td> Exec-managerial</td><td> Unmarried</td><td> White</td><td> Female</td><td>0</td><td>0</td><td>40</td><td> England</td><td> &lt;=50K</td></tr><tr><td>32</td><td> Federal-gov</td><td>249409</td><td> HS-grad</td><td>9</td><td> Never-married</td><td> Other-service</td><td> Own-child</td><td> Black</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>76</td><td> Private</td><td>124191</td><td> Masters</td><td>14</td><td> Married-civ-spouse</td><td> Exec-managerial</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &gt;50K</td></tr></tbody><fthfoot style="display:table-footer-group;border-spacing:0;height:0;border-collapse:collapse;"><fthtr style="display:table-row;border-spacing:0;height:0;border-collapse:collapse"><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd></fthtr></fthfoot></table></div><div style="overflow: hidden; position: absolute; margin-top: 0px; top: 0px; z-index: 1; left: 0px; width: 1385px;" aria-hidden="true" class="floatThead-floatContainer floatThead-container"><table class="table table-bordered table-condensed table-hover floatThead-table" style="margin: 0px; border-bottom-width: 0px; table-layout: fixed; width: 100.65%;"><colgroup><col style="width: 51.2px;"><col style="width: 92px;"><col style="width: 67.2px;"><col style="width: 90.4px;"><col style="width: 125.6px;"><col style="width: 117.6px;"><col style="width: 98.4px;"><col style="width: 103.2px;"><col style="width: 57.6px;"><col style="width: 54.4px;"><col style="width: 104px;"><col style="width: 104px;"><col style="width: 132px;"><col style="width: 121.6px;"><col style="width: 74.4px;"></colgroup><thead><tr><th data-column-name="age" style="padding-right: 23px;">age</th><th data-column-name="workclass" style="padding-right: 23px;">workclass</th><th data-column-name="fnlwgt" style="padding-right: 23px;">fnlwgt</th><th data-column-name="education" style="padding-right: 23px;">education</th><th data-column-name="education_num" style="padding-right: 23px;">education_num</th><th data-column-name="marital_status" style="padding-right: 23px;">marital_status</th><th data-column-name="occupation" style="padding-right: 23px;">occupation</th><th data-column-name="relationship" style="padding-right: 23px;">relationship</th><th data-column-name="race" style="padding-right: 23px;">race</th><th data-column-name="sex" style="padding-right: 23px;">sex</th><th data-column-name="capital_gain" style="padding-right: 23px;">capital_gain</th><th data-column-name="capital_loss" style="padding-right: 23px;">capital_loss</th><th data-column-name="hours_per_week" style="padding-right: 23px;">hours_per_week</th><th data-column-name="native_country" style="padding-right: 23px;">native_country</th><th data-column-name="income" style="padding-right: 23px;">income</th></tr></thead></table></div></div></div><p class="plotWarning">Showing the first 1000 rows.</p></div><div class="control-wrapper"><!-- plotControlsTemplate -->
<div class="plot-controls">
  
  <a class="btn btn-small display-type-button active" data-type="table" title="Raw table">
    <i class="fa fa-table"></i>
  </a>
  <div class="btn-group btn-small" style="padding-left: 4px; padding-right: 4px;">
    <a class="btn btn-small display-type-button" data-type="barChart" title="Bar chart">
      <i class="icon-db-bar"></i>
    </a><a class="btn btn-small dropdown-toggle" data-toggle="dropdown" style="padding-left: 6px; padding-right: 6px">
    <b class="caret"></b>
  </a>
    
    <div class="dropdown-menu" role="menu">
      <div class="row-fluid" style="width: 240px">
        
        <ul class="span6 multicol-menu" style="width: 80px">
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="barChart">
              <i class="icon-db-bar fa fa-fw"></i>
              Bar
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="scatterPlot">
              <i class="icon-db-scatter fa fa-fw"></i>
              Scatter
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="mapPlot">
              <i class="icon-db-map fa fa-fw"></i>
              Map
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="mgLine">
              <i class="icon-db-line fa fa-fw"></i>
              Line
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="areaChart">
              <i class="fa fa-area-chart fa fa-fw"></i>
              Area
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="pieChart">
              <i class="icon-db-pie fa fa-fw"></i>
              Pie
            </a>
          </li>
          
          
        </ul>

        
        <ul class="span6 multicol-menu" style="width: 140px">
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="quantilePlot">
              <i class="icon-db-quantile fa fa-fw"></i>
              Quantile
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="histogram">
              <i class="icon-db-histogram fa fa-fw"></i>
              Histogram
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="boxPlot">
              <i class="icon-db-boxplot fa fa-fw"></i>
              Box plot
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="qqPlot">
              <i class="icon-db-qq fa fa-fw"></i>
              Q-Q plot
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="pivotTable">
              <i class="icon-db-pivot fa fa-fw"></i>
              Pivot
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="lineChart">
              <i class="icon-db-line fa fa-fw"></i>
              Line (deprecated)
            </a>
          </li>
          
          
        </ul>

        
      </div>
      
    </div>
  </div>
  
</div><!-- downloadControlsTemplate -->
<div class="download-controls">
  
  <div class="btn-group btn-small" style="padding-left: 4px; padding-right: 4px;">
    <a class="btn btn-small results-download-preview" title="Download CSV">
      <i class="fa fa-download"></i>
    </a><a class="btn btn-small dropdown-toggle" data-toggle="dropdown" style="padding-left: 6px; padding-right: 6px">
    <b class="caret"></b>
  </a>
    <div class="dropdown-menu" role="menu">
      <div class="row-fluid" style="">
        <ul class="span12 multicol-menu">
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="results-download-preview">
              Download preview
            </a>
          </li>
          
            <li>
              <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="results-download">
                Download full results (max 1 million rows)
              </a>
            </li>
          
        </ul>
      </div>
    </div>
  </div>
  
</div></div><div style="height: 32px;"></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div><div class="command-result-stats"><span>Command took</span> <span>1.75 seconds</span> <span class="command-provenance">-- by jeffreyzhangma@gmail.com</span><span> at 12/24/2019, 12:17:36 PM</span><span title="1224-170603-cleat207"> on My Cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298335"><i class="fa fa-link"></i>Cmd 21</a><div class="new-notebook command mainCommand command-finished cellIndex-20 cell-825169771298314-825169771298335"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-20 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-20 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>Below</span><span> </span><span>we</span><span> </span><span>will</span><span> </span><span>do</span><span> </span><span>a</span><span> </span><span>similar</span><span> </span><span>calculation</span><span> </span><span>to</span><span> </span><span>what</span><span> </span><span>we</span><span> </span><span>did</span><span> </span><span>above</span><span> </span><span>but</span><span> </span><span>using</span><span> </span><span>the</span><span> </span><span>DataFrames</span><span> </span><span>API</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="247de322-9068-43de-927b-6a455497c80b" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><p>Below we will do a similar calculation to what we did above but using the DataFrames API</p>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298336"><i class="fa fa-link"></i>Cmd 22</a><div class="new-notebook command mainCommand command-finished cellIndex-21 cell-825169771298314-825169771298336"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="edit-button edit-button-21 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-comment"># import what we will need</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-keyword">from</span><span> </span><span class="cm-variable">pyspark</span><span>.</span><span class="cm-property">sql</span><span>.</span><span class="cm-property">functions</span><span> </span><span class="cm-keyword">import</span><span> </span><span class="cm-variable">when</span><span>,</span><span> </span><span class="cm-variable">col</span><span>,</span><span> </span><span class="cm-variable">mean</span><span>,</span><span> </span><span class="cm-variable">desc</span><span>,</span><span> </span><span class="cm-builtin">round</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span class="cm-comment"># wrangle the data a bit</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">5</div></div><span class="cm-variable">df_result</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">df_adult</span><span>.</span><span class="cm-property">select</span><span>(</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">6</div></div><span>  </span><span class="cm-variable">df_adult</span><span>[</span><span class="cm-string">'occupation'</span><span>]</span><span>,</span><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">7</div></div><span>  </span><span class="cm-comment"># create a 1/0 type col on the fly</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">8</div></div><span>  </span><span class="cm-variable">when</span><span>(</span><span> </span><span class="cm-variable">col</span><span>(</span><span class="cm-string">'marital_status'</span><span>)</span><span> </span><span class="cm-operator">==</span><span> </span><span class="cm-string">' Divorced'</span><span> </span><span>,</span><span> </span><span class="cm-number">1</span><span> </span><span>)</span><span>.</span><span class="cm-property">otherwise</span><span>(</span><span class="cm-number">0</span><span>)</span><span>.</span><span class="cm-property">alias</span><span>(</span><span class="cm-string">'is_divorced'</span><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">9</div></div><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">10</div></div><span class="cm-comment"># do grouping (and a round)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">11</div></div><span class="cm-variable">df_result</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">df_result</span><span>.</span><span class="cm-property">groupBy</span><span>(</span><span class="cm-string">'occupation'</span><span>)</span><span>.</span><span class="cm-property">agg</span><span>(</span><span class="cm-builtin">round</span><span>(</span><span class="cm-variable">mean</span><span>(</span><span class="cm-string">'is_divorced'</span><span>)</span><span>,</span><span class="cm-number">2</span><span>)</span><span>.</span><span class="cm-property">alias</span><span>(</span><span class="cm-string">'divorced_rate'</span><span>)</span><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">12</div></div><span class="cm-comment"># do ordering</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">13</div></div><span class="cm-variable">df_result</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">df_result</span><span>.</span><span class="cm-property">orderBy</span><span>(</span><span class="cm-variable">desc</span><span>(</span><span class="cm-string">'divorced_rate'</span><span>)</span><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">14</div></div><span class="cm-comment"># show results</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">15</div></div><span class="cm-variable">df_result</span><span>.</span><span class="cm-property">show</span><span>(</span><span class="cm-number">5</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-fw fa-caret-right"></i>(1) Spark Jobs</p></div></div><div class="dataset-info-view"><div class=""><a class="tree-toggler"><i class="fa fa-caret-right fa-fw"></i><i class="fa fa-list-alt fa-fw"></i><span class="spacing-left">df_result:</span><span class="spacing-left">pyspark.sql.dataframe.DataFrame = [occupation: string, divorced_rate: double]</span></a></div><div class="outer-most-struct"></div></div><div class="results"><div class="ansiout">+----------------+-------------+
|      occupation|divorced_rate|
+----------------+-------------+
|    Adm-clerical|         0.22|
| Priv-house-serv|         0.19|
|    Tech-support|         0.15|
|   Other-service|         0.15|
| Exec-managerial|         0.15|
+----------------+-------------+
only showing top 5 rows

</div></div><div class="command-result-stats"><span>Command took</span> <span>2.47 seconds</span> <span class="command-provenance">-- by jeffreyzhangma@gmail.com</span><span> at 12/24/2019, 12:17:39 PM</span><span title="1224-170603-cleat207"> on My Cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298337"><i class="fa fa-link"></i>Cmd 23</a><div class="new-notebook command mainCommand command-finished cellIndex-22 cell-825169771298314-825169771298337"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-22 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-22 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>As</span><span> </span><span>you</span><span> </span><span>can</span><span> </span><span>see</span><span> </span><span>the</span><span> </span><span>dataframes</span><span> </span><span>api</span><span> </span><span>is</span><span> </span><span>a</span><span> </span><span>bit</span><span> </span><span>more</span><span> </span><span>verbose</span><span> </span><span>then</span><span> </span><span>just</span><span> </span><span>expressing</span><span> </span><span>what</span><span> </span><span>you</span><span> </span><span>want</span><span> </span><span>to</span><span> </span><span>do</span><span> </span><span>in</span><span> </span><span>standard</span><span> </span><span>SQL.</span><span class="cm-tag bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag bracket">&gt;</span><span class="cm-tag bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag bracket">&gt;</span><span>But</span><span> </span><span>some</span><span> </span><span>prefer</span><span> </span><span>it</span><span> </span><span>and</span><span> </span><span>might</span><span> </span><span>be</span><span> </span><span>more</span><span> </span><span>used</span><span> </span><span>to</span><span> </span><span>it,</span><span> </span><span>and</span><span> </span><span>there</span><span> </span><span>could</span><span> </span><span>be</span><span> </span><span>cases</span><span> </span><span>where</span><span> </span><span>expressing</span><span> </span><span>what</span><span> </span><span>you</span><span> </span><span>need</span><span> </span><span>to</span><span> </span><span>do</span><span> </span><span>might</span><span> </span><span>just</span><span> </span><span>be</span><span> </span><span>better</span><span> </span><span>using</span><span> </span><span>the</span><span> </span><span>DataFrame</span><span> </span><span>API</span><span> </span><span>if</span><span> </span><span>it</span><span> </span><span>is</span><span> </span><span>too</span><span> </span><span>complicated</span><span> </span><span>for</span><span> </span><span>a</span><span> </span><span>simple</span><span> </span><span>SQL</span><span> </span><span>expression</span><span> </span><span>for</span><span> </span><span>example</span><span> </span><span>of</span><span> </span><span>maybe</span><span> </span><span>involves</span><span> </span><span>recursion</span><span> </span><span>of</span><span> </span><span>some</span><span> </span><span>type.</span><span class="cm-trailing-space-a"> </span><span class="cm-trailing-space-new-line"> </span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="f88243a4-4c6b-41a1-bbfd-ad030aae0713" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><p>As you can see the dataframes api is a bit more verbose then just expressing what you want to do in standard SQL.<br><br>But some prefer it and might be more used to it, and there could be cases where expressing what you need to do might just be better using the DataFrame API if it is too complicated for a simple SQL expression for example of maybe involves recursion of some type.  </p>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"><i class="fa fa-minus-square-o"></i></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298338"><i class="fa fa-link"></i>Cmd 24</a><div class="new-notebook command mainCommand command-finished cellIndex-23 cell-825169771298314-825169771298338"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-23 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-23 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>#</span><span>#</span><span>#</span><span>#</span><span class="cm-tag bracket">&lt;</span><span class="cm-tag">span</span><span> </span><span class="cm-attribute">style</span><span>=</span><span class="cm-string">"color:darkblue"</span><span class="cm-tag bracket">&gt;</span><span>Question 2</span><span class="cm-tag bracket">&lt;/</span><span class="cm-tag">span</span><span class="cm-tag bracket">&gt;</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span class="cm-variable-2">1. </span><span class="cm-variable-2">Write</span><span class="cm-variable-2"></span><span class="cm-variable-2"> </span><span class="cm-variable-2">some</span><span class="cm-variable-2"> </span><span class="cm-variable-2">pyspark</span><span class="cm-variable-2"> </span><span class="cm-variable-2">to</span><span class="cm-variable-2"> </span><span class="cm-variable-2">get</span><span class="cm-variable-2"> </span><span class="cm-variable-2">the</span><span class="cm-variable-2"> </span><span class="cm-variable-2">top</span><span class="cm-variable-2"> </span><span class="cm-variable-2">'</span><span class="cm-variable-2">bachelor</span><span class="cm-variable-2">_</span><span class="cm-variable-2">rate</span><span class="cm-variable-2">'</span><span class="cm-variable-2"> </span><span class="cm-variable-2">by</span><span class="cm-variable-2"> </span><span class="cm-variable-2">'</span><span class="cm-variable-2">education</span><span class="cm-variable-2">'</span><span class="cm-variable-2"> </span><span class="cm-variable-2">group</span><span class="cm-variable-2"> </span><span class="cm-variable-2">using</span><span class="cm-variable-2"> </span><span class="cm-variable-2">DataFrame</span><span class="cm-variable-2"> </span><span class="cm-variable-2">operations?</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="e5429f9b-d830-46af-ac7a-ce15bece1c85" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h4><span style="color:darkblue;">Question 2</span></h4>
<ol>
<li>Write some pyspark to get the top 'bachelor_rate' by 'education' group using DataFrame operations?</li>
</ol>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298339"><i class="fa fa-link"></i>Cmd 25</a><div class="new-notebook command mainCommand command-finished cellIndex-24 cell-825169771298314-825169771298339"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="edit-button edit-button-24 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 104px; left: 180.4px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="1"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 256px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 150.4px; top: 92px; height: 18.4px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">### Question 2.1 Answer ###</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># wrangle the data a bit</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">df_result</span> <span class="cm-operator">=</span> <span class="cm-variable">df_adult</span>.<span class="cm-property">select</span>(</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">df_adult</span>[<span class="cm-string">'education'</span>], </span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># create boolean</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">when</span>( <span class="cm-variable">col</span>(<span class="cm-string">'marital_status'</span>) <span class="cm-operator">==</span> <span class="cm-string">' Never-married'</span> , <span class="cm-number">1</span> ).<span class="cm-property">otherwise</span>(<span class="cm-number">0</span>).<span class="cm-property">alias</span>(<span class="cm-string">'is_bachelor'</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># group and round</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">10</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">df_result</span> <span class="cm-operator">=</span> <span class="cm-variable">df_result</span>.<span class="cm-property">groupBy</span>(<span class="cm-string">'education'</span>).<span class="cm-property">agg</span>(<span class="cm-builtin">round</span>(<span class="cm-variable">mean</span>(<span class="cm-string">'is_bachelor'</span>),<span class="cm-number">2</span>).<span class="cm-property">alias</span>(<span class="cm-string">'bachelor_rate'</span>))</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">11</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># order</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">12</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">df_result</span> <span class="cm-operator">=</span> <span class="cm-variable">df_result</span>.<span class="cm-property">orderBy</span>(<span class="cm-variable">desc</span>(<span class="cm-string">'bachelor_rate'</span>))</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">13</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">df_result</span>.<span class="cm-property">show</span>(<span class="cm-number">1</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 256px;"></div><div class="CodeMirror-gutters" style="height: 269px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-fw fa-caret-right"></i>(1) Spark Jobs</p></div></div><div class="dataset-info-view"><div class=""><a class="tree-toggler"><i class="fa fa-caret-right fa-fw"></i><i class="fa fa-list-alt fa-fw"></i><span class="spacing-left">df_result:</span><span class="spacing-left">pyspark.sql.dataframe.DataFrame = [education: string, bachelor_rate: double]</span></a></div><div class="outer-most-struct"></div></div><div class="results"><div class="ansiout">+---------+-------------+
|education|bachelor_rate|
+---------+-------------+
|     12th|         0.54|
+---------+-------------+
only showing top 1 row

</div></div><div class="command-result-stats"><span>Command took</span> <span>2.08 seconds</span> <span class="command-provenance">-- by jeffreyzhangma@gmail.com</span><span> at 12/24/2019, 12:24:30 PM</span><span title="1224-170603-cleat207"> on My Cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"><i class="fa fa-minus-square-o"></i></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298340"><i class="fa fa-link"></i>Cmd 26</a><div class="new-notebook command mainCommand command-finished cellIndex-25 cell-825169771298314-825169771298340"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-25 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-25 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>#</span><span>#</span><span>#</span><span>#</span><span>Explore</span><span> </span><span>&amp;</span><span> </span><span>Visualize</span><span> </span><span>Data</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span>It</span><span>'</span><span>s</span><span> </span><span>very</span><span> </span><span>easy</span><span> </span><span>to</span><span> </span><span class="cm-link">[</span><span class="cm-link">collect</span><span class="cm-link">(</span><span class="cm-link">)</span><span class="cm-link">]</span><span class="cm-string url">(</span><span class="cm-string url">https://spark.apache.org/docs/latest/rdd-programming-guide.html#printing-elements-of-an-rdd</span><span class="cm-string url">)</span><span> </span><span>your</span><span> </span><span>Spark</span><span> </span><span>DataFrame</span><span> </span><span>data</span><span> </span><span>into</span><span> </span><span>a</span><span> </span><span>Pandas</span><span> </span><span>df</span><span> </span><span>and</span><span> </span><span>then</span><span> </span><span>continue</span><span> </span><span>to</span><span> </span><span>analyse</span><span> </span><span>or</span><span> </span><span>plot</span><span> </span><span>as</span><span> </span><span>you</span><span> </span><span>might</span><span> </span><span>normally.</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span class="cm-tag bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag bracket">&gt;</span><span class="cm-tag bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag bracket">&gt;</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">5</div></div><span>Obviously</span><span> </span><span>if</span><span> </span><span>you</span><span> </span><span>try</span><span> </span><span>to</span><span> </span><span>collect</span><span>(</span><span>)</span><span> </span><span>a</span><span> </span><span>huge</span><span> </span><span>DataFrame</span><span> </span><span>then</span><span> </span><span>you</span><span> </span><span>will</span><span> </span><span>run</span><span> </span><span>into</span><span> </span><span>issues,</span><span> </span><span>so</span><span> </span><span>usually</span><span> </span><span>you</span><span> </span><span>would</span><span> </span><span>only</span><span> </span><span>collect</span><span> </span><span>aggregated</span><span> </span><span>or</span><span> </span><span>sampled</span><span> </span><span>data</span><span> </span><span>into</span><span> </span><span>a</span><span> </span><span>Pandas</span><span> </span><span>df.</span><span> </span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="485206b5-f0a4-4042-ae71-9728ac44b854" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h4>Explore &amp; Visualize Data</h4>
<p>It's very easy to <a href="https://spark.apache.org/docs/latest/rdd-programming-guide.html#printing-elements-of-an-rdd">collect()</a> your Spark DataFrame data into a Pandas df and then continue to analyse or plot as you might normally.
<br><br>
Obviously if you try to collect() a huge DataFrame then you will run into issues, so usually you would only collect aggregated or sampled data into a Pandas df. </p>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298341"><i class="fa fa-link"></i>Cmd 27</a><div class="new-notebook command mainCommand command-finished cellIndex-26 cell-825169771298314-825169771298341"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="edit-button edit-button-26 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-keyword">import</span><span> </span><span class="cm-variable">pandas</span><span> </span><span class="cm-keyword">as</span><span> </span><span class="cm-variable">pd</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span class="cm-comment"># do some analysis</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span class="cm-variable">result</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">spark</span><span>.</span><span class="cm-property">sql</span><span>(</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">5</div></div><span>  </span><span class="cm-string">"""</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">6</div></div><span class="cm-string">  SELECT </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">7</div></div><span class="cm-string">    occupation,</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">8</div></div><span class="cm-string">    AVG(IF(income = ' &gt;50K',1,0)) as plus_50k</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">9</div></div><span class="cm-string">  FROM </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">10</div></div><span class="cm-string">    adult </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">11</div></div><span class="cm-string">  GROUP BY 1</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">12</div></div><span class="cm-string">  ORDER BY 2 DESC</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">13</div></div><span class="cm-string">  """</span><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">14</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">15</div></div><span class="cm-comment"># collect results into a pandas df</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">16</div></div><span class="cm-variable">df_pandas</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">pd</span><span>.</span><span class="cm-property">DataFrame</span><span>(</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">17</div></div><span>  </span><span class="cm-variable">result</span><span>.</span><span class="cm-property">collect</span><span>(</span><span>)</span><span>,</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">18</div></div><span>  </span><span class="cm-variable">columns</span><span class="cm-operator">=</span><span class="cm-variable">result</span><span>.</span><span class="cm-property">schema</span><span>.</span><span class="cm-property">names</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">19</div></div><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">20</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">21</div></div><span class="cm-comment"># look at df</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">22</div></div><span class="cm-builtin">print</span><span>(</span><span class="cm-variable">df_pandas</span><span>.</span><span class="cm-property">head</span><span>(</span><span>)</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-fw fa-caret-right"></i>(2) Spark Jobs</p></div></div><div class="dataset-info-view"><div class=""><a class="tree-toggler"><i class="fa fa-caret-right fa-fw"></i><i class="fa fa-list-alt fa-fw"></i><span class="spacing-left">result:</span><span class="spacing-left">pyspark.sql.dataframe.DataFrame = [occupation: string, plus_50k: double]</span></a></div><div class="outer-most-struct"></div></div><div class="results"><div class="ansiout">         occupation  plus_50k
0   Exec-managerial  0.484014
1    Prof-specialty  0.449034
2   Protective-serv  0.325116
3      Tech-support  0.304957
4             Sales  0.269315
</div></div><div class="command-result-stats"><span>Command took</span> <span>4.03 seconds</span> <span class="command-provenance">-- by jeffreyzhangma@gmail.com</span><span> at 12/24/2019, 12:24:39 PM</span><span title="1224-170603-cleat207"> on My Cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298342"><i class="fa fa-link"></i>Cmd 28</a><div class="new-notebook command mainCommand command-finished cellIndex-27 cell-825169771298314-825169771298342"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="edit-button edit-button-27 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-builtin">print</span><span>(</span><span class="cm-variable">df_pandas</span><span>.</span><span class="cm-property">describe</span><span>(</span><span>)</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="results"><div class="ansiout">        plus_50k
count  15.000000
mean    0.197357
std     0.143993
min     0.006711
25%     0.107373
50%     0.134518
75%     0.287136
max     0.484014
</div></div><div class="command-result-stats"><span>Command took</span> <span>0.05 seconds</span> <span class="command-provenance">-- by jeffreyzhangma@gmail.com</span><span> at 12/24/2019, 12:24:47 PM</span><span title="1224-170603-cleat207"> on My Cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298343"><i class="fa fa-link"></i>Cmd 29</a><div class="new-notebook command mainCommand command-finished cellIndex-28 cell-825169771298314-825169771298343"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="edit-button edit-button-28 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-builtin">print</span><span>(</span><span class="cm-variable">df_pandas</span><span>.</span><span class="cm-property">info</span><span>(</span><span>)</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="results"><div class="ansiout">&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 15 entries, 0 to 14
Data columns (total 2 columns):
occupation    15 non-null object
plus_50k      15 non-null float64
dtypes: float64(1), object(1)
memory usage: 320.0+ bytes
None
</div></div><div class="command-result-stats"><span>Command took</span> <span>0.04 seconds</span> <span class="command-provenance">-- by jeffreyzhangma@gmail.com</span><span> at 12/24/2019, 12:24:51 PM</span><span title="1224-170603-cleat207"> on My Cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298344"><i class="fa fa-link"></i>Cmd 30</a><div class="new-notebook command mainCommand command-finished cellIndex-29 cell-825169771298314-825169771298344"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-29 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-29 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>Here</span><span> </span><span>we</span><span> </span><span>will</span><span> </span><span>just</span><span> </span><span>do</span><span> </span><span>some</span><span> </span><span>very</span><span> </span><span>basic</span><span> </span><span>plotting</span><span> </span><span>to</span><span> </span><span>show</span><span> </span><span>how</span><span> </span><span>you</span><span> </span><span>might</span><span> </span><span>collect</span><span> </span><span>what</span><span> </span><span>you</span><span> </span><span>are</span><span> </span><span>interested</span><span> </span><span>in</span><span> </span><span>into</span><span> </span><span>a</span><span> </span><span>Pandas</span><span> </span><span>DF</span><span> </span><span>and</span><span> </span><span>then</span><span> </span><span>just</span><span> </span><span>plot</span><span> </span><span>any</span><span> </span><span>way</span><span> </span><span>you</span><span> </span><span>normally</span><span> </span><span>would.</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span>For</span><span> </span><span>simplicity</span><span> </span><span>we</span><span> </span><span>are</span><span> </span><span>going</span><span> </span><span>to</span><span> </span><span>use</span><span> </span><span>the</span><span> </span><span>plotting</span><span> </span><span>functionality</span><span> </span><span>built</span><span> </span><span>into</span><span> </span><span>pandas</span><span> </span><span>(</span><span>you</span><span> </span><span>could</span><span> </span><span>make</span><span> </span><span>this</span><span> </span><span>a</span><span> </span><span>pretty</span><span> </span><span>as</span><span> </span><span>you</span><span> </span><span>want).</span><span> </span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="f9d4cbd1-6bcf-4e85-8548-76f16612fc28" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><p>Here we will just do some very basic plotting to show how you might collect what you are interested in into a Pandas DF and then just plot any way you normally would.</p>
<p>For simplicity we are going to use the plotting functionality built into pandas (you could make this a pretty as you want). </p>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298345"><i class="fa fa-link"></i>Cmd 31</a><div class="new-notebook command mainCommand command-finished cellIndex-30 cell-825169771298314-825169771298345"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="dashboard-button dashboard-button-30 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-30 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-keyword">import</span><span> </span><span class="cm-variable">matplotlib</span><span>.</span><span class="cm-property">pyplot</span><span> </span><span class="cm-keyword">as</span><span> </span><span class="cm-variable">plt</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span class="cm-comment"># i like ggplot style</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span class="cm-variable">plt</span><span>.</span><span class="cm-property">style</span><span>.</span><span class="cm-property">use</span><span>(</span><span class="cm-string">'ggplot'</span><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">5</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">6</div></div><span class="cm-comment"># get simple plot on the pandas data</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">7</div></div><span class="cm-variable">myplot</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">df_pandas</span><span>.</span><span class="cm-property">plot</span><span>(</span><span class="cm-variable">kind</span><span class="cm-operator">=</span><span class="cm-string">'barh'</span><span>,</span><span> </span><span class="cm-variable">x</span><span class="cm-operator">=</span><span class="cm-string">'occupation'</span><span>,</span><span> </span><span class="cm-variable">y</span><span class="cm-operator">=</span><span class="cm-string">'plus_50k'</span><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">8</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">9</div></div><span class="cm-comment"># display the plot (note - display() is a databricks function - </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">10</div></div><span class="cm-comment"># more info on plotting in Databricks is here: https://docs.databricks.com/user-guide/visualizations/matplotlib-and-ggplot.html)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">11</div></div><span class="cm-variable">display</span><span>(</span><span class="cm-variable">myplot</span><span>.</span><span class="cm-property">figure</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget ui-resizable" data-guid="f000315e-7cfc-426e-8745-9f23e9d99605" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se" style="z-index: 90; display: block;"></div><div class="widget-content dashboard"><div class="results" style="height: inherit;"><div class="figure"><img class="" src="./Spark DF, SQL, ML Exercise - Databricks Community Edition_files/_plots_ceb8b9a5-dfed-4221-8b6d-570bb0d0afec.png"></div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div><div class="command-result-stats"><span>Command took</span> <span>6.25 seconds</span> <span class="command-provenance">-- by jeffreyzhangma@gmail.com</span><span> at 12/24/2019, 12:25:47 PM</span><span title="1224-170603-cleat207"> on My Cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298346"><i class="fa fa-link"></i>Cmd 32</a><div class="new-notebook command mainCommand command-finished cellIndex-31 cell-825169771298314-825169771298346"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-31 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-31 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>You</span><span> </span><span>can</span><span> </span><span>also</span><span> </span><span>easily</span><span> </span><span>get</span><span> </span><span>summary</span><span> </span><span>stats</span><span> </span><span>on</span><span> </span><span>a</span><span> </span><span>Spark</span><span> </span><span>DataFrame</span><span> </span><span>like</span><span> </span><span>below.</span><span> </span><span class="cm-link">[</span><span class="cm-link">Here</span><span class="cm-link">]</span><span class="cm-string url">(</span><span class="cm-string url">https://databricks.com/blog/2015/06/02/statistical-and-mathematical-functions-with-dataframes-in-spark.html</span><span class="cm-string url">)</span><span> </span><span>is</span><span> </span><span>a</span><span> </span><span>nice</span><span> </span><span>blog</span><span> </span><span>post</span><span> </span><span>that</span><span> </span><span>has</span><span> </span><span>more</span><span> </span><span>examples.</span><span class="cm-tag bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag bracket">&gt;</span><span class="cm-tag bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag bracket">&gt;</span><span>So</span><span> </span><span>this</span><span> </span><span>is</span><span> </span><span>an</span><span> </span><span>example</span><span> </span><span>of</span><span> </span><span>why</span><span> </span><span>you</span><span> </span><span>might</span><span> </span><span>want</span><span> </span><span>to</span><span> </span><span>move</span><span> </span><span>from</span><span> </span><span>Spark</span><span> </span><span>SQL</span><span> </span><span>into</span><span> </span><span>DataFrames</span><span> </span><span>API</span><span> </span><span>as</span><span> </span><span>being</span><span> </span><span>able</span><span> </span><span>to</span><span> </span><span>just</span><span> </span><span>call</span><span> </span><span>describe</span><span>(</span><span>)</span><span> </span><span>on</span><span> </span><span>the</span><span> </span><span>Spark</span><span> </span><span>DF</span><span> </span><span>is</span><span> </span><span>easier</span><span> </span><span>then</span><span> </span><span>trying</span><span> </span><span>to</span><span> </span><span>do</span><span> </span><span>the</span><span> </span><span>equivilant</span><span> </span><span>in</span><span> </span><span>Spark</span><span> </span><span>SQL.</span><span class="cm-trailing-space-a"> </span><span class="cm-trailing-space-new-line"> </span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="fa5fcd28-42fd-4ade-9828-dc6f80d8217e" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><p>You can also easily get summary stats on a Spark DataFrame like below. <a href="https://databricks.com/blog/2015/06/02/statistical-and-mathematical-functions-with-dataframes-in-spark.html">Here</a> is a nice blog post that has more examples.<br><br>So this is an example of why you might want to move from Spark SQL into DataFrames API as being able to just call describe() on the Spark DF is easier then trying to do the equivilant in Spark SQL.  </p>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298347"><i class="fa fa-link"></i>Cmd 33</a><div class="new-notebook command mainCommand command-finished cellIndex-32 cell-825169771298314-825169771298347"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="edit-button edit-button-32 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-comment"># describe df</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-variable">df_adult</span><span>.</span><span class="cm-property">select</span><span>(</span><span class="cm-variable">df_adult</span><span>[</span><span class="cm-string">'age'</span><span>]</span><span>,</span><span class="cm-variable">df_adult</span><span>[</span><span class="cm-string">'education_num'</span><span>]</span><span>)</span><span>.</span><span class="cm-property">describe</span><span>(</span><span>)</span><span>.</span><span class="cm-property">show</span><span>(</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-fw fa-caret-right"></i>(1) Spark Jobs</p></div></div><div class="results"><div class="ansiout">+-------+------------------+------------------+
|summary|               age|     education_num|
+-------+------------------+------------------+
|  count|             32560|             32560|
|   mean|38.581633906633904| 10.08058968058968|
| stddev|13.640641827464002|2.5727089681052058|
|    min|              17.0|               1.0|
|    max|              90.0|              16.0|
+-------+------------------+------------------+

</div></div><div class="command-result-stats"><span>Command took</span> <span>0.66 seconds</span> <span class="command-provenance">-- by jeffreyzhangma@gmail.com</span><span> at 12/24/2019, 12:26:04 PM</span><span title="1224-170603-cleat207"> on My Cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"><i class="fa fa-minus-square-o"></i></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298348"><i class="fa fa-link"></i>Cmd 34</a><div class="new-notebook command mainCommand command-finished cellIndex-33 cell-825169771298314-825169771298348"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-33 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-33 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span class="cm-header header-3">### </span><span class="cm-header header-3">ML</span><span class="cm-header header-3"> </span><span class="cm-header header-3">Pipeline</span><span class="cm-header header-3"> </span><span class="cm-header header-3">-</span><span class="cm-header header-3"> </span><span class="cm-header header-3">Logistic</span><span class="cm-header header-3"> </span><span class="cm-header header-3">Regression</span><span class="cm-header header-3"> </span><span class="cm-header header-3">vs</span><span class="cm-header header-3"> </span><span class="cm-header header-3">Random</span><span class="cm-header header-3"> </span><span class="cm-header header-3">Forest</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">5</div></div><span>Below</span><span> </span><span>we</span><span> </span><span>will</span><span> </span><span>create</span><span> </span><span>two</span><span> </span><span class="cm-link">[</span><span class="cm-link">Spark</span><span class="cm-link"> </span><span class="cm-link">ML</span><span class="cm-link"> </span><span class="cm-link">Pipelines</span><span class="cm-link">]</span><span class="cm-string url">(</span><span class="cm-string url">https://spark.apache.org/docs/latest/ml-pipeline.html</span><span class="cm-string url">)</span><span> </span><span>-</span><span> </span><span>one</span><span> </span><span>that</span><span> </span><span>fits</span><span> </span><span>a</span><span> </span><span>logistic</span><span> </span><span>regression</span><span> </span><span>and</span><span> </span><span>one</span><span> </span><span>that</span><span> </span><span>fits</span><span> </span><span>a</span><span> </span><span>random</span><span> </span><span>forest.</span><span> </span><span>We</span><span> </span><span>will</span><span> </span><span>then</span><span> </span><span>compare</span><span> </span><span>the</span><span> </span><span>performance</span><span> </span><span>of</span><span> </span><span>each.</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">6</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">7</div></div><span class="cm-strong">**</span><span class="cm-strong">Note</span><span class="cm-strong">**</span><span>:</span><span> </span><span>A</span><span> </span><span>lot</span><span> </span><span>of</span><span> </span><span>the</span><span> </span><span>code</span><span> </span><span>below</span><span> </span><span>is</span><span> </span><span>adapted</span><span> </span><span>from</span><span> </span><span class="cm-link">[</span><span class="cm-link">this</span><span class="cm-link"> </span><span class="cm-link">example</span><span class="cm-link">]</span><span class="cm-string url">(</span><span class="cm-string url">https://docs.databricks.com/spark/latest/mllib/binary-classification-mllib-pipelines.html</span><span class="cm-string url">)</span><span>.</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="8676c835-9e14-4408-b313-0b4368052a3e" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h3>ML Pipeline - Logistic Regression vs Random Forest</h3>
<p>Below we will create two <a href="https://spark.apache.org/docs/latest/ml-pipeline.html">Spark ML Pipelines</a> - one that fits a logistic regression and one that fits a random forest. We will then compare the performance of each.</p>
<p><strong>Note</strong>: A lot of the code below is adapted from <a href="https://docs.databricks.com/spark/latest/mllib/binary-classification-mllib-pipelines.html">this example</a>.</p>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298349"><i class="fa fa-link"></i>Cmd 35</a><div class="new-notebook command mainCommand command-finished cellIndex-34 cell-825169771298314-825169771298349"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="edit-button edit-button-34 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-keyword">from</span><span> </span><span class="cm-variable">pyspark</span><span>.</span><span class="cm-property">ml</span><span> </span><span class="cm-keyword">import</span><span> </span><span class="cm-variable">Pipeline</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-keyword">from</span><span> </span><span class="cm-variable">pyspark</span><span>.</span><span class="cm-property">ml</span><span>.</span><span class="cm-property">feature</span><span> </span><span class="cm-keyword">import</span><span> </span><span class="cm-variable">OneHotEncoderEstimator</span><span>,</span><span> </span><span class="cm-variable">StringIndexer</span><span>,</span><span> </span><span class="cm-variable">VectorAssembler</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span class="cm-variable">categoricalColumns</span><span> </span><span class="cm-operator">=</span><span> </span><span>[</span><span class="cm-string">"workclass"</span><span>,</span><span> </span><span class="cm-string">"education"</span><span>,</span><span> </span><span class="cm-string">"marital_status"</span><span>,</span><span> </span><span class="cm-string">"occupation"</span><span>,</span><span> </span><span class="cm-string">"relationship"</span><span>,</span><span> </span><span class="cm-string">"race"</span><span>,</span><span> </span><span class="cm-string">"sex"</span><span>,</span><span> </span><span class="cm-string">"native_country"</span><span>]</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">5</div></div><span class="cm-variable">stages</span><span> </span><span class="cm-operator">=</span><span> </span><span>[</span><span>]</span><span> </span><span class="cm-comment"># stages in our Pipeline</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">6</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">7</div></div><span class="cm-keyword">for</span><span> </span><span class="cm-variable">categoricalCol</span><span> </span><span class="cm-keyword">in</span><span> </span><span class="cm-variable">categoricalColumns</span><span>:</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">8</div></div><span>    </span><span class="cm-comment"># Category Indexing with StringIndexer</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">9</div></div><span>    </span><span class="cm-variable">stringIndexer</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">StringIndexer</span><span>(</span><span class="cm-variable">inputCol</span><span class="cm-operator">=</span><span class="cm-variable">categoricalCol</span><span>,</span><span> </span><span class="cm-variable">outputCol</span><span class="cm-operator">=</span><span class="cm-variable">categoricalCol</span><span> </span><span class="cm-operator">+</span><span> </span><span class="cm-string">"Index"</span><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">10</div></div><span>    </span><span class="cm-comment"># Use OneHotEncoder to convert categorical variables into binary SparseVectors</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">11</div></div><span>    </span><span class="cm-comment"># encoder = OneHotEncoderEstimator(inputCol=categoricalCol + "Index", outputCol=categoricalCol + "classVec")</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">12</div></div><span>    </span><span class="cm-variable">encoder</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">OneHotEncoderEstimator</span><span>(</span><span class="cm-variable">inputCols</span><span class="cm-operator">=</span><span>[</span><span class="cm-variable">stringIndexer</span><span>.</span><span class="cm-property">getOutputCol</span><span>(</span><span>)</span><span>]</span><span>,</span><span> </span><span class="cm-variable">outputCols</span><span class="cm-operator">=</span><span>[</span><span class="cm-variable">categoricalCol</span><span> </span><span class="cm-operator">+</span><span> </span><span class="cm-string">"classVec"</span><span>]</span><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">13</div></div><span>    </span><span class="cm-comment"># Add stages.  These are not run here, but will run all at once later on.</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">14</div></div><span>    </span><span class="cm-variable">stages</span><span> </span><span class="cm-operator">+=</span><span> </span><span>[</span><span class="cm-variable">stringIndexer</span><span>,</span><span> </span><span class="cm-variable">encoder</span><span>]</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.19 seconds</span> <span class="command-provenance">-- by jeffreyzhangma@gmail.com</span><span> at 12/24/2019, 12:26:08 PM</span><span title="1224-170603-cleat207"> on My Cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298350"><i class="fa fa-link"></i>Cmd 36</a><div class="new-notebook command mainCommand command-finished cellIndex-35 cell-825169771298314-825169771298350"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="edit-button edit-button-35 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-comment"># Convert label into label indices using the StringIndexer</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-variable">label_stringIdx</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">StringIndexer</span><span>(</span><span class="cm-variable">inputCol</span><span class="cm-operator">=</span><span class="cm-string">"income"</span><span>,</span><span> </span><span class="cm-variable">outputCol</span><span class="cm-operator">=</span><span class="cm-string">"label"</span><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span class="cm-variable">stages</span><span> </span><span class="cm-operator">+=</span><span> </span><span>[</span><span class="cm-variable">label_stringIdx</span><span>]</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.04 seconds</span> <span class="command-provenance">-- by jeffreyzhangma@gmail.com</span><span> at 12/24/2019, 12:26:11 PM</span><span title="1224-170603-cleat207"> on My Cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298351"><i class="fa fa-link"></i>Cmd 37</a><div class="new-notebook command mainCommand command-finished cellIndex-36 cell-825169771298314-825169771298351"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="edit-button edit-button-36 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-comment"># Transform all features into a vector using VectorAssembler</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-variable">numericCols</span><span> </span><span class="cm-operator">=</span><span> </span><span>[</span><span class="cm-string">"age"</span><span>,</span><span> </span><span class="cm-string">"fnlwgt"</span><span>,</span><span> </span><span class="cm-string">"education_num"</span><span>,</span><span> </span><span class="cm-string">"capital_gain"</span><span>,</span><span> </span><span class="cm-string">"capital_loss"</span><span>,</span><span> </span><span class="cm-string">"hours_per_week"</span><span>]</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span class="cm-variable">assemblerInputs</span><span> </span><span class="cm-operator">=</span><span> </span><span>[</span><span class="cm-variable">c</span><span> </span><span class="cm-operator">+</span><span> </span><span class="cm-string">"classVec"</span><span> </span><span class="cm-keyword">for</span><span> </span><span class="cm-variable">c</span><span> </span><span class="cm-keyword">in</span><span> </span><span class="cm-variable">categoricalColumns</span><span>]</span><span> </span><span class="cm-operator">+</span><span> </span><span class="cm-variable">numericCols</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span class="cm-variable">assembler</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">VectorAssembler</span><span>(</span><span class="cm-variable">inputCols</span><span class="cm-operator">=</span><span class="cm-variable">assemblerInputs</span><span>,</span><span> </span><span class="cm-variable">outputCol</span><span class="cm-operator">=</span><span class="cm-string">"features"</span><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">5</div></div><span class="cm-variable">stages</span><span> </span><span class="cm-operator">+=</span><span> </span><span>[</span><span class="cm-variable">assembler</span><span>]</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.04 seconds</span> <span class="command-provenance">-- by jeffreyzhangma@gmail.com</span><span> at 12/24/2019, 12:26:13 PM</span><span title="1224-170603-cleat207"> on My Cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298352"><i class="fa fa-link"></i>Cmd 38</a><div class="new-notebook command mainCommand command-finished cellIndex-37 cell-825169771298314-825169771298352"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="dashboard-button dashboard-button-37 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-37 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-comment"># Create a Pipeline.</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-variable">pipeline</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">Pipeline</span><span>(</span><span class="cm-variable">stages</span><span class="cm-operator">=</span><span class="cm-variable">stages</span><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span class="cm-comment"># Run the feature transformations.</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span class="cm-comment">#  - fit() computes feature statistics as needed.</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">5</div></div><span class="cm-comment">#  - transform() actually transforms the features.</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">6</div></div><span class="cm-variable">pipelineModel</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">pipeline</span><span>.</span><span class="cm-property">fit</span><span>(</span><span class="cm-variable">df_adult</span><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">7</div></div><span class="cm-variable">dataset</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">pipelineModel</span><span>.</span><span class="cm-property">transform</span><span>(</span><span class="cm-variable">df_adult</span><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">8</div></div><span class="cm-comment"># Keep relevant columns</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">9</div></div><span class="cm-variable">selectedcols</span><span> </span><span class="cm-operator">=</span><span> </span><span>[</span><span class="cm-string">"label"</span><span>,</span><span> </span><span class="cm-string">"features"</span><span>]</span><span> </span><span class="cm-operator">+</span><span> </span><span class="cm-variable">cols</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">10</div></div><span class="cm-variable">dataset</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">dataset</span><span>.</span><span class="cm-property">select</span><span>(</span><span class="cm-variable">selectedcols</span><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">11</div></div><span class="cm-variable">display</span><span>(</span><span class="cm-variable">dataset</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-fw fa-caret-right"></i>(10) Spark Jobs</p></div></div><div class="dataset-info-view"><div class=""><a class="tree-toggler"><i class="fa fa-caret-right fa-fw"></i><i class="fa fa-list-alt fa-fw"></i><span class="spacing-left">dataset:</span><span class="spacing-left">pyspark.sql.dataframe.DataFrame = [label: double, features: udt ... 15 more fields]</span></a></div><div class="outer-most-struct"></div></div><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget ui-resizable" data-guid="d3037958-0067-4cb6-bc06-4a76dcf983f7" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se" style="z-index: 90; display: block;"></div><div class="widget-content dashboard"><div class="results"><div class="results-table noscroll" tabindex="-1"><div class="floatThead-wrapper" style="position: relative; clear:both;"><div class="inner"><table class="table table-bordered table-condensed table-hover" style="table-layout: fixed; min-width: 1699px;"><colgroup><col style="width: 58.4px;"><col style="width: 246.4px;"><col style="width: 52px;"><col style="width: 92px;"><col style="width: 67.2px;"><col style="width: 90.4px;"><col style="width: 125.6px;"><col style="width: 117.6px;"><col style="width: 98.4px;"><col style="width: 103.2px;"><col style="width: 57.6px;"><col style="width: 54.4px;"><col style="width: 104px;"><col style="width: 104px;"><col style="width: 132px;"><col style="width: 121.6px;"><col style="width: 74.4px;"></colgroup><thead><tr class="size-row" style="height: 36px;"><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th></tr></thead><tbody><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[1,10,23,31,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,50,83311,13,13]]</td><td>50</td><td> Self-emp-not-inc</td><td>83311</td><td> Bachelors</td><td>13</td><td> Married-civ-spouse</td><td> Exec-managerial</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>13</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,25,38,44,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,38,215646,9,40]]</td><td>38</td><td> Private</td><td>215646</td><td> HS-grad</td><td>9</td><td> Divorced</td><td> Handlers-cleaners</td><td> Not-in-family</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,13,23,38,43,49,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,53,234721,7,40]]</td><td>53</td><td> Private</td><td>234721</td><td> 11th</td><td>7</td><td> Married-civ-spouse</td><td> Handlers-cleaners</td><td> Husband</td><td> Black</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,10,23,29,47,49,62,94,95,96,99],[1,1,1,1,1,1,1,28,338409,13,40]]</td><td>28</td><td> Private</td><td>338409</td><td> Bachelors</td><td>13</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Wife</td><td> Black</td><td> Female</td><td>0</td><td>0</td><td>40</td><td> Cuba</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,11,23,31,47,48,53,94,95,96,99],[1,1,1,1,1,1,1,37,284582,14,40]]</td><td>37</td><td> Private</td><td>284582</td><td> Masters</td><td>14</td><td> Married-civ-spouse</td><td> Exec-managerial</td><td> Wife</td><td> White</td><td> Female</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,18,28,34,44,49,64,94,95,96,99],[1,1,1,1,1,1,1,49,160187,5,16]]</td><td>49</td><td> Private</td><td>160187</td><td> 9th</td><td>5</td><td> Married-spouse-absent</td><td> Other-service</td><td> Not-in-family</td><td> Black</td><td> Female</td><td>0</td><td>0</td><td>16</td><td> Jamaica</td><td> &lt;=50K</td></tr><tr><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[1,8,23,31,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,52,209642,9,45]]</td><td>52</td><td> Self-emp-not-inc</td><td>209642</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Exec-managerial</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>45</td><td> United-States</td><td> &gt;50K</td></tr><tr><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,11,24,29,44,48,53,94,95,96,97,99],[1,1,1,1,1,1,1,31,45781,14,14084,50]]</td><td>31</td><td> Private</td><td>45781</td><td> Masters</td><td>14</td><td> Never-married</td><td> Prof-specialty</td><td> Not-in-family</td><td> White</td><td> Female</td><td>14084</td><td>0</td><td>50</td><td> United-States</td><td> &gt;50K</td></tr><tr><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,10,23,31,43,48,52,53,94,95,96,97,99],[1,1,1,1,1,1,1,1,42,159449,13,5178,40]]</td><td>42</td><td> Private</td><td>159449</td><td> Bachelors</td><td>13</td><td> Married-civ-spouse</td><td> Exec-managerial</td><td> Husband</td><td> White</td><td> Male</td><td>5178</td><td>0</td><td>40</td><td> United-States</td><td> &gt;50K</td></tr><tr><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,9,23,31,43,49,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,37,280464,10,80]]</td><td>37</td><td> Private</td><td>280464</td><td> Some-college</td><td>10</td><td> Married-civ-spouse</td><td> Exec-managerial</td><td> Husband</td><td> Black</td><td> Male</td><td>0</td><td>0</td><td>80</td><td> United-States</td><td> &gt;50K</td></tr><tr><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[4,10,23,29,43,50,52,61,94,95,96,99],[1,1,1,1,1,1,1,1,30,141297,13,40]]</td><td>30</td><td> State-gov</td><td>141297</td><td> Bachelors</td><td>13</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Husband</td><td> Asian-Pac-Islander</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> India</td><td> &gt;50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,10,24,32,45,48,53,94,95,96,99],[1,1,1,1,1,1,1,23,122272,13,30]]</td><td>23</td><td> Private</td><td>122272</td><td> Bachelors</td><td>13</td><td> Never-married</td><td> Adm-clerical</td><td> Own-child</td><td> White</td><td> Female</td><td>0</td><td>0</td><td>30</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,14,24,33,44,49,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,32,205019,12,50]]</td><td>32</td><td> Private</td><td>205019</td><td> Assoc-acdm</td><td>12</td><td> Never-married</td><td> Sales</td><td> Not-in-family</td><td> Black</td><td> Male</td><td>0</td><td>0</td><td>50</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,12,23,30,43,50,52,55,94,95,96,99],[1,1,1,1,1,1,1,1,40,121772,11,40]]</td><td>40</td><td> Private</td><td>121772</td><td> Assoc-voc</td><td>11</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> Asian-Pac-Islander</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> ?</td><td> &gt;50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,16,23,37,43,51,52,54,94,95,96,99],[1,1,1,1,1,1,1,1,34,245487,4,45]]</td><td>34</td><td> Private</td><td>245487</td><td> 7th-8th</td><td>4</td><td> Married-civ-spouse</td><td> Transport-moving</td><td> Husband</td><td> Amer-Indian-Eskimo</td><td> Male</td><td>0</td><td>0</td><td>45</td><td> Mexico</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[1,8,24,39,45,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,25,176756,9,35]]</td><td>25</td><td> Self-emp-not-inc</td><td>176756</td><td> HS-grad</td><td>9</td><td> Never-married</td><td> Farming-fishing</td><td> Own-child</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>35</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,24,35,46,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,32,186824,9,40]]</td><td>32</td><td> Private</td><td>186824</td><td> HS-grad</td><td>9</td><td> Never-married</td><td> Machine-op-inspct</td><td> Unmarried</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,13,23,33,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,38,28887,7,50]]</td><td>38</td><td> Private</td><td>28887</td><td> 11th</td><td>7</td><td> Married-civ-spouse</td><td> Sales</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>50</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[1,11,25,31,46,48,53,94,95,96,99],[1,1,1,1,1,1,1,43,292175,14,45]]</td><td>43</td><td> Self-emp-not-inc</td><td>292175</td><td> Masters</td><td>14</td><td> Divorced</td><td> Exec-managerial</td><td> Unmarried</td><td> White</td><td> Female</td><td>0</td><td>0</td><td>45</td><td> United-States</td><td> &gt;50K</td></tr><tr><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,20,23,29,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,40,193524,16,60]]</td><td>40</td><td> Private</td><td>193524</td><td> Doctorate</td><td>16</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>60</td><td> United-States</td><td> &gt;50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,26,34,46,49,53,94,95,96,99],[1,1,1,1,1,1,1,54,302146,9,20]]</td><td>54</td><td> Private</td><td>302146</td><td> HS-grad</td><td>9</td><td> Separated</td><td> Other-service</td><td> Unmarried</td><td> Black</td><td> Female</td><td>0</td><td>0</td><td>20</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[6,18,23,39,43,49,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,35,76845,5,40]]</td><td>35</td><td> Federal-gov</td><td>76845</td><td> 9th</td><td>5</td><td> Married-civ-spouse</td><td> Farming-fishing</td><td> Husband</td><td> Black</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,13,23,37,43,48,52,53,94,95,96,98,99],[1,1,1,1,1,1,1,1,43,117037,7,2042,40]]</td><td>43</td><td> Private</td><td>117037</td><td> 11th</td><td>7</td><td> Married-civ-spouse</td><td> Transport-moving</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>2042</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,25,40,46,48,53,94,95,96,99],[1,1,1,1,1,1,1,59,109015,9,40]]</td><td>59</td><td> Private</td><td>109015</td><td> HS-grad</td><td>9</td><td> Divorced</td><td> Tech-support</td><td> Unmarried</td><td> White</td><td> Female</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[2,10,23,40,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,56,216851,13,40]]</td><td>56</td><td> Local-gov</td><td>216851</td><td> Bachelors</td><td>13</td><td> Married-civ-spouse</td><td> Tech-support</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &gt;50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,24,30,45,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,19,168294,9,40]]</td><td>19</td><td> Private</td><td>168294</td><td> HS-grad</td><td>9</td><td> Never-married</td><td> Craft-repair</td><td> Own-child</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[3,9,23,36,43,50,52,65,94,95,96,99],[1,1,1,1,1,1,1,1,54,180211,10,60]]</td><td>54</td><td> ?</td><td>180211</td><td> Some-college</td><td>10</td><td> Married-civ-spouse</td><td> ?</td><td> Husband</td><td> Asian-Pac-Islander</td><td> Male</td><td>0</td><td>0</td><td>60</td><td> South</td><td> &gt;50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,25,31,44,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,39,367260,9,80]]</td><td>39</td><td> Private</td><td>367260</td><td> HS-grad</td><td>9</td><td> Divorced</td><td> Exec-managerial</td><td> Not-in-family</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>80</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,49,193366,9,40]]</td><td>49</td><td> Private</td><td>193366</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[2,14,24,41,44,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,23,190709,12,52]]</td><td>23</td><td> Local-gov</td><td>190709</td><td> Assoc-acdm</td><td>12</td><td> Never-married</td><td> Protective-serv</td><td> Not-in-family</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>52</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,9,24,33,45,49,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,20,266015,10,44]]</td><td>20</td><td> Private</td><td>266015</td><td> Some-college</td><td>10</td><td> Never-married</td><td> Sales</td><td> Own-child</td><td> Black</td><td> Male</td><td>0</td><td>0</td><td>44</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,10,25,31,45,48,52,53,94,95,96,98,99],[1,1,1,1,1,1,1,1,45,386940,13,1408,40]]</td><td>45</td><td> Private</td><td>386940</td><td> Bachelors</td><td>13</td><td> Divorced</td><td> Exec-managerial</td><td> Own-child</td><td> White</td><td> Male</td><td>0</td><td>1408</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[6,9,23,32,45,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,30,59951,10,40]]</td><td>30</td><td> Federal-gov</td><td>59951</td><td> Some-college</td><td>10</td><td> Married-civ-spouse</td><td> Adm-clerical</td><td> Own-child</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[4,9,23,34,43,49,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,22,311512,10,15]]</td><td>22</td><td> State-gov</td><td>311512</td><td> Some-college</td><td>10</td><td> Married-civ-spouse</td><td> Other-service</td><td> Husband</td><td> Black</td><td> Male</td><td>0</td><td>0</td><td>15</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,13,24,35,46,48,52,59,94,95,96,99],[1,1,1,1,1,1,1,1,48,242406,7,40]]</td><td>48</td><td> Private</td><td>242406</td><td> 11th</td><td>7</td><td> Never-married</td><td> Machine-op-inspct</td><td> Unmarried</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> Puerto-Rico</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,9,24,35,45,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,21,197200,10,40]]</td><td>21</td><td> Private</td><td>197200</td><td> Some-college</td><td>10</td><td> Never-married</td><td> Machine-op-inspct</td><td> Own-child</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,32,47,48,53,94,95,96,99],[1,1,1,1,1,1,19,544091,9,25]]</td><td>19</td><td> Private</td><td>544091</td><td> HS-grad</td><td>9</td><td> Married-AF-spouse</td><td> Adm-clerical</td><td> Wife</td><td> White</td><td> Female</td><td>0</td><td>0</td><td>25</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,9,23,33,43,48,52,55,94,95,96,99],[1,1,1,1,1,1,1,1,31,84154,10,38]]</td><td>31</td><td> Private</td><td>84154</td><td> Some-college</td><td>10</td><td> Married-civ-spouse</td><td> Sales</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>38</td><td> ?</td><td> &gt;50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[1,14,23,29,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,48,265477,12,40]]</td><td>48</td><td> Self-emp-not-inc</td><td>265477</td><td> Assoc-acdm</td><td>12</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,18,23,35,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,31,507875,5,43]]</td><td>31</td><td> Private</td><td>507875</td><td> 9th</td><td>5</td><td> Married-civ-spouse</td><td> Machine-op-inspct</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>43</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[1,10,23,29,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,53,88506,13,40]]</td><td>53</td><td> Self-emp-not-inc</td><td>88506</td><td> Bachelors</td><td>13</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,10,23,40,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,24,172987,13,50]]</td><td>24</td><td> Private</td><td>172987</td><td> Bachelors</td><td>13</td><td> Married-civ-spouse</td><td> Tech-support</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>50</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,26,32,46,48,53,94,95,96,99],[1,1,1,1,1,1,1,49,94638,9,40]]</td><td>49</td><td> Private</td><td>94638</td><td> HS-grad</td><td>9</td><td> Separated</td><td> Adm-clerical</td><td> Unmarried</td><td> White</td><td> Female</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,24,38,44,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,25,289980,9,35]]</td><td>25</td><td> Private</td><td>289980</td><td> HS-grad</td><td>9</td><td> Never-married</td><td> Handlers-cleaners</td><td> Not-in-family</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>35</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[6,10,23,29,43,49,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,57,337895,13,40]]</td><td>57</td><td> Federal-gov</td><td>337895</td><td> Bachelors</td><td>13</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Husband</td><td> Black</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &gt;50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,35,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,53,144361,9,38]]</td><td>53</td><td> Private</td><td>144361</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Machine-op-inspct</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>38</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,11,25,31,46,48,53,94,95,96,99],[1,1,1,1,1,1,1,44,128354,14,40]]</td><td>44</td><td> Private</td><td>128354</td><td> Masters</td><td>14</td><td> Divorced</td><td> Exec-managerial</td><td> Unmarried</td><td> White</td><td> Female</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[4,12,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,41,101603,11,40]]</td><td>41</td><td> State-gov</td><td>101603</td><td> Assoc-voc</td><td>11</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,12,24,29,44,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,29,271466,11,43]]</td><td>29</td><td> Private</td><td>271466</td><td> Assoc-voc</td><td>11</td><td> Never-married</td><td> Prof-specialty</td><td> Not-in-family</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>43</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,9,23,31,47,53,94,95,96,99],[1,1,1,1,1,1,25,32275,10,40]]</td><td>25</td><td> Private</td><td>32275</td><td> Some-college</td><td>10</td><td> Married-civ-spouse</td><td> Exec-managerial</td><td> Wife</td><td> Other</td><td> Female</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,24,34,45,48,55,94,95,96,99],[1,1,1,1,1,1,1,18,226956,9,30]]</td><td>18</td><td> Private</td><td>226956</td><td> HS-grad</td><td>9</td><td> Never-married</td><td> Other-service</td><td> Own-child</td><td> White</td><td> Female</td><td>0</td><td>0</td><td>30</td><td> ?</td><td> &lt;=50K</td></tr><tr><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,17,23,29,47,48,91,94,95,96,98,99],[1,1,1,1,1,1,1,47,51835,15,1902,60]]</td><td>47</td><td> Private</td><td>51835</td><td> Prof-school</td><td>15</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Wife</td><td> White</td><td> Female</td><td>0</td><td>1902</td><td>60</td><td> Honduras</td><td> &gt;50K</td></tr><tr><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[6,10,25,31,44,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,50,251585,13,55]]</td><td>50</td><td> Federal-gov</td><td>251585</td><td> Bachelors</td><td>13</td><td> Divorced</td><td> Exec-managerial</td><td> Not-in-family</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>55</td><td> United-States</td><td> &gt;50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[5,8,25,31,44,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,47,109832,9,60]]</td><td>47</td><td> Self-emp-inc</td><td>109832</td><td> HS-grad</td><td>9</td><td> Divorced</td><td> Exec-managerial</td><td> Not-in-family</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>60</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,9,23,40,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,43,237993,10,40]]</td><td>43</td><td> Private</td><td>237993</td><td> Some-college</td><td>10</td><td> Married-civ-spouse</td><td> Tech-support</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &gt;50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,21,23,35,43,48,52,54,94,95,96,99],[1,1,1,1,1,1,1,1,46,216666,3,40]]</td><td>46</td><td> Private</td><td>216666</td><td> 5th-6th</td><td>3</td><td> Married-civ-spouse</td><td> Machine-op-inspct</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> Mexico</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,12,23,34,43,48,52,59,94,95,96,99],[1,1,1,1,1,1,1,1,35,56352,11,40]]</td><td>35</td><td> Private</td><td>56352</td><td> Assoc-voc</td><td>11</td><td> Married-civ-spouse</td><td> Other-service</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> Puerto-Rico</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,32,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,41,147372,9,48]]</td><td>41</td><td> Private</td><td>147372</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Adm-clerical</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>48</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,35,43,48,52,53,94,95,96,97,99],[1,1,1,1,1,1,1,1,30,188146,9,5013,40]]</td><td>30</td><td> Private</td><td>188146</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Machine-op-inspct</td><td> Husband</td><td> White</td><td> Male</td><td>5013</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,10,23,33,43,48,52,53,94,95,96,97,99],[1,1,1,1,1,1,1,1,30,59496,13,2407,40]]</td><td>30</td><td> Private</td><td>59496</td><td> Bachelors</td><td>13</td><td> Married-civ-spouse</td><td> Sales</td><td> Husband</td><td> White</td><td> Male</td><td>2407</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[3,16,28,36,44,48,52,55,94,95,96,99],[1,1,1,1,1,1,1,1,32,293936,4,40]]</td><td>32</td><td> ?</td><td>293936</td><td> 7th-8th</td><td>4</td><td> Married-spouse-absent</td><td> ?</td><td> Not-in-family</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> ?</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,37,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,48,149640,9,40]]</td><td>48</td><td> Private</td><td>149640</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Transport-moving</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,20,23,29,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,42,116632,16,45]]</td><td>42</td><td> Private</td><td>116632</td><td> Doctorate</td><td>16</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>45</td><td> United-States</td><td> &gt;50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,9,25,40,44,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,29,105598,10,58]]</td><td>29</td><td> Private</td><td>105598</td><td> Some-college</td><td>10</td><td> Divorced</td><td> Tech-support</td><td> Not-in-family</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>58</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,36,155537,9,40]]</td><td>36</td><td> Private</td><td>155537</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,9,25,32,44,48,53,94,95,96,99],[1,1,1,1,1,1,1,28,183175,10,40]]</td><td>28</td><td> Private</td><td>183175</td><td> Some-college</td><td>10</td><td> Divorced</td><td> Adm-clerical</td><td> Not-in-family</td><td> White</td><td> Female</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,32,47,48,53,94,95,96,99],[1,1,1,1,1,1,1,53,169846,9,40]]</td><td>53</td><td> Private</td><td>169846</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Adm-clerical</td><td> Wife</td><td> White</td><td> Female</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &gt;50K</td></tr><tr><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[5,9,23,31,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,49,191681,10,50]]</td><td>49</td><td> Self-emp-inc</td><td>191681</td><td> Some-college</td><td>10</td><td> Married-civ-spouse</td><td> Exec-managerial</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>50</td><td> United-States</td><td> &gt;50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[3,9,24,36,45,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,25,200681,10,40]]</td><td>25</td><td> ?</td><td>200681</td><td> Some-college</td><td>10</td><td> Never-married</td><td> ?</td><td> Own-child</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,9,24,29,45,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,19,101509,10,32]]</td><td>19</td><td> Private</td><td>101509</td><td> Some-college</td><td>10</td><td> Never-married</td><td> Prof-specialty</td><td> Own-child</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>32</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,10,26,33,45,49,53,94,95,96,99],[1,1,1,1,1,1,1,31,309974,13,40]]</td><td>31</td><td> Private</td><td>309974</td><td> Bachelors</td><td>13</td><td> Separated</td><td> Sales</td><td> Own-child</td><td> Black</td><td> Female</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[1,10,23,33,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,29,162298,13,70]]</td><td>29</td><td> Self-emp-not-inc</td><td>162298</td><td> Bachelors</td><td>13</td><td> Married-civ-spouse</td><td> Sales</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>70</td><td> United-States</td><td> &gt;50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,9,24,35,44,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,23,211678,10,40]]</td><td>23</td><td> Private</td><td>211678</td><td> Some-college</td><td>10</td><td> Never-married</td><td> Machine-op-inspct</td><td> Not-in-family</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,9,23,29,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,79,124744,10,20]]</td><td>79</td><td> Private</td><td>124744</td><td> Some-college</td><td>10</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Other-relative</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>20</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,24,34,45,48,52,54,94,95,96,99],[1,1,1,1,1,1,1,1,27,213921,9,40]]</td><td>27</td><td> Private</td><td>213921</td><td> HS-grad</td><td>9</td><td> Never-married</td><td> Other-service</td><td> Own-child</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> Mexico</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,14,23,32,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,40,32214,12,40]]</td><td>40</td><td> Private</td><td>32214</td><td> Assoc-acdm</td><td>12</td><td> Married-civ-spouse</td><td> Adm-clerical</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[3,15,23,36,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,67,212759,6,2]]</td><td>67</td><td> ?</td><td>212759</td><td> 10th</td><td>6</td><td> Married-civ-spouse</td><td> ?</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>2</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,13,24,34,45,48,53,94,95,96,99],[1,1,1,1,1,1,1,18,309634,7,22]]</td><td>18</td><td> Private</td><td>309634</td><td> 11th</td><td>7</td><td> Never-married</td><td> Other-service</td><td> Own-child</td><td> White</td><td> Female</td><td>0</td><td>0</td><td>22</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[2,16,23,39,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,31,125927,4,40]]</td><td>31</td><td> Local-gov</td><td>125927</td><td> 7th-8th</td><td>4</td><td> Married-civ-spouse</td><td> Farming-fishing</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,24,33,44,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,18,446839,9,30]]</td><td>18</td><td> Private</td><td>446839</td><td> HS-grad</td><td>9</td><td> Never-married</td><td> Sales</td><td> Not-in-family</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>30</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,10,23,34,43,48,52,62,94,95,96,99],[1,1,1,1,1,1,1,1,52,276515,13,40]]</td><td>52</td><td> Private</td><td>276515</td><td> Bachelors</td><td>13</td><td> Married-civ-spouse</td><td> Other-service</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> Cuba</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,34,47,48,53,94,95,96,99],[1,1,1,1,1,1,1,46,51618,9,40]]</td><td>46</td><td> Private</td><td>51618</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Other-service</td><td> Wife</td><td> White</td><td> Female</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,33,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,59,159937,9,48]]</td><td>59</td><td> Private</td><td>159937</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Sales</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>48</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,25,30,44,48,53,94,95,96,97,99],[1,1,1,1,1,1,1,44,343591,9,14344,40]]</td><td>44</td><td> Private</td><td>343591</td><td> HS-grad</td><td>9</td><td> Divorced</td><td> Craft-repair</td><td> Not-in-family</td><td> White</td><td> Female</td><td>14344</td><td>0</td><td>40</td><td> United-States</td><td> &gt;50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,25,33,45,48,53,94,95,96,99],[1,1,1,1,1,1,1,53,346253,9,35]]</td><td>53</td><td> Private</td><td>346253</td><td> HS-grad</td><td>9</td><td> Divorced</td><td> Sales</td><td> Own-child</td><td> White</td><td> Female</td><td>0</td><td>0</td><td>35</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[2,8,23,41,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,49,268234,9,40]]</td><td>49</td><td> Local-gov</td><td>268234</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Protective-serv</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &gt;50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,11,23,29,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,33,202051,14,50]]</td><td>33</td><td> Private</td><td>202051</td><td> Masters</td><td>14</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>50</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,18,24,33,44,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,30,54334,5,40]]</td><td>30</td><td> Private</td><td>54334</td><td> 9th</td><td>5</td><td> Never-married</td><td> Sales</td><td> Not-in-family</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[6,20,24,29,44,48,53,94,95,96,99],[1,1,1,1,1,1,1,43,410867,16,50]]</td><td>43</td><td> Federal-gov</td><td>410867</td><td> Doctorate</td><td>16</td><td> Never-married</td><td> Prof-specialty</td><td> Not-in-family</td><td> White</td><td> Female</td><td>0</td><td>0</td><td>50</td><td> United-States</td><td> &gt;50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,12,23,29,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,57,249977,11,40]]</td><td>57</td><td> Private</td><td>249977</td><td> Assoc-voc</td><td>11</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,9,25,30,46,48,53,94,95,96,99],[1,1,1,1,1,1,1,37,286730,10,40]]</td><td>37</td><td> Private</td><td>286730</td><td> Some-college</td><td>10</td><td> Divorced</td><td> Craft-repair</td><td> Unmarried</td><td> White</td><td> Female</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,9,25,35,46,49,53,94,95,96,99],[1,1,1,1,1,1,1,28,212563,10,25]]</td><td>28</td><td> Private</td><td>212563</td><td> Some-college</td><td>10</td><td> Divorced</td><td> Machine-op-inspct</td><td> Unmarried</td><td> Black</td><td> Female</td><td>0</td><td>0</td><td>25</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,33,47,50,55,94,95,96,98,99],[1,1,1,1,1,1,1,30,117747,9,1573,35]]</td><td>30</td><td> Private</td><td>117747</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Sales</td><td> Wife</td><td> Asian-Pac-Islander</td><td> Female</td><td>0</td><td>1573</td><td>35</td><td> ?</td><td> &lt;=50K</td></tr><tr><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[2,10,23,41,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,34,226296,13,40]]</td><td>34</td><td> Local-gov</td><td>226296</td><td> Bachelors</td><td>13</td><td> Married-civ-spouse</td><td> Protective-serv</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &gt;50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[2,9,24,38,44,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,29,115585,10,50]]</td><td>29</td><td> Local-gov</td><td>115585</td><td> Some-college</td><td>10</td><td> Never-married</td><td> Handlers-cleaners</td><td> Not-in-family</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>50</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[1,20,23,29,43,48,52,53,94,95,96,98,99],[1,1,1,1,1,1,1,1,48,191277,16,1902,60]]</td><td>48</td><td> Self-emp-not-inc</td><td>191277</td><td> Doctorate</td><td>16</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>1902</td><td>60</td><td> United-States</td><td> &gt;50K</td></tr><tr><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,9,23,33,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,37,202683,10,48]]</td><td>37</td><td> Private</td><td>202683</td><td> Some-college</td><td>10</td><td> Married-civ-spouse</td><td> Sales</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>48</td><td> United-States</td><td> &gt;50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,14,25,31,46,48,63,94,95,96,99],[1,1,1,1,1,1,1,48,171095,12,40]]</td><td>48</td><td> Private</td><td>171095</td><td> Assoc-acdm</td><td>12</td><td> Divorced</td><td> Exec-managerial</td><td> Unmarried</td><td> White</td><td> Female</td><td>0</td><td>0</td><td>40</td><td> England</td><td> &lt;=50K</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[6,8,24,34,45,49,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,32,249409,9,40]]</td><td>32</td><td> Federal-gov</td><td>249409</td><td> HS-grad</td><td>9</td><td> Never-married</td><td> Other-service</td><td> Own-child</td><td> Black</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td></tr><tr><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,11,23,31,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,76,124191,14,40]]</td><td>76</td><td> Private</td><td>124191</td><td> Masters</td><td>14</td><td> Married-civ-spouse</td><td> Exec-managerial</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &gt;50K</td></tr></tbody><fthfoot style="display:table-footer-group;border-spacing:0;height:0;border-collapse:collapse;"><fthtr style="display:table-row;border-spacing:0;height:0;border-collapse:collapse"><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd></fthtr></fthfoot></table></div><div style="overflow: hidden; position: absolute; margin-top: 0px; top: 0px; z-index: 1; left: 0px; width: 1385px;" aria-hidden="true" class="floatThead-floatContainer floatThead-container"><table class="table table-bordered table-condensed table-hover floatThead-table" style="margin: 0px; border-bottom-width: 0px; table-layout: fixed; width: 122.671%;"><colgroup><col style="width: 58.4px;"><col style="width: 246.4px;"><col style="width: 52px;"><col style="width: 92px;"><col style="width: 67.2px;"><col style="width: 90.4px;"><col style="width: 125.6px;"><col style="width: 117.6px;"><col style="width: 98.4px;"><col style="width: 103.2px;"><col style="width: 57.6px;"><col style="width: 54.4px;"><col style="width: 104px;"><col style="width: 104px;"><col style="width: 132px;"><col style="width: 121.6px;"><col style="width: 74.4px;"></colgroup><thead><tr><th data-column-name="label" style="padding-right: 23px;">label</th><th data-column-name="features" style="padding-right: 23px;">features</th><th data-column-name="age" style="padding-right: 23px;">age</th><th data-column-name="workclass" style="padding-right: 23px;">workclass</th><th data-column-name="fnlwgt" style="padding-right: 23px;">fnlwgt</th><th data-column-name="education" style="padding-right: 23px;">education</th><th data-column-name="education_num" style="padding-right: 23px;">education_num</th><th data-column-name="marital_status" style="padding-right: 23px;">marital_status</th><th data-column-name="occupation" style="padding-right: 23px;">occupation</th><th data-column-name="relationship" style="padding-right: 23px;">relationship</th><th data-column-name="race" style="padding-right: 23px;">race</th><th data-column-name="sex" style="padding-right: 23px;">sex</th><th data-column-name="capital_gain" style="padding-right: 23px;">capital_gain</th><th data-column-name="capital_loss" style="padding-right: 23px;">capital_loss</th><th data-column-name="hours_per_week" style="padding-right: 23px;">hours_per_week</th><th data-column-name="native_country" style="padding-right: 23px;">native_country</th><th data-column-name="income" style="padding-right: 23px;">income</th></tr></thead></table></div></div></div><p class="plotWarning">Showing the first 1000 rows.</p></div><div class="control-wrapper"><!-- plotControlsTemplate -->
<div class="plot-controls">
  
  <a class="btn btn-small display-type-button active" data-type="table" title="Raw table">
    <i class="fa fa-table"></i>
  </a>
  <div class="btn-group btn-small" style="padding-left: 4px; padding-right: 4px;">
    <a class="btn btn-small display-type-button" data-type="barChart" title="Bar chart">
      <i class="icon-db-bar"></i>
    </a><a class="btn btn-small dropdown-toggle" data-toggle="dropdown" style="padding-left: 6px; padding-right: 6px">
    <b class="caret"></b>
  </a>
    
    <div class="dropdown-menu" role="menu">
      <div class="row-fluid" style="width: 240px">
        
        <ul class="span6 multicol-menu" style="width: 80px">
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="barChart">
              <i class="icon-db-bar fa fa-fw"></i>
              Bar
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="scatterPlot">
              <i class="icon-db-scatter fa fa-fw"></i>
              Scatter
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="mapPlot">
              <i class="icon-db-map fa fa-fw"></i>
              Map
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="mgLine">
              <i class="icon-db-line fa fa-fw"></i>
              Line
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="areaChart">
              <i class="fa fa-area-chart fa fa-fw"></i>
              Area
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="pieChart">
              <i class="icon-db-pie fa fa-fw"></i>
              Pie
            </a>
          </li>
          
          
        </ul>

        
        <ul class="span6 multicol-menu" style="width: 140px">
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="quantilePlot">
              <i class="icon-db-quantile fa fa-fw"></i>
              Quantile
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="histogram">
              <i class="icon-db-histogram fa fa-fw"></i>
              Histogram
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="boxPlot">
              <i class="icon-db-boxplot fa fa-fw"></i>
              Box plot
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="qqPlot">
              <i class="icon-db-qq fa fa-fw"></i>
              Q-Q plot
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="pivotTable">
              <i class="icon-db-pivot fa fa-fw"></i>
              Pivot
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="lineChart">
              <i class="icon-db-line fa fa-fw"></i>
              Line (deprecated)
            </a>
          </li>
          
          
        </ul>

        
      </div>
      
    </div>
  </div>
  
</div><!-- downloadControlsTemplate -->
<div class="download-controls">
  
  <div class="btn-group btn-small" style="padding-left: 4px; padding-right: 4px;">
    <a class="btn btn-small results-download-preview" title="Download CSV">
      <i class="fa fa-download"></i>
    </a><a class="btn btn-small dropdown-toggle" data-toggle="dropdown" style="padding-left: 6px; padding-right: 6px">
    <b class="caret"></b>
  </a>
    <div class="dropdown-menu" role="menu">
      <div class="row-fluid" style="">
        <ul class="span12 multicol-menu">
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="results-download-preview">
              Download preview
            </a>
          </li>
          
            <li>
              <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="results-download">
                Download full results (max 1 million rows)
              </a>
            </li>
          
        </ul>
      </div>
    </div>
  </div>
  
</div></div><div style="height: 32px;"></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div><div class="command-result-stats"><span>Command took</span> <span>7.49 seconds</span> <span class="command-provenance">-- by jeffreyzhangma@gmail.com</span><span> at 12/24/2019, 12:26:16 PM</span><span title="1224-170603-cleat207"> on My Cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298353"><i class="fa fa-link"></i>Cmd 39</a><div class="new-notebook command mainCommand command-finished cellIndex-38 cell-825169771298314-825169771298353"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="edit-button edit-button-38 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-comment">### Randomly split data into training and test sets. set seed for reproducibility</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>(</span><span class="cm-variable">trainingData</span><span>,</span><span> </span><span class="cm-variable">testData</span><span>)</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">dataset</span><span>.</span><span class="cm-property">randomSplit</span><span>(</span><span>[</span><span class="cm-number">0.7</span><span>,</span><span> </span><span class="cm-number">0.3</span><span>]</span><span>,</span><span> </span><span class="cm-variable">seed</span><span class="cm-operator">=</span><span class="cm-number">100</span><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span class="cm-builtin">print</span><span>(</span><span class="cm-variable">trainingData</span><span>.</span><span class="cm-property">count</span><span>(</span><span>)</span><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span class="cm-builtin">print</span><span>(</span><span class="cm-variable">testData</span><span>.</span><span class="cm-property">count</span><span>(</span><span>)</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-fw fa-caret-right"></i>(2) Spark Jobs</p></div></div><div class="dataset-info-view"><div class=""><a class="tree-toggler"><i class="fa fa-caret-right fa-fw"></i><i class="fa fa-list-alt fa-fw"></i><span class="spacing-left">trainingData:</span><span class="spacing-left">pyspark.sql.dataframe.DataFrame = [label: double, features: udt ... 15 more fields]</span></a></div><div class="outer-most-struct"></div></div><div class="dataset-info-view"><div class=""><a class="tree-toggler"><i class="fa fa-caret-right fa-fw"></i><i class="fa fa-list-alt fa-fw"></i><span class="spacing-left">testData:</span><span class="spacing-left">pyspark.sql.dataframe.DataFrame = [label: double, features: udt ... 15 more fields]</span></a></div><div class="outer-most-struct"></div></div><div class="results"><div class="ansiout">22837
9723
</div></div><div class="command-result-stats"><span>Command took</span> <span>4.59 seconds</span> <span class="command-provenance">-- by jeffreyzhangma@gmail.com</span><span> at 12/24/2019, 12:26:27 PM</span><span title="1224-170603-cleat207"> on My Cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298354"><i class="fa fa-link"></i>Cmd 40</a><div class="new-notebook command mainCommand command-finished cellIndex-39 cell-825169771298314-825169771298354"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="edit-button edit-button-39 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-keyword">from</span><span> </span><span class="cm-variable">pyspark</span><span>.</span><span class="cm-property">sql</span><span>.</span><span class="cm-property">functions</span><span> </span><span class="cm-keyword">import</span><span> </span><span class="cm-variable">avg</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span class="cm-comment"># get the rate of the positive outcome from the training data to use as a threshold in the model</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span class="cm-variable">training_data_positive_rate</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">trainingData</span><span>.</span><span class="cm-property">select</span><span>(</span><span class="cm-variable">avg</span><span>(</span><span class="cm-variable">trainingData</span><span>[</span><span class="cm-string">'label'</span><span>]</span><span>)</span><span>)</span><span>.</span><span class="cm-property">collect</span><span>(</span><span>)</span><span>[</span><span class="cm-number">0</span><span>]</span><span>[</span><span class="cm-number">0</span><span>]</span><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">5</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">6</div></div><span class="cm-builtin">print</span><span>(</span><span class="cm-string">"Positive rate in the training data is {}"</span><span>.</span><span class="cm-property">format</span><span>(</span><span class="cm-variable">training_data_positive_rate</span><span>)</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-fw fa-caret-right"></i>(1) Spark Jobs</p></div></div><div class="results"><div class="ansiout">Positive rate in the training data is 0.23934842580023646
</div></div><div class="command-result-stats"><span>Command took</span> <span>1.73 seconds</span> <span class="command-provenance">-- by jeffreyzhangma@gmail.com</span><span> at 12/24/2019, 12:26:34 PM</span><span title="1224-170603-cleat207"> on My Cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"><i class="fa fa-minus-square-o"></i></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298355"><i class="fa fa-link"></i>Cmd 41</a><div class="new-notebook command mainCommand command-finished cellIndex-40 cell-825169771298314-825169771298355"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-40 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-40 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span>#</span><span>#</span><span>#</span><span>#</span><span>Logistic</span><span> </span><span>Regression</span><span> </span><span>-</span><span> </span><span>Train</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="79713046-db2a-48de-946a-175204350750" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h4>Logistic Regression - Train</h4>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298356"><i class="fa fa-link"></i>Cmd 42</a><div class="new-notebook command mainCommand command-finished cellIndex-41 cell-825169771298314-825169771298356"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="edit-button edit-button-41 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-keyword">from</span><span> </span><span class="cm-variable">pyspark</span><span>.</span><span class="cm-property">ml</span><span>.</span><span class="cm-property">classification</span><span> </span><span class="cm-keyword">import</span><span> </span><span class="cm-variable">LogisticRegression</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span class="cm-comment"># Create initial LogisticRegression model</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span class="cm-variable">lr</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">LogisticRegression</span><span>(</span><span class="cm-variable">labelCol</span><span class="cm-operator">=</span><span class="cm-string">"label"</span><span>,</span><span> </span><span class="cm-variable">featuresCol</span><span class="cm-operator">=</span><span class="cm-string">"features"</span><span>,</span><span> </span><span class="cm-variable">maxIter</span><span class="cm-operator">=</span><span class="cm-number">10</span><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">5</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">6</div></div><span class="cm-comment"># set threshold for the probability above which to predict a 1</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">7</div></div><span class="cm-variable">lr</span><span>.</span><span class="cm-property">setThreshold</span><span>(</span><span class="cm-variable">training_data_positive_rate</span><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">8</div></div><span class="cm-comment"># lr.setThreshold(0.5) # could use this if knew you had balanced data</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">9</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">10</div></div><span class="cm-comment"># Train model with Training Data</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">11</div></div><span class="cm-variable">lrModel</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">lr</span><span>.</span><span class="cm-property">fit</span><span>(</span><span class="cm-variable">trainingData</span><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">12</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">13</div></div><span class="cm-comment"># get training summary used for eval metrics and other params</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">14</div></div><span class="cm-variable">lrTrainingSummary</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">lrModel</span><span>.</span><span class="cm-property">summary</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">15</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">16</div></div><span class="cm-comment"># Find the best model threshold if you would like to use that instead of the empirical positve rate</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">17</div></div><span class="cm-variable">fMeasure</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">lrTrainingSummary</span><span>.</span><span class="cm-property">fMeasureByThreshold</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">18</div></div><span class="cm-variable">maxFMeasure</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">fMeasure</span><span>.</span><span class="cm-property">groupBy</span><span>(</span><span>)</span><span>.</span><span class="cm-property">max</span><span>(</span><span class="cm-string">'F-Measure'</span><span>)</span><span>.</span><span class="cm-property">select</span><span>(</span><span class="cm-string">'max(F-Measure)'</span><span>)</span><span>.</span><span class="cm-property">head</span><span>(</span><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">19</div></div><span class="cm-variable">lrBestThreshold</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">fMeasure</span><span>.</span><span class="cm-property">where</span><span>(</span><span class="cm-variable">fMeasure</span><span>[</span><span class="cm-string">'F-Measure'</span><span>]</span><span> </span><span class="cm-operator">==</span><span> </span><span class="cm-variable">maxFMeasure</span><span>[</span><span class="cm-string">'max(F-Measure)'</span><span>]</span><span>)</span><span> </span><span>\</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">20</div></div><span>    </span><span>.</span><span class="cm-property">select</span><span>(</span><span class="cm-string">'threshold'</span><span>)</span><span>.</span><span class="cm-property">head</span><span>(</span><span>)</span><span>[</span><span class="cm-string">'threshold'</span><span>]</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">21</div></div><span>  </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">22</div></div><span class="cm-builtin">print</span><span>(</span><span class="cm-string">"Best threshold based on model performance on training data is {}"</span><span>.</span><span class="cm-property">format</span><span>(</span><span class="cm-variable">lrBestThreshold</span><span>)</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-fw fa-caret-right"></i>(17) Spark Jobs</p></div></div><div class="dataset-info-view"><div class=""><a class="tree-toggler"><i class="fa fa-caret-right fa-fw"></i><i class="fa fa-list-alt fa-fw"></i><span class="spacing-left">fMeasure:</span><span class="spacing-left">pyspark.sql.dataframe.DataFrame = [threshold: double, F-Measure: double]</span></a></div><div class="outer-most-struct"></div></div><div class="results"><div class="ansiout">Best threshold based on model performance on training data is 0.3334162417235758
</div></div><div class="command-result-stats"><span>Command took</span> <span>9.52 seconds</span> <span class="command-provenance">-- by jeffreyzhangma@gmail.com</span><span> at 12/24/2019, 12:26:39 PM</span><span title="1224-170603-cleat207"> on My Cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298357"><i class="fa fa-link"></i>Cmd 43</a><div class="new-notebook command mainCommand command-finished cellIndex-42 cell-825169771298314-825169771298357"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-42 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-42 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>#</span><span>#</span><span>#</span><span>#</span><span>GBM</span><span> </span><span>-</span><span> </span><span>Train</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="ff73ea55-b68f-407b-8222-8da6ff4dd0f5" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h4>GBM - Train</h4>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"><i class="fa fa-minus-square-o"></i></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298358"><i class="fa fa-link"></i>Cmd 44</a><div class="new-notebook command mainCommand command-finished cellIndex-43 cell-825169771298314-825169771298358"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-43 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-43 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>#</span><span>#</span><span>#</span><span>#</span><span class="cm-tag bracket">&lt;</span><span class="cm-tag">span</span><span> </span><span class="cm-attribute">style</span><span>=</span><span class="cm-string">"color:darkblue"</span><span class="cm-tag bracket">&gt;</span><span>Question 3</span><span class="cm-tag bracket">&lt;/</span><span class="cm-tag">span</span><span class="cm-tag bracket">&gt;</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span class="cm-variable-2">1. </span><span class="cm-variable-2">Train</span><span class="cm-variable-2"></span><span class="cm-variable-2"> </span><span class="cm-variable-2">a</span><span class="cm-variable-2"> </span><span class="cm-variable-2">GBTClassifier</span><span class="cm-variable-2"> </span><span class="cm-variable-2">on</span><span class="cm-variable-2"> </span><span class="cm-variable-2">the</span><span class="cm-variable-2"> </span><span class="cm-variable-2">training</span><span class="cm-variable-2"> </span><span class="cm-variable-2">data,</span><span class="cm-variable-2"> </span><span class="cm-variable-2">call</span><span class="cm-variable-2"> </span><span class="cm-variable-2">the</span><span class="cm-variable-2"> </span><span class="cm-variable-2">trained</span><span class="cm-variable-2"> </span><span class="cm-variable-2">model</span><span class="cm-variable-2"> </span><span class="cm-variable-2">'</span><span class="cm-variable-2">gbModel</span><span class="cm-variable-2">'</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="8737929f-97e3-4a56-9165-724e58f30567" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h4><span style="color:darkblue;">Question 3</span></h4>
<ol>
<li>Train a GBTClassifier on the training data, call the trained model 'gbModel'</li>
</ol>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298359"><i class="fa fa-link"></i>Cmd 45</a><div class="new-notebook command mainCommand command-finished cellIndex-44 cell-825169771298314-825169771298359"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="edit-button edit-button-44 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 30.4px; left: 437.8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="1"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 146px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 407.8px; top: 18.4px; height: 18.4px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">### Question 3.1 Answer ###</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">pyspark</span>.<span class="cm-property">ml</span>.<span class="cm-property">classification</span> <span class="cm-keyword">import</span> <span class="cm-variable">GBTClassifier</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Create initial LogisticRegression model</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">gb</span> <span class="cm-operator">=</span> <span class="cm-variable">GBTClassifier</span>(<span class="cm-variable">labelCol</span><span class="cm-operator">=</span><span class="cm-string">"label"</span>, <span class="cm-variable">featuresCol</span><span class="cm-operator">=</span><span class="cm-string">"features"</span>, <span class="cm-variable">maxIter</span><span class="cm-operator">=</span><span class="cm-number">10</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Train model with Training Data</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">gbModel</span> <span class="cm-operator">=</span> <span class="cm-variable">gb</span>.<span class="cm-property">fit</span>(<span class="cm-variable">trainingData</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 146px;"></div><div class="CodeMirror-gutters" style="height: 159px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-fw fa-caret-right"></i>(57) Spark Jobs</p></div></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>16.17 seconds</span> <span class="command-provenance">-- by jeffreyzhangma@gmail.com</span><span> at 12/24/2019, 12:27:43 PM</span><span title="1224-170603-cleat207"> on My Cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"><i class="fa fa-minus-square-o"></i></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298360"><i class="fa fa-link"></i>Cmd 46</a><div class="new-notebook command mainCommand command-finished cellIndex-45 cell-825169771298314-825169771298360"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-45 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-45 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span>#</span><span>#</span><span>#</span><span>#</span><span>Logistic</span><span> </span><span>Regression</span><span> </span><span>-</span><span> </span><span>Predict</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="5ab42770-7c56-495f-83e7-7e497f765cb8" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h4>Logistic Regression - Predict</h4>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298361"><i class="fa fa-link"></i>Cmd 47</a><div class="new-notebook command mainCommand command-finished cellIndex-46 cell-825169771298314-825169771298361"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="dashboard-button dashboard-button-46 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-46 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-comment"># make predictions on test data</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-variable">lrPredictions</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">lrModel</span><span>.</span><span class="cm-property">transform</span><span>(</span><span class="cm-variable">testData</span><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span class="cm-comment"># display predictions</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">5</div></div><span class="cm-variable">display</span><span>(</span><span class="cm-variable">lrPredictions</span><span>.</span><span class="cm-property">select</span><span>(</span><span class="cm-string">"label"</span><span>,</span><span> </span><span class="cm-string">"prediction"</span><span>,</span><span> </span><span class="cm-string">"probability"</span><span>)</span><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">6</div></div><span class="cm-comment">#display(lrPredictions)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-fw fa-caret-right"></i>(1) Spark Jobs</p></div></div><div class="dataset-info-view"><div class=""><a class="tree-toggler"><i class="fa fa-caret-right fa-fw"></i><i class="fa fa-list-alt fa-fw"></i><span class="spacing-left">lrPredictions:</span><span class="spacing-left">pyspark.sql.dataframe.DataFrame = [label: double, features: udt ... 18 more fields]</span></a></div><div class="outer-most-struct"></div></div><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget ui-resizable" data-guid="e8cdb4ee-5bb9-4751-8a35-541fcb1cc326" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se" style="z-index: 90; display: block;"></div><div class="widget-content dashboard"><div class="results"><div class="results-table noscroll" tabindex="-1"><div class="floatThead-wrapper" style="position: relative; clear:both;"><div class="inner"><table class="table table-bordered table-condensed table-hover" style="table-layout: fixed; min-width: 1384px;"><colgroup><col style="width: 165.6px;"><col style="width: 261.6px;"><col style="width: 956.8px;"></colgroup><thead><tr class="size-row" style="height: 18px;"><th class="floatThead-col" style="height: 17px;"></th><th class="floatThead-col" style="height: 17px;"></th><th class="floatThead-col" style="height: 17px;"></th></tr></thead><tbody><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6912640989186466,0.3087359010813534]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6213734865155065,0.3786265134844935]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6586287948600485,0.3413712051399515]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6589958510289854,0.3410041489710147]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6157704934546715,0.38422950654532856]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5446870779706698,0.4553129220293301]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6048473508705535,0.3951526491294466]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5944480951080502,0.40555190489194975]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5875090690375251,0.4124909309624749]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5980792791827193,0.4019207208172807]]</td></tr><tr><td>0</td><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8364741598392398,0.16352584016076016]]</td></tr><tr><td>0</td><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.9886945750873162,0.011305424912683774]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.42124172564821133,0.5787582743517886]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.724416039334738,0.2755839606652621]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6849475243371242,0.31505247566287564]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7565554817598308,0.24344451824016922]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6563594164099508,0.34364058359004923]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5596094813831813,0.4403905186168186]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5506661353170117,0.4493338646829883]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5140197711567662,0.48598022884323383]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.369073037408603,0.6309269625913969]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.46005484193658175,0.5399451580634183]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6160429978859795,0.38395700211402045]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.433800152341747,0.5661998476582529]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5278747867426915,0.4721252132573085]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.4424270772186916,0.5575729227813083]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.3615790772806434,0.6384209227193566]]</td></tr><tr><td>0</td><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8328217016452251,0.16717829835477485]]</td></tr><tr><td>0</td><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8717547579107643,0.12824524208923566]]</td></tr><tr><td>0</td><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8330654391565867,0.1669345608434133]]</td></tr><tr><td>0</td><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8168523866144445,0.18314761338555552]]</td></tr><tr><td>0</td><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8538538172774788,0.14614618272252122]]</td></tr><tr><td>0</td><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8224368875424575,0.17756311245754253]]</td></tr><tr><td>0</td><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8263981154949315,0.17360188450506858]]</td></tr><tr><td>0</td><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7828076744297944,0.2171923255702055]]</td></tr><tr><td>0</td><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8139974143516026,0.18600258564839744]]</td></tr><tr><td>0</td><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7780697493497181,0.22193025065028188]]</td></tr><tr><td>0</td><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7826394225254889,0.21736057747451115]]</td></tr><tr><td>0</td><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8143584752809134,0.18564152471908651]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6366607259053872,0.36333927409461275]]</td></tr><tr><td>0</td><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7725144998436193,0.2274855001563808]]</td></tr><tr><td>0</td><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7655570592351667,0.2344429407648333]]</td></tr><tr><td>0</td><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8376041457610807,0.1623958542389194]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7591499209052924,0.24085007909470757]]</td></tr><tr><td>0</td><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7984034101977013,0.20159658980229872]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7279719469588318,0.2720280530411682]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7432463301239798,0.2567536698760203]]</td></tr><tr><td>0</td><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7976418990740058,0.20235810092599418]]</td></tr><tr><td>0</td><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7977735087558245,0.20222649124417547]]</td></tr><tr><td>0</td><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7902793587079487,0.2097206412920512]]</td></tr><tr><td>0</td><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7824194746032714,0.21758052539672856]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7423347262954082,0.25766527370459186]]</td></tr><tr><td>0</td><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.809868080451214,0.1901319195487861]]</td></tr><tr><td>0</td><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7977724469473509,0.202227553052649]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7553765902866126,0.2446234097133873]]</td></tr><tr><td>0</td><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7845413207036485,0.21545867929635157]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7434138452643008,0.2565861547356993]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6259881629407954,0.3740118370592046]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7412206561172878,0.2587793438827122]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7410491129938847,0.25895088700611535]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7120434448815589,0.28795655511844104]]</td></tr><tr><td>0</td><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7749133429952774,0.22508665700472255]]</td></tr><tr><td>0</td><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.889751137667113,0.11024886233288698]]</td></tr><tr><td>0</td><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7890095135482807,0.2109904864517192]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7402747380708047,0.2597252619291953]]</td></tr><tr><td>0</td><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7712636367665668,0.22873636323343327]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6295645204831741,0.37043547951682587]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5537036100666836,0.4462963899333165]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7381623113408303,0.2618376886591696]]</td></tr><tr><td>0</td><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7876753761762587,0.21232462382374126]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7300686121454417,0.2699313878545583]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7127555089099045,0.2872444910900955]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7047358922027301,0.2952641077972698]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6999860311709838,0.3000139688290162]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7346424913032614,0.2653575086967386]]</td></tr><tr><td>0</td><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7796888262123004,0.2203111737876996]]</td></tr><tr><td>0</td><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7778264917604539,0.222173508239546]]</td></tr><tr><td>0</td><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7765382966898847,0.2234617033101153]]</td></tr><tr><td>0</td><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8297594606225851,0.17024053937741496]]</td></tr><tr><td>0</td><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7735899469657576,0.22641005303424244]]</td></tr><tr><td>0</td><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7716247889042955,0.22837521109570452]]</td></tr><tr><td>0</td><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7651644692398536,0.2348355307601464]]</td></tr><tr><td>0</td><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.763268854326586,0.2367311456734141]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7547062886053568,0.24529371139464312]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7501662214400461,0.24983377855995398]]</td></tr><tr><td>0</td><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7818828513045011,0.21811714869549892]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7005916361665632,0.2994083638334369]]</td></tr><tr><td>0</td><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7618162187210828,0.2381837812789171]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5193331756739007,0.4806668243260992]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6807041925610177,0.3192958074389824]]</td></tr><tr><td>0</td><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7879538656035007,0.21204613439649933]]</td></tr><tr><td>0</td><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7937395338996607,0.20626046610033932]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7547166021872684,0.24528339781273154]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6364595540062414,0.36354044599375857]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5439997778231632,0.4560002221768368]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6941640291674853,0.3058359708325147]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7535685567713949,0.2464314432286051]]</td></tr><tr><td>0</td><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7758199753283939,0.22418002467160614]]</td></tr><tr><td>0</td><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7682686605677861,0.23173133943221405]]</td></tr><tr><td>0</td><td>1</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.744857278654162,0.25514272134583804]]</td></tr></tbody><fthfoot style="display:table-footer-group;border-spacing:0;height:0;border-collapse:collapse;"><fthtr style="display:table-row;border-spacing:0;height:0;border-collapse:collapse"><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd></fthtr></fthfoot></table></div><div style="overflow: hidden; position: absolute; margin-top: 0px; top: 0px; z-index: 1; left: 0px; width: 1385px;" aria-hidden="true" class="floatThead-floatContainer floatThead-container"><table class="table table-bordered table-condensed table-hover floatThead-table" style="margin: 0px; border-bottom-width: 0px; table-layout: fixed; width: 99.9278%;"><colgroup><col style="width: 165.6px;"><col style="width: 261.6px;"><col style="width: 956.8px;"></colgroup><thead><tr><th data-column-name="label" style="padding-right: 23px;">label</th><th data-column-name="prediction" style="padding-right: 23px;">prediction</th><th data-column-name="probability" style="padding-right: 23px;">probability</th></tr></thead></table></div></div></div><p class="plotWarning">Showing the first 1000 rows.</p></div><div class="control-wrapper"><!-- plotControlsTemplate -->
<div class="plot-controls">
  
  <a class="btn btn-small display-type-button active" data-type="table" title="Raw table">
    <i class="fa fa-table"></i>
  </a>
  <div class="btn-group btn-small" style="padding-left: 4px; padding-right: 4px;">
    <a class="btn btn-small display-type-button" data-type="barChart" title="Bar chart">
      <i class="icon-db-bar"></i>
    </a><a class="btn btn-small dropdown-toggle" data-toggle="dropdown" style="padding-left: 6px; padding-right: 6px">
    <b class="caret"></b>
  </a>
    
    <div class="dropdown-menu" role="menu">
      <div class="row-fluid" style="width: 240px">
        
        <ul class="span6 multicol-menu" style="width: 80px">
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="barChart">
              <i class="icon-db-bar fa fa-fw"></i>
              Bar
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="scatterPlot">
              <i class="icon-db-scatter fa fa-fw"></i>
              Scatter
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="mapPlot">
              <i class="icon-db-map fa fa-fw"></i>
              Map
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="mgLine">
              <i class="icon-db-line fa fa-fw"></i>
              Line
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="areaChart">
              <i class="fa fa-area-chart fa fa-fw"></i>
              Area
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="pieChart">
              <i class="icon-db-pie fa fa-fw"></i>
              Pie
            </a>
          </li>
          
          
        </ul>

        
        <ul class="span6 multicol-menu" style="width: 140px">
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="quantilePlot">
              <i class="icon-db-quantile fa fa-fw"></i>
              Quantile
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="histogram">
              <i class="icon-db-histogram fa fa-fw"></i>
              Histogram
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="boxPlot">
              <i class="icon-db-boxplot fa fa-fw"></i>
              Box plot
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="qqPlot">
              <i class="icon-db-qq fa fa-fw"></i>
              Q-Q plot
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="pivotTable">
              <i class="icon-db-pivot fa fa-fw"></i>
              Pivot
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="lineChart">
              <i class="icon-db-line fa fa-fw"></i>
              Line (deprecated)
            </a>
          </li>
          
          
        </ul>

        
      </div>
      
    </div>
  </div>
  
</div><!-- downloadControlsTemplate -->
<div class="download-controls">
  
  <div class="btn-group btn-small" style="padding-left: 4px; padding-right: 4px;">
    <a class="btn btn-small results-download-preview" title="Download CSV">
      <i class="fa fa-download"></i>
    </a><a class="btn btn-small dropdown-toggle" data-toggle="dropdown" style="padding-left: 6px; padding-right: 6px">
    <b class="caret"></b>
  </a>
    <div class="dropdown-menu" role="menu">
      <div class="row-fluid" style="">
        <ul class="span12 multicol-menu">
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="results-download-preview">
              Download preview
            </a>
          </li>
          
            <li>
              <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="results-download">
                Download full results (max 1 million rows)
              </a>
            </li>
          
        </ul>
      </div>
    </div>
  </div>
  
</div></div><div style="height: 32px;"></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div><div class="command-result-stats"><span>Command took</span> <span>2.01 seconds</span> <span class="command-provenance">-- by jeffreyzhangma@gmail.com</span><span> at 12/24/2019, 12:28:04 PM</span><span title="1224-170603-cleat207"> on My Cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"><i class="fa fa-minus-square-o"></i></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298362"><i class="fa fa-link"></i>Cmd 48</a><div class="new-notebook command mainCommand command-finished cellIndex-47 cell-825169771298314-825169771298362"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-47 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-47 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span>#</span><span>#</span><span>#</span><span>GBM</span><span> </span><span>-</span><span> </span><span>Predict</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="8a8ee02e-aee2-423f-8459-657906438f93" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h3>GBM - Predict</h3>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"><i class="fa fa-minus-square-o"></i></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298363"><i class="fa fa-link"></i>Cmd 49</a><div class="new-notebook command mainCommand command-finished cellIndex-48 cell-825169771298314-825169771298363"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-48 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-48 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>#</span><span>#</span><span>#</span><span>#</span><span class="cm-tag bracket">&lt;</span><span class="cm-tag">span</span><span> </span><span class="cm-attribute">style</span><span>=</span><span class="cm-string">"color:darkblue"</span><span class="cm-tag bracket">&gt;</span><span>Question 4</span><span class="cm-tag bracket">&lt;/</span><span class="cm-tag">span</span><span class="cm-tag bracket">&gt;</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span class="cm-variable-2">1. </span><span class="cm-variable-2">Get</span><span class="cm-variable-2"></span><span class="cm-variable-2"> </span><span class="cm-variable-2">predictions</span><span class="cm-variable-2"> </span><span class="cm-variable-2">on</span><span class="cm-variable-2"> </span><span class="cm-variable-2">the</span><span class="cm-variable-2"> </span><span class="cm-variable-2">test</span><span class="cm-variable-2"> </span><span class="cm-variable-2">data</span><span class="cm-variable-2"> </span><span class="cm-variable-2">for</span><span class="cm-variable-2"> </span><span class="cm-variable-2">your</span><span class="cm-variable-2"> </span><span class="cm-variable-2">GBTClassifier.</span><span class="cm-variable-2"> </span><span class="cm-variable-2">Call</span><span class="cm-variable-2"> </span><span class="cm-variable-2">the</span><span class="cm-variable-2"> </span><span class="cm-variable-2">predictions</span><span class="cm-variable-2"> </span><span class="cm-variable-2">df</span><span class="cm-variable-2"> </span><span class="cm-variable-2">'</span><span class="cm-variable-2">gbPredictions</span><span class="cm-variable-2">'</span><span class="cm-variable-2">.</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="bc2e5de7-b368-4e10-94fd-f25d30710754" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h4><span style="color:darkblue;">Question 4</span></h4>
<ol>
<li>Get predictions on the test data for your GBTClassifier. Call the predictions df 'gbPredictions'.</li>
</ol>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298364"><i class="fa fa-link"></i>Cmd 50</a><div class="new-notebook command mainCommand command-finished cellIndex-49 cell-825169771298314-825169771298364"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="dashboard-button dashboard-button-49 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-49 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 104px; left: 656.2px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="1"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 127px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 626.2px; top: 92px; height: 18.4px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">### Question 4.1 Answer ###</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># make predictions on test data</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">gbPredictions</span> <span class="cm-operator">=</span> <span class="cm-variable">gbModel</span>.<span class="cm-property">transform</span>(<span class="cm-variable">testData</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">display</span>(<span class="cm-variable">gbPredictions</span>.<span class="cm-property">select</span>(<span class="cm-string">'label'</span>,<span class="cm-string">'rawPrediction'</span>, <span class="cm-string">'probability'</span>,<span class="cm-string">'prediction'</span>))</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 127px;"></div><div class="CodeMirror-gutters" style="height: 140px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-fw fa-caret-right"></i>(1) Spark Jobs</p></div></div><div class="dataset-info-view"><div class=""><a class="tree-toggler"><i class="fa fa-caret-right fa-fw"></i><i class="fa fa-list-alt fa-fw"></i><span class="spacing-left">gbPredictions:</span><span class="spacing-left">pyspark.sql.dataframe.DataFrame = [label: double, features: udt ... 18 more fields]</span></a></div><div class="outer-most-struct"></div></div><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget ui-resizable" data-guid="d95e83ad-bc81-4769-b5d5-bddcf43409e1" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se" style="z-index: 90; display: block;"></div><div class="widget-content dashboard"><div class="results"><div class="results-table noscroll" tabindex="-1"><div class="floatThead-wrapper" style="position: relative; clear:both;"><div class="inner"><table class="table table-bordered table-condensed table-hover" style="table-layout: fixed; min-width: 1384px;"><colgroup><col style="width: 96px;"><col style="width: 589.6px;"><col style="width: 545.6px;"><col style="width: 152.8px;"></colgroup><thead><tr class="size-row" style="height: 18px;"><th class="floatThead-col" style="height: 17px;"></th><th class="floatThead-col" style="height: 17px;"></th><th class="floatThead-col" style="height: 17px;"></th><th class="floatThead-col" style="height: 17px;"></th></tr></thead><tbody><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6309564893246978,-0.6309564893246978]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7793552406193347,0.2206447593806653]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5216292798075103,-0.5216292798075103]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.739478257831539,0.260521742168461]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5216292798075103,-0.5216292798075103]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.739478257831539,0.260521742168461]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.4699827159692863,-0.4699827159692863]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7190926747761738,0.2809073252238262]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.0794665637220568,-0.0794665637220568]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5396498548949162,0.46035014510508376]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.0794665637220568,-0.0794665637220568]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5396498548949162,0.46035014510508376]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.20868256822794762,-0.20868256822794762]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6028525785639927,0.39714742143600734]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.20868256822794762,-0.20868256822794762]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6028525785639927,0.39714742143600734]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.2826475885607692,-0.2826475885607692]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6376768546158478,0.3623231453841522]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.2826475885607692,-0.2826475885607692]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6376768546158478,0.3623231453841522]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6592281176773253,-0.6592281176773253]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7889247496529908,0.21107525034700925]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7307194767765482,-0.7307194767765482]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8117526603268064,0.18824733967319363]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.3076758393533793,-0.3076758393533793]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6491606236607391,0.3508393763392609]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.2826475885607692,-0.2826475885607692]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6376768546158478,0.3623231453841522]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6401007240595885,-0.6401007240595885]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7824840653986704,0.21751593460132956]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5067985894656858,-0.5067985894656858]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.73372353260229,0.26627646739771005]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5982671368922082,-0.5982671368922082]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7679076763896714,0.2320923236103286]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.3063433430784135,-0.3063433430784135]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6485534276454455,0.35144657235455445]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[-0.08417280916881613,0.08417280916881613]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.4580127094592698,0.5419872905407301]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.021038838336255486,-0.021038838336255486]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5105178673631777,0.4894821326368223]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[-0.08417280916881613,0.08417280916881613]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.4580127094592698,0.5419872905407301]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.37823194757562467,-0.37823194757562467]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6805855153071164,0.3194144846928836]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.722314449155094,-0.722314449155094]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8091704395721114,0.19082956042788857]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[-0.2592956390211397,0.2592956390211397]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.37318169895392633,0.6268183010460737]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.43679389416681286,-0.43679389416681286]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.705491693324658,0.294508306675342]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[-0.19495619926422061,0.19495619926422061]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.4037383891519402,0.5962616108480598]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[-0.19495619926422061,0.19495619926422061]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.4037383891519402,0.5962616108480598]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8061143388180017,-0.8061143388180017]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8337205791226832,0.16627942087731684]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.9011845972089955,-0.9011845972089955]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8584370909309686,0.14156290906903135]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8061143388180017,-0.8061143388180017]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8337205791226832,0.16627942087731684]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8061143388180017,-0.8061143388180017]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8337205791226832,0.16627942087731684]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8562380035072531,-0.8562380035072531]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8471571579939765,0.1528428420060235]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8061143388180017,-0.8061143388180017]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8337205791226832,0.16627942087731684]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8061143388180017,-0.8061143388180017]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8337205791226832,0.16627942087731684]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7754399124145862,-0.7754399124145862]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8250407695505846,0.17495923044941541]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8061143388180017,-0.8061143388180017]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8337205791226832,0.16627942087731684]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7754399124145862,-0.7754399124145862]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8250407695505846,0.17495923044941541]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7754399124145862,-0.7754399124145862]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8250407695505846,0.17495923044941541]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8562380035072531,-0.8562380035072531]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8471571579939765,0.1528428420060235]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7754399124145862,-0.7754399124145862]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8250407695505846,0.17495923044941541]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8061143388180017,-0.8061143388180017]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8337205791226832,0.16627942087731684]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8061143388180017,-0.8061143388180017]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8337205791226832,0.16627942087731684]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8348703090972815,-0.8348703090972815]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8415412357632204,0.15845876423677963]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7540722180046147,-0.7540722180046147]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8187860495393312,0.1812139504606688]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7847466444080301,-0.7847466444080301]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8277113605825269,0.17228863941747308]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7540722180046147,-0.7540722180046147]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8187860495393312,0.1812139504606688]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7540722180046147,-0.7540722180046147]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8187860495393312,0.1812139504606688]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7847466444080301,-0.7847466444080301]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8277113605825269,0.17228863941747308]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7540722180046147,-0.7540722180046147]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8187860495393312,0.1812139504606688]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7847466444080301,-0.7847466444080301]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8277113605825269,0.17228863941747308]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7847466444080301,-0.7847466444080301]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8277113605825269,0.17228863941747308]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7540722180046147,-0.7540722180046147]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8187860495393312,0.1812139504606688]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.722314449155094,-0.722314449155094]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8091704395721114,0.19082956042788857]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.722314449155094,-0.722314449155094]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8091704395721114,0.19082956042788857]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6916400227516786,-0.6916400227516786]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7995172733397099,0.2004827266602901]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.722314449155094,-0.722314449155094]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8091704395721114,0.19082956042788857]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6916400227516786,-0.6916400227516786]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7995172733397099,0.2004827266602901]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6916400227516786,-0.6916400227516786]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7995172733397099,0.2004827266602901]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6447450084874271,-0.6447450084874271]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7840608567508838,0.21593914324911623]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6447450084874271,-0.6447450084874271]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7840608567508838,0.21593914324911623]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6447450084874271,-0.6447450084874271]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7840608567508838,0.21593914324911623]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.722314449155094,-0.722314449155094]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8091704395721114,0.19082956042788857]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8412260631896581,-0.8412260631896581]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8432289601073024,0.15677103989269758]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.722314449155094,-0.722314449155094]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8091704395721114,0.19082956042788857]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6447450084874271,-0.6447450084874271]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7840608567508838,0.21593914324911623]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.722314449155094,-0.722314449155094]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8091704395721114,0.19082956042788857]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6447450084874271,-0.6447450084874271]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7840608567508838,0.21593914324911623]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6447450084874271,-0.6447450084874271]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7840608567508838,0.21593914324911623]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.722314449155094,-0.722314449155094]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8091704395721114,0.19082956042788857]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.722314449155094,-0.722314449155094]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8091704395721114,0.19082956042788857]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5930984446492031,-0.5930984446492031]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.766060191016042,0.23393980898395805]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5930984446492031,-0.5930984446492031]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.766060191016042,0.23393980898395805]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5930984446492031,-0.5930984446492031]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.766060191016042,0.23393980898395805]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5930984446492031,-0.5930984446492031]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.766060191016042,0.23393980898395805]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.722314449155094,-0.722314449155094]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8091704395721114,0.19082956042788857]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.722314449155094,-0.722314449155094]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8091704395721114,0.19082956042788857]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.722314449155094,-0.722314449155094]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8091704395721114,0.19082956042788857]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.722314449155094,-0.722314449155094]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8091704395721114,0.19082956042788857]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8412260631896581,-0.8412260631896581]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8432289601073024,0.15677103989269758]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.722314449155094,-0.722314449155094]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8091704395721114,0.19082956042788857]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.722314449155094,-0.722314449155094]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8091704395721114,0.19082956042788857]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.722314449155094,-0.722314449155094]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8091704395721114,0.19082956042788857]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.722314449155094,-0.722314449155094]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8091704395721114,0.19082956042788857]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.722314449155094,-0.722314449155094]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8091704395721114,0.19082956042788857]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.722314449155094,-0.722314449155094]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8091704395721114,0.19082956042788857]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.722314449155094,-0.722314449155094]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8091704395721114,0.19082956042788857]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5930984446492031,-0.5930984446492031]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.766060191016042,0.23393980898395805]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.722314449155094,-0.722314449155094]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8091704395721114,0.19082956042788857]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5930984446492031,-0.5930984446492031]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.766060191016042,0.23393980898395805]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5930984446492031,-0.5930984446492031]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.766060191016042,0.23393980898395805]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.722314449155094,-0.722314449155094]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8091704395721114,0.19082956042788857]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7962794694879157,-0.7962794694879157]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8309758233187089,0.1690241766812911]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.722314449155094,-0.722314449155094]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8091704395721114,0.19082956042788857]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5930984446492031,-0.5930984446492031]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.766060191016042,0.23393980898395805]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.20258229240197367,-0.20258229240197367]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5999278722399235,0.4000721277600765]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.20258229240197367,-0.20258229240197367]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5999278722399235,0.4000721277600765]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.3317982969078645,-0.3317982969078645]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6600678499822719,0.33993215001772814]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.3317982969078645,-0.3317982969078645]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6600678499822719,0.33993215001772814]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.3317982969078645,-0.3317982969078645]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6600678499822719,0.33993215001772814]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.3317982969078645,-0.3317982969078645]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6600678499822719,0.33993215001772814]]</td><td>0</td></tr></tbody><fthfoot style="display:table-footer-group;border-spacing:0;height:0;border-collapse:collapse;"><fthtr style="display:table-row;border-spacing:0;height:0;border-collapse:collapse"><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd></fthtr></fthfoot></table></div><div style="overflow: hidden; position: absolute; margin-top: 0px; top: 0px; z-index: 1; left: 0px; width: 1385px;" aria-hidden="true" class="floatThead-floatContainer floatThead-container"><table class="table table-bordered table-condensed table-hover floatThead-table" style="margin: 0px; border-bottom-width: 0px; table-layout: fixed; width: 99.9278%;"><colgroup><col style="width: 96px;"><col style="width: 589.6px;"><col style="width: 545.6px;"><col style="width: 152.8px;"></colgroup><thead><tr><th data-column-name="label" style="padding-right: 23px;">label</th><th data-column-name="rawPrediction" style="padding-right: 23px;">rawPrediction</th><th data-column-name="probability" style="padding-right: 23px;">probability</th><th data-column-name="prediction" style="padding-right: 23px;">prediction</th></tr></thead></table></div></div></div><p class="plotWarning">Showing the first 1000 rows.</p></div><div class="control-wrapper"><!-- plotControlsTemplate -->
<div class="plot-controls">
  
  <a class="btn btn-small display-type-button active" data-type="table" title="Raw table">
    <i class="fa fa-table"></i>
  </a>
  <div class="btn-group btn-small" style="padding-left: 4px; padding-right: 4px;">
    <a class="btn btn-small display-type-button" data-type="barChart" title="Bar chart">
      <i class="icon-db-bar"></i>
    </a><a class="btn btn-small dropdown-toggle" data-toggle="dropdown" style="padding-left: 6px; padding-right: 6px">
    <b class="caret"></b>
  </a>
    
    <div class="dropdown-menu" role="menu">
      <div class="row-fluid" style="width: 240px">
        
        <ul class="span6 multicol-menu" style="width: 80px">
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="barChart">
              <i class="icon-db-bar fa fa-fw"></i>
              Bar
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="scatterPlot">
              <i class="icon-db-scatter fa fa-fw"></i>
              Scatter
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="mapPlot">
              <i class="icon-db-map fa fa-fw"></i>
              Map
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="mgLine">
              <i class="icon-db-line fa fa-fw"></i>
              Line
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="areaChart">
              <i class="fa fa-area-chart fa fa-fw"></i>
              Area
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="pieChart">
              <i class="icon-db-pie fa fa-fw"></i>
              Pie
            </a>
          </li>
          
          
        </ul>

        
        <ul class="span6 multicol-menu" style="width: 140px">
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="quantilePlot">
              <i class="icon-db-quantile fa fa-fw"></i>
              Quantile
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="histogram">
              <i class="icon-db-histogram fa fa-fw"></i>
              Histogram
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="boxPlot">
              <i class="icon-db-boxplot fa fa-fw"></i>
              Box plot
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="qqPlot">
              <i class="icon-db-qq fa fa-fw"></i>
              Q-Q plot
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="pivotTable">
              <i class="icon-db-pivot fa fa-fw"></i>
              Pivot
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="lineChart">
              <i class="icon-db-line fa fa-fw"></i>
              Line (deprecated)
            </a>
          </li>
          
          
        </ul>

        
      </div>
      
    </div>
  </div>
  
</div><!-- downloadControlsTemplate -->
<div class="download-controls">
  
  <div class="btn-group btn-small" style="padding-left: 4px; padding-right: 4px;">
    <a class="btn btn-small results-download-preview" title="Download CSV">
      <i class="fa fa-download"></i>
    </a><a class="btn btn-small dropdown-toggle" data-toggle="dropdown" style="padding-left: 6px; padding-right: 6px">
    <b class="caret"></b>
  </a>
    <div class="dropdown-menu" role="menu">
      <div class="row-fluid" style="">
        <ul class="span12 multicol-menu">
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="results-download-preview">
              Download preview
            </a>
          </li>
          
            <li>
              <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="results-download">
                Download full results (max 1 million rows)
              </a>
            </li>
          
        </ul>
      </div>
    </div>
  </div>
  
</div></div><div style="height: 32px;"></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div><div class="command-result-stats"><span>Command took</span> <span>1.88 seconds</span> <span class="command-provenance">-- by jeffreyzhangma@gmail.com</span><span> at 12/24/2019, 12:31:27 PM</span><span title="1224-170603-cleat207"> on My Cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298365"><i class="fa fa-link"></i>Cmd 51</a><div class="new-notebook command mainCommand command-finished cellIndex-50 cell-825169771298314-825169771298365"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-50 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-50 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span>#</span><span>#</span><span>#</span><span>#</span><span>Logistic</span><span> </span><span>Regression</span><span> </span><span>-</span><span> </span><span>Evaluate</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="f5edfa9f-647a-421e-8dfa-0a2f5ab82732" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h4>Logistic Regression - Evaluate</h4>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"><i class="fa fa-minus-square-o"></i></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298366"><i class="fa fa-link"></i>Cmd 52</a><div class="new-notebook command mainCommand command-finished cellIndex-51 cell-825169771298314-825169771298366"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-51 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-51 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>#</span><span>#</span><span>#</span><span>#</span><span class="cm-tag bracket">&lt;</span><span class="cm-tag">span</span><span> </span><span class="cm-attribute">style</span><span>=</span><span class="cm-string">"color:darkblue"</span><span class="cm-tag bracket">&gt;</span><span>Question 5</span><span class="cm-tag bracket">&lt;/</span><span class="cm-tag">span</span><span class="cm-tag bracket">&gt;</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span class="cm-variable-2">1. </span><span class="cm-variable-2">Complete</span><span class="cm-variable-2"></span><span class="cm-variable-2"> </span><span class="cm-variable-2">the</span><span class="cm-variable-2"> </span><span class="cm-variable-2">print</span><span class="cm-variable-2">_</span><span class="cm-variable-2">performance</span><span class="cm-variable-2">_</span><span class="cm-variable-2">metrics</span><span class="cm-variable-2">(</span><span class="cm-variable-2">)</span><span class="cm-variable-2"> </span><span class="cm-variable-2">function</span><span class="cm-variable-2"> </span><span class="cm-variable-2">below</span><span class="cm-variable-2"> </span><span class="cm-variable-2">to</span><span class="cm-variable-2"> </span><span class="cm-variable-2">also</span><span class="cm-variable-2"> </span><span class="cm-variable-2">include</span><span class="cm-variable-2"> </span><span class="cm-variable-2">measures</span><span class="cm-variable-2"> </span><span class="cm-variable-2">of</span><span class="cm-variable-2"> </span><span class="cm-variable-2">F1,</span><span class="cm-variable-2"> </span><span class="cm-variable-2">Precision,</span><span class="cm-variable-2"> </span><span class="cm-variable-2">Recall,</span><span class="cm-variable-2"> </span><span class="cm-variable-2">False</span><span class="cm-variable-2"> </span><span class="cm-variable-2">Positive</span><span class="cm-variable-2"> </span><span class="cm-variable-2">Rate</span><span class="cm-variable-2"> </span><span class="cm-variable-2">and</span><span class="cm-variable-2"> </span><span class="cm-variable-2">True</span><span class="cm-variable-2"> </span><span class="cm-variable-2">Positive</span><span class="cm-variable-2"> </span><span class="cm-variable-2">Rate.</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="8f0cf25f-6ba0-4629-aeef-b157839b2cf8" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h4><span style="color:darkblue;">Question 5</span></h4>
<ol>
<li>Complete the print_performance_metrics() function below to also include measures of F1, Precision, Recall, False Positive Rate and True Positive Rate.</li>
</ol>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298367"><i class="fa fa-link"></i>Cmd 53</a><div class="new-notebook command mainCommand command-finished cellIndex-52 cell-825169771298314-825169771298367"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="edit-button edit-button-52 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 674.4px; left: 359.8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="1"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true" style="bottom: 0px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="false"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 790px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 329.8px; top: 662.4px; height: 18.4px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">pyspark</span>.<span class="cm-property">ml</span>.<span class="cm-property">evaluation</span> <span class="cm-keyword">import</span> <span class="cm-variable">BinaryClassificationEvaluator</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">pyspark</span>.<span class="cm-property">mllib</span>.<span class="cm-property">evaluation</span> <span class="cm-keyword">import</span> <span class="cm-variable">BinaryClassificationMetrics</span>, <span class="cm-variable">MulticlassMetrics</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">print_performance_metrics</span>(<span class="cm-variable">predictions</span>):</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># Evaluate model</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">evaluator</span> <span class="cm-operator">=</span> <span class="cm-variable">BinaryClassificationEvaluator</span>(<span class="cm-variable">rawPredictionCol</span><span class="cm-operator">=</span><span class="cm-string">"rawPrediction"</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">auc</span> <span class="cm-operator">=</span> <span class="cm-variable">evaluator</span>.<span class="cm-property">evaluate</span>(<span class="cm-variable">predictions</span>, {<span class="cm-variable">evaluator</span>.<span class="cm-property">metricName</span>: <span class="cm-string">"areaUnderROC"</span>})</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">aupr</span> <span class="cm-operator">=</span> <span class="cm-variable">evaluator</span>.<span class="cm-property">evaluate</span>(<span class="cm-variable">predictions</span>, {<span class="cm-variable">evaluator</span>.<span class="cm-property">metricName</span>: <span class="cm-string">"areaUnderPR"</span>})</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-builtin">print</span>(<span class="cm-string">"auc = {}"</span>.<span class="cm-property">format</span>(<span class="cm-variable">auc</span>))</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">10</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-builtin">print</span>(<span class="cm-string">"aupr = {}"</span>.<span class="cm-property">format</span>(<span class="cm-variable">aupr</span>))</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">11</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">12</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># get rdd of predictions and labels for mllib eval metrics</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">13</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">predictionAndLabels</span> <span class="cm-operator">=</span> <span class="cm-variable">predictions</span>.<span class="cm-property">select</span>(<span class="cm-string">"prediction"</span>,<span class="cm-string">"label"</span>).<span class="cm-property">rdd</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">14</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">15</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># Instantiate metrics objects</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">16</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">binary_metrics</span> <span class="cm-operator">=</span> <span class="cm-variable">BinaryClassificationMetrics</span>(<span class="cm-variable">predictionAndLabels</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">17</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-variable">multi_metrics</span> <span class="cm-operator">=</span> <span class="cm-variable">MulticlassMetrics</span>(<span class="cm-variable">predictionAndLabels</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">18</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">19</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># Area under precision-recall curve</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">20</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-builtin">print</span>(<span class="cm-string">"Area under PR = {}"</span>.<span class="cm-property">format</span>(<span class="cm-variable">binary_metrics</span>.<span class="cm-property">areaUnderPR</span>))</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">21</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># Area under ROC curve</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">22</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-builtin">print</span>(<span class="cm-string">"Area under ROC = {}"</span>.<span class="cm-property">format</span>(<span class="cm-variable">binary_metrics</span>.<span class="cm-property">areaUnderROC</span>))</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">23</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># Accuracy</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">24</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-builtin">print</span>(<span class="cm-string">"Accuracy = {}"</span>.<span class="cm-property">format</span>(<span class="cm-variable">multi_metrics</span>.<span class="cm-property">accuracy</span>))</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">25</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># Confusion Matrix</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">26</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-builtin">print</span>(<span class="cm-variable">multi_metrics</span>.<span class="cm-property">confusionMatrix</span>())</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">27</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">28</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment">### Question 5.1 Answer ###</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">29</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">30</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># F1</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">31</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-builtin">print</span>(<span class="cm-string">"F1 = {}"</span>.<span class="cm-property">format</span>(<span class="cm-variable">multi_metrics</span>.<span class="cm-property">weightedFMeasure</span>(<span class="cm-number">1.0</span>)))</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">32</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># Precision</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">33</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-builtin">print</span>(<span class="cm-string">"Precision = {}"</span>.<span class="cm-property">format</span>(<span class="cm-variable">multi_metrics</span>.<span class="cm-property">weightedPrecision</span>))</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">34</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># Recall</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">35</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-builtin">print</span>(<span class="cm-string">"Recall = {}"</span>.<span class="cm-property">format</span>(<span class="cm-variable">multi_metrics</span>.<span class="cm-property">weightedRecall</span>))</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">36</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># FPR</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">37</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-builtin">print</span>(<span class="cm-string">"FPR = {}"</span>.<span class="cm-property">format</span>(<span class="cm-variable">multi_metrics</span>.<span class="cm-property">weightedFalsePositiveRate</span>))</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">38</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-comment"># TPR</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">39</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;<span class="cm-builtin">print</span>(<span class="cm-string">"TPR = {}"</span>.<span class="cm-property">format</span>(<span class="cm-variable">multi_metrics</span>.<span class="cm-property">weightedTruePositiveRate</span>))</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">40</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">41</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">42</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">print_performance_metrics</span>(<span class="cm-variable">lrPredictions</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 790px;"></div><div class="CodeMirror-gutters" style="height: 803px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-fw fa-caret-right"></i>(17) Spark Jobs</p></div></div><div class="results"><div class="ansiout">auc = 0.9032867661805299
aupr = 0.7627830907418989
Area under PR = 0.5366100314564946
Area under ROC = 0.8159794860040686
Accuracy = 0.80067880283863
DenseMatrix([[5776., 1572.],
             [ 366., 2009.]])
F1 = 0.8119489549119079
Precision = 0.8477372148143116
Recall = 0.8006788028386301
FPR = 0.16871983083049324
TPR = 0.8006788028386301
</div></div><div class="command-result-stats"><span>Command took</span> <span>13.21 seconds</span> <span class="command-provenance">-- by jeffreyzhangma@gmail.com</span><span> at 12/24/2019, 12:33:42 PM</span><span title="1224-170603-cleat207"> on My Cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"><i class="fa fa-minus-square-o"></i></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298368"><i class="fa fa-link"></i>Cmd 54</a><div class="new-notebook command mainCommand command-finished cellIndex-53 cell-825169771298314-825169771298368"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-53 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-53 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>#</span><span>#</span><span>#</span><span>#</span><span>GBM</span><span> </span><span>-</span><span> </span><span>Evaluate</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="42be8c3a-3072-487b-ab7e-5f8c20230373" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h4>GBM - Evaluate</h4>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298369"><i class="fa fa-link"></i>Cmd 55</a><div class="new-notebook command mainCommand command-finished cellIndex-54 cell-825169771298314-825169771298369"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="edit-button edit-button-54 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-variable">print_performance_metrics</span><span>(</span><span class="cm-variable">gbPredictions</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-fw fa-caret-right"></i>(17) Spark Jobs</p></div></div><div class="results"><div class="ansiout">auc = 0.903386757585308
aupr = 0.7738361178782271
Area under PR = 0.6506911765223153
Area under ROC = 0.7544298197862649
Accuracy = 0.8510747711611643
DenseMatrix([[6932.,  416.],
             [1032., 1343.]])
F1 = 0.8429748516155657
Precision = 0.8443011858599514
Recall = 0.8510747711611643
FPR = 0.3422151315886347
TPR = 0.8510747711611643
</div></div><div class="command-result-stats"><span>Command took</span> <span>11.99 seconds</span> <span class="command-provenance">-- by jeffreyzhangma@gmail.com</span><span> at 12/24/2019, 12:35:35 PM</span><span title="1224-170603-cleat207"> on My Cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"><i class="fa fa-minus-square-o"></i></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298370"><i class="fa fa-link"></i>Cmd 56</a><div class="new-notebook command mainCommand command-finished cellIndex-55 cell-825169771298314-825169771298370"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-55 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-55 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span class="cm-header header-2">## </span><span class="cm-header header-2">Cross</span><span class="cm-header header-2"> </span><span class="cm-header header-2">Validation</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="79229f8d-83f5-440d-bb1f-79a59c17431d" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h2>Cross Validation</h2>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298371"><i class="fa fa-link"></i>Cmd 57</a><div class="new-notebook command mainCommand command-finished cellIndex-56 cell-825169771298314-825169771298371"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-56 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-56 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>For</span><span> </span><span>each</span><span> </span><span>model</span><span> </span><span>you</span><span> </span><span>can</span><span> </span><span>run</span><span> </span><span>the</span><span> </span><span>below</span><span> </span><span>comand</span><span> </span><span>to</span><span> </span><span>see</span><span> </span><span>its</span><span> </span><span>params</span><span> </span><span>and</span><span> </span><span>a</span><span> </span><span>brief</span><span> </span><span>explanation</span><span> </span><span>of</span><span> </span><span>each.</span><span> </span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="85aac127-7df5-4bdd-966b-68c906ceaa20" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><p>For each model you can run the below comand to see its params and a brief explanation of each. </p>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298372"><i class="fa fa-link"></i>Cmd 58</a><div class="new-notebook command mainCommand command-finished cellIndex-57 cell-825169771298314-825169771298372"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="edit-button edit-button-57 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-builtin">print</span><span>(</span><span class="cm-variable">lr</span><span>.</span><span class="cm-property">explainParams</span><span>(</span><span>)</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="resizable-wrapper ui-resizable" style="height: 400px;"><div class="noscroll-wrapper noscroll" tabindex="-1"><div class="inner"><div class="results"><div class="ansiout">aggregationDepth: suggested depth for treeAggregate (&gt;= 2). (default: 2)
elasticNetParam: the ElasticNet mixing parameter, in range [0, 1]. For alpha = 0, the penalty is an L2 penalty. For alpha = 1, it is an L1 penalty. (default: 0.0)
family: The name of family which is a description of the label distribution to be used in the model. Supported options: auto, binomial, multinomial (default: auto)
featuresCol: features column name. (default: features, current: features)
fitIntercept: whether to fit an intercept term. (default: True)
labelCol: label column name. (default: label, current: label)
lowerBoundsOnCoefficients: The lower bounds on coefficients if fitting under bound constrained optimization. The bound matrix must be compatible with the shape (1, number of features) for binomial regression, or (number of classes, number of features) for multinomial regression. (undefined)
lowerBoundsOnIntercepts: The lower bounds on intercepts if fitting under bound constrained optimization. The bounds vector size must beequal with 1 for binomial regression, or the number oflasses for multinomial regression. (undefined)
maxIter: max number of iterations (&gt;= 0). (default: 100, current: 10)
predictionCol: prediction column name. (default: prediction)
probabilityCol: Column name for predicted class conditional probabilities. Note: Not all models output well-calibrated probability estimates! These probabilities should be treated as confidences, not precise probabilities. (default: probability)
rawPredictionCol: raw prediction (a.k.a. confidence) column name. (default: rawPrediction)
regParam: regularization parameter (&gt;= 0). (default: 0.0)
standardization: whether to standardize the training features before fitting the model. (default: True)
threshold: Threshold in binary classification prediction, in range [0, 1]. If threshold and thresholds are both set, they must match.e.g. if threshold is p, then thresholds must be equal to [1-p, p]. (default: 0.5, current: 0.23934842580023646)
thresholds: Thresholds in multi-class classification to adjust the probability of predicting each class. Array must have length equal to the number of classes, with values &gt; 0, excepting that at most one value may be 0. The class with largest value p/t is predicted, where p is the original probability of that class and t is the class's threshold. (undefined)
tol: the convergence tolerance for iterative algorithms (&gt;= 0). (default: 1e-06)
upperBoundsOnCoefficients: The upper bounds on coefficients if fitting under bound constrained optimization. The bound matrix must be compatible with the shape (1, number of features) for binomial regression, or (number of classes, number of features) for multinomial regression. (undefined)
upperBoundsOnIntercepts: The upper bounds on intercepts if fitting under bound constrained optimization. The bound vector size must be equal with 1 for binomial regression, or the number of classes for multinomial regression. (undefined)
weightCol: weight column name. If this is not set or empty, we treat all instance weights as 1.0. (undefined)
</div></div></div></div><div class="ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se" style="z-index: 90;"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.02 seconds</span> <span class="command-provenance">-- by jeffreyzhangma@gmail.com</span><span> at 12/24/2019, 12:35:52 PM</span><span title="1224-170603-cleat207"> on My Cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298373"><i class="fa fa-link"></i>Cmd 59</a><div class="new-notebook command mainCommand command-finished cellIndex-58 cell-825169771298314-825169771298373"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="edit-button edit-button-58 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-builtin">print</span><span>(</span><span class="cm-variable">gb</span><span>.</span><span class="cm-property">explainParams</span><span>(</span><span>)</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="results"><div class="ansiout">cacheNodeIds: If false, the algorithm will pass trees to executors to match instances with nodes. If true, the algorithm will cache node IDs for each instance. Caching can speed up training of deeper trees. Users can set how often should the cache be checkpointed or disable it by setting checkpointInterval. (default: False)
checkpointInterval: set checkpoint interval (&gt;= 1) or disable checkpoint (-1). E.g. 10 means that the cache will get checkpointed every 10 iterations. Note: this setting will be ignored if the checkpoint directory is not set in the SparkContext. (default: 10)
featureSubsetStrategy: The number of features to consider for splits at each tree node. Supported options: 'auto' (choose automatically for task: If numTrees == 1, set to 'all'. If numTrees &gt; 1 (forest), set to 'sqrt' for classification and to 'onethird' for regression), 'all' (use all features), 'onethird' (use 1/3 of the features), 'sqrt' (use sqrt(number of features)), 'log2' (use log2(number of features)), 'n' (when n is in the range (0, 1.0], use n * number of features. When n is in the range (1, number of features), use n features). default = 'auto' (default: all)
featuresCol: features column name. (default: features, current: features)
labelCol: label column name. (default: label, current: label)
lossType: Loss function which GBT tries to minimize (case-insensitive). Supported options: logistic (default: logistic)
maxBins: Max number of bins for discretizing continuous features.  Must be &gt;=2 and &gt;= number of categories for any categorical feature. (default: 32)
maxDepth: Maximum depth of the tree. (&gt;= 0) E.g., depth 0 means 1 leaf node; depth 1 means 1 internal node + 2 leaf nodes. (default: 5)
maxIter: max number of iterations (&gt;= 0). (default: 20, current: 10)
maxMemoryInMB: Maximum memory in MB allocated to histogram aggregation. If too small, then 1 node will be split per iteration, and its aggregates may exceed this size. (default: 256)
minInfoGain: Minimum information gain for a split to be considered at a tree node. (default: 0.0)
minInstancesPerNode: Minimum number of instances each child must have after split. If a split causes the left or right child to have fewer than minInstancesPerNode, the split will be discarded as invalid. Should be &gt;= 1. (default: 1)
predictionCol: prediction column name. (default: prediction)
seed: random seed. (default: 3504127614838123891)
stepSize: Step size (a.k.a. learning rate) in interval (0, 1] for shrinking the contribution of each estimator. (default: 0.1)
subsamplingRate: Fraction of the training data used for learning each decision tree, in range (0, 1]. (default: 1.0)
</div></div><div class="command-result-stats"><span>Command took</span> <span>0.03 seconds</span> <span class="command-provenance">-- by jeffreyzhangma@gmail.com</span><span> at 12/24/2019, 12:35:54 PM</span><span title="1224-170603-cleat207"> on My Cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"><i class="fa fa-minus-square-o"></i></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298374"><i class="fa fa-link"></i>Cmd 60</a><div class="new-notebook command mainCommand command-finished cellIndex-59 cell-825169771298314-825169771298374"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-59 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-59 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span>#</span><span>#</span><span>#</span><span>#</span><span>Logisitic</span><span> </span><span>Regression</span><span> </span><span>-</span><span> </span><span>Param</span><span> </span><span>Grid</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="eafa6d93-4f34-47a5-9cb9-1eea8cfedda4" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h4>Logisitic Regression - Param Grid</h4>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298375"><i class="fa fa-link"></i>Cmd 61</a><div class="new-notebook command mainCommand command-finished cellIndex-60 cell-825169771298314-825169771298375"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="edit-button edit-button-60 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 12px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="1"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 164px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 10px; top: 0px; height: 18.4px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">pyspark</span>.<span class="cm-property">ml</span>.<span class="cm-property">tuning</span> <span class="cm-keyword">import</span> <span class="cm-variable">ParamGridBuilder</span>, <span class="cm-variable">CrossValidator</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Create ParamGrid for Cross Validation</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">lrParamGrid</span> <span class="cm-operator">=</span> (<span class="cm-variable">ParamGridBuilder</span>()</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .<span class="cm-property">addGrid</span>(<span class="cm-variable">lr</span>.<span class="cm-property">regParam</span>, [<span class="cm-number">0.01</span>, <span class="cm-number">0.5</span>, <span class="cm-number">2.0</span>])</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .<span class="cm-property">addGrid</span>(<span class="cm-variable">lr</span>.<span class="cm-property">elasticNetParam</span>, [<span class="cm-number">0.0</span>, <span class="cm-number">0.5</span>, <span class="cm-number">1.0</span>])</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .<span class="cm-property">addGrid</span>(<span class="cm-variable">lr</span>.<span class="cm-property">maxIter</span>, [<span class="cm-number">2</span>, <span class="cm-number">5</span>])</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .<span class="cm-property">build</span>())</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 164px;"></div><div class="CodeMirror-gutters" style="height: 177px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.04 seconds</span> <span class="command-provenance">-- by jeffreyzhangma@gmail.com</span><span> at 12/24/2019, 12:35:59 PM</span><span title="1224-170603-cleat207"> on My Cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298376"><i class="fa fa-link"></i>Cmd 62</a><div class="new-notebook command mainCommand command-finished cellIndex-61 cell-825169771298314-825169771298376"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-61 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-61 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>#</span><span>#</span><span>#</span><span>#</span><span>GBM</span><span> </span><span>-</span><span> </span><span>Param</span><span> </span><span>Grid</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="cdeeff9f-c1ed-43de-90a1-b7c8bcdd82e4" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h4>GBM - Param Grid</h4>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"><i class="fa fa-minus-square-o"></i></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298377"><i class="fa fa-link"></i>Cmd 63</a><div class="new-notebook command mainCommand command-finished cellIndex-62 cell-825169771298314-825169771298377"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-62 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-62 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>#</span><span>#</span><span>#</span><span>#</span><span class="cm-tag bracket">&lt;</span><span class="cm-tag">span</span><span> </span><span class="cm-attribute">style</span><span>=</span><span class="cm-string">"color:darkblue"</span><span class="cm-tag bracket">&gt;</span><span>Question 6</span><span class="cm-tag bracket">&lt;/</span><span class="cm-tag">span</span><span class="cm-tag bracket">&gt;</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span class="cm-variable-2">1. </span><span class="cm-variable-2">Build</span><span class="cm-variable-2"></span><span class="cm-variable-2"> </span><span class="cm-variable-2">out</span><span class="cm-variable-2"> </span><span class="cm-variable-2">a</span><span class="cm-variable-2"> </span><span class="cm-variable-2">param</span><span class="cm-variable-2"> </span><span class="cm-variable-2">grid</span><span class="cm-variable-2"> </span><span class="cm-variable-2">for</span><span class="cm-variable-2"> </span><span class="cm-variable-2">the</span><span class="cm-variable-2"> </span><span class="cm-variable-2">gb</span><span class="cm-variable-2"> </span><span class="cm-variable-2">model,</span><span class="cm-variable-2"> </span><span class="cm-variable-2">call</span><span class="cm-variable-2"> </span><span class="cm-variable-2">it</span><span class="cm-variable-2"> </span><span class="cm-variable-2">'</span><span class="cm-variable-2">gbParamGrid</span><span class="cm-variable-2">'</span><span class="cm-variable-2">.</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="68ec9ed7-285f-41ac-b5a9-e5e33d000be3" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h4><span style="color:darkblue;">Question 6</span></h4>
<ol>
<li>Build out a param grid for the gb model, call it 'gbParamGrid'.</li>
</ol>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298378"><i class="fa fa-link"></i>Cmd 64</a><div class="new-notebook command mainCommand command-finished cellIndex-63 cell-825169771298314-825169771298378"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="edit-button edit-button-63 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 122.4px; left: 211.6px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="1"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 146px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 181.6px; top: 110.4px; height: 18.4px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">### Question 6.1 Answer ###</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Create ParamGrid for Cross Validation</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">gbParamGrid</span> <span class="cm-operator">=</span> <span class=" CodeMirror-matchingbracket">(</span><span class="cm-variable">ParamGridBuilder</span>()</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .<span class="cm-property">addGrid</span>(<span class="cm-variable">gb</span>.<span class="cm-property">maxDepth</span>, [<span class="cm-number">5</span>, <span class="cm-number">10</span>])</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .<span class="cm-property">addGrid</span>(<span class="cm-variable">gb</span>.<span class="cm-property">maxIter</span>, [<span class="cm-number">2</span>, <span class="cm-number">5</span>])</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; .<span class="cm-property">build</span>()<span class=" CodeMirror-matchingbracket">)</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 146px;"></div><div class="CodeMirror-gutters" style="height: 159px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.03 seconds</span> <span class="command-provenance">-- by jeffreyzhangma@gmail.com</span><span> at 12/24/2019, 12:37:21 PM</span><span title="1224-170603-cleat207"> on My Cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"><i class="fa fa-minus-square-o"></i></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298379"><i class="fa fa-link"></i>Cmd 65</a><div class="new-notebook command mainCommand command-finished cellIndex-64 cell-825169771298314-825169771298379"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-64 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-64 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span>#</span><span>#</span><span>#</span><span>#</span><span>Logistic</span><span> </span><span>Regression</span><span> </span><span>-</span><span> </span><span>Perform</span><span> </span><span>Cross</span><span> </span><span>Validation</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="4550d86c-0542-413c-87ac-166fbf0a956a" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h4>Logistic Regression - Perform Cross Validation</h4>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298380"><i class="fa fa-link"></i>Cmd 66</a><div class="new-notebook command mainCommand command-finished cellIndex-65 cell-825169771298314-825169771298380"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="edit-button edit-button-65 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 12px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="1"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 182px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 10px; top: 0px; height: 18.4px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># set up an evaluator</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">evaluator</span> <span class="cm-operator">=</span> <span class="cm-variable">BinaryClassificationEvaluator</span>(<span class="cm-variable">rawPredictionCol</span><span class="cm-operator">=</span><span class="cm-string">"rawPrediction"</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Create CrossValidator</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">lrCv</span> <span class="cm-operator">=</span> <span class="cm-variable">CrossValidator</span>(<span class="cm-variable">estimator</span><span class="cm-operator">=</span><span class="cm-variable">lr</span>, <span class="cm-variable">estimatorParamMaps</span><span class="cm-operator">=</span><span class="cm-variable">lrParamGrid</span>, <span class="cm-variable">evaluator</span><span class="cm-operator">=</span><span class="cm-variable">evaluator</span>, <span class="cm-variable">numFolds</span><span class="cm-operator">=</span><span class="cm-number">2</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Run cross validations</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">lrCvModel</span> <span class="cm-operator">=</span> <span class="cm-variable">lrCv</span>.<span class="cm-property">fit</span>(<span class="cm-variable">trainingData</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># this will likely take a fair amount of time because of the amount of models that we're creating and testing</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 182px;"></div><div class="CodeMirror-gutters" style="height: 195px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-fw fa-caret-right"></i>(54) Spark Jobs</p></div></div><div class="results"><div class="ansiout">/databricks/spark/python/pyspark/ml/util.py:791: UserWarning: Can not find mlflow. To enable mlflow logging, install MLflow library from PyPi.
  warnings.warn(_MLflowInstrumentation._NO_MLFLOW_WARNING)
</div></div><div class="command-result-stats"><span>Command took</span> <span>59.27 seconds</span> <span class="command-provenance">-- by jeffreyzhangma@gmail.com</span><span> at 12/24/2019, 12:37:28 PM</span><span title="1224-170603-cleat207"> on My Cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298381"><i class="fa fa-link"></i>Cmd 67</a><div class="new-notebook command mainCommand command-finished cellIndex-66 cell-825169771298314-825169771298381"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="edit-button edit-button-66 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 12px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="1"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 146px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 10px; top: 0px; height: 18.4px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># below approach to getting at the best params from the best cv model taken from:</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># https://stackoverflow.com/a/46353730/1919374</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># look at best params from the CV</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">lrCvModel</span>.<span class="cm-property">bestModel</span>.<span class="cm-property">_java_obj</span>.<span class="cm-property">getRegParam</span>())</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">lrCvModel</span>.<span class="cm-property">bestModel</span>.<span class="cm-property">_java_obj</span>.<span class="cm-property">getElasticNetParam</span>())</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">lrCvModel</span>.<span class="cm-property">bestModel</span>.<span class="cm-property">_java_obj</span>.<span class="cm-property">getMaxIter</span>())</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 146px;"></div><div class="CodeMirror-gutters" style="height: 159px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="results"><div class="ansiout">0.01
0.0
5
</div></div><div class="command-result-stats"><span>Command took</span> <span>0.03 seconds</span> <span class="command-provenance">-- by jeffreyzhangma@gmail.com</span><span> at 12/24/2019, 1:06:02 PM</span><span title="1224-170603-cleat207"> on My Cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298382"><i class="fa fa-link"></i>Cmd 68</a><div class="new-notebook command mainCommand command-finished cellIndex-67 cell-825169771298314-825169771298382"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-67 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-67 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>#</span><span>#</span><span>#</span><span>#</span><span>GBM</span><span> </span><span>-</span><span> </span><span>Perform</span><span> </span><span>Cross</span><span> </span><span>Validation</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="47239c36-d362-4919-9f6b-127c5e23b5e9" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h4>GBM - Perform Cross Validation</h4>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"><i class="fa fa-minus-square-o"></i></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298383"><i class="fa fa-link"></i>Cmd 69</a><div class="new-notebook command mainCommand command-finished cellIndex-68 cell-825169771298314-825169771298383"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-68 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-68 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>#</span><span>#</span><span>#</span><span>#</span><span class="cm-tag bracket">&lt;</span><span class="cm-tag">span</span><span> </span><span class="cm-attribute">style</span><span>=</span><span class="cm-string">"color:darkblue"</span><span class="cm-tag bracket">&gt;</span><span>Question 7</span><span class="cm-tag bracket">&lt;/</span><span class="cm-tag">span</span><span class="cm-tag bracket">&gt;</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span class="cm-variable-2">1. </span><span class="cm-variable-2">Perform</span><span class="cm-variable-2"></span><span class="cm-variable-2"> </span><span class="cm-variable-2">cross</span><span class="cm-variable-2"> </span><span class="cm-variable-2">validation</span><span class="cm-variable-2"> </span><span class="cm-variable-2">of</span><span class="cm-variable-2"> </span><span class="cm-variable-2">params</span><span class="cm-variable-2"> </span><span class="cm-variable-2">on</span><span class="cm-variable-2"> </span><span class="cm-variable-2">your</span><span class="cm-variable-2"> </span><span class="cm-variable-2">'</span><span class="cm-variable-2">gb</span><span class="cm-variable-2">'</span><span class="cm-variable-2"> </span><span class="cm-variable-2">model.</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span class="cm-variable-2">1. </span><span class="cm-variable-2">Print</span><span class="cm-variable-2"></span><span class="cm-variable-2"> </span><span class="cm-variable-2">out</span><span class="cm-variable-2"> </span><span class="cm-variable-2">the</span><span class="cm-variable-2"> </span><span class="cm-variable-2">best</span><span class="cm-variable-2"> </span><span class="cm-variable-2">params</span><span class="cm-variable-2"> </span><span class="cm-variable-2">you</span><span class="cm-variable-2"> </span><span class="cm-variable-2">found.</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="c046fc60-ac64-4f18-9145-809b33d8b6a1" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h4><span style="color:darkblue;">Question 7</span></h4>
<ol>
<li>Perform cross validation of params on your 'gb' model.</li>
<li>Print out the best params you found.</li>
</ol>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298384"><i class="fa fa-link"></i>Cmd 70</a><div class="new-notebook command mainCommand command-finished cellIndex-69 cell-825169771298314-825169771298384"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="edit-button edit-button-69 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 30.4px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="1"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 146px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>7</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 10px; top: 18.4px; height: 18.4px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">### Question 7.1 Answer ###</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Create CrossValidator</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">gbCv</span> <span class="cm-operator">=</span> <span class="cm-variable">CrossValidator</span>(<span class="cm-variable">estimator</span><span class="cm-operator">=</span><span class="cm-variable">gb</span>, <span class="cm-variable">estimatorParamMaps</span><span class="cm-operator">=</span><span class="cm-variable">gbParamGrid</span>, <span class="cm-variable">evaluator</span><span class="cm-operator">=</span><span class="cm-variable">evaluator</span>, <span class="cm-variable">numFolds</span><span class="cm-operator">=</span><span class="cm-number">2</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># Run cross validations</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">gbCvModel</span> <span class="cm-operator">=</span> <span class="cm-variable">gbCv</span>.<span class="cm-property">fit</span>(<span class="cm-variable">trainingData</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 146px;"></div><div class="CodeMirror-gutters" style="height: 159px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-fw fa-caret-right"></i>(54) Spark Jobs</p></div></div><div class="results"><div class="ansiout"></div></div><div class="command-result-stats"><span>Command took</span> <span>1.17 minutes</span> <span class="command-provenance">-- by jeffreyzhangma@gmail.com</span><span> at 12/24/2019, 1:08:12 PM</span><span title="1224-170603-cleat207"> on My Cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298385"><i class="fa fa-link"></i>Cmd 71</a><div class="new-notebook command mainCommand command-finished cellIndex-70 cell-825169771298314-825169771298385"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="edit-button edit-button-70 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 85.6px; left: 422.2px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="1"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 109px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>5</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 392.2px; top: 73.6px; height: 18.4px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">### Question 7.2 Answer ###</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># look at best params from the CV</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">gbCvModel</span>.<span class="cm-property">bestModel</span>.<span class="cm-property">_java_obj</span>.<span class="cm-property">getMaxDepth</span>())</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span><span class=" CodeMirror-matchingbracket">(</span><span class="cm-variable">gbCvModel</span>.<span class="cm-property">bestModel</span>.<span class="cm-property">_java_obj</span>.<span class="cm-property">getMaxIter</span>()<span class=" CodeMirror-matchingbracket">)</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 109px;"></div><div class="CodeMirror-gutters" style="height: 122px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="results"><div class="ansiout">5
5
</div></div><div class="command-result-stats"><span>Command took</span> <span>0.03 seconds</span> <span class="command-provenance">-- by jeffreyzhangma@gmail.com</span><span> at 12/24/2019, 1:07:36 PM</span><span title="1224-170603-cleat207"> on My Cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"><i class="fa fa-minus-square-o"></i></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298386"><i class="fa fa-link"></i>Cmd 72</a><div class="new-notebook command mainCommand command-finished cellIndex-71 cell-825169771298314-825169771298386"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-71 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-71 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>#</span><span>#</span><span>#</span><span>#</span><span>Logistic</span><span> </span><span>Regression</span><span> </span><span>-</span><span> </span><span>CV</span><span> </span><span>Model</span><span> </span><span>Predict</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="67331c91-c91a-490e-8ada-66d5efa451e8" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h4>Logistic Regression - CV Model Predict</h4>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298387"><i class="fa fa-link"></i>Cmd 73</a><div class="new-notebook command mainCommand command-finished cellIndex-72 cell-825169771298314-825169771298387"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="dashboard-button dashboard-button-72 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-72 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-comment"># Use test set to measure the accuracy of our model on new data</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-variable">lrCvPredictions</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">lrCvModel</span><span>.</span><span class="cm-property">transform</span><span>(</span><span class="cm-variable">testData</span><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span class="cm-variable">display</span><span>(</span><span class="cm-variable">lrCvPredictions</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-fw fa-caret-right"></i>(1) Spark Jobs</p></div></div><div class="dataset-info-view"><div class=""><a class="tree-toggler"><i class="fa fa-caret-right fa-fw"></i><i class="fa fa-list-alt fa-fw"></i><span class="spacing-left">lrCvPredictions:</span><span class="spacing-left">pyspark.sql.dataframe.DataFrame = [label: double, features: udt ... 18 more fields]</span></a></div><div class="outer-most-struct"></div></div><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget ui-resizable" data-guid="430db15d-55d8-40ad-af07-6aa4fd57fd70" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se" style="z-index: 90; display: block;"></div><div class="widget-content dashboard"><div class="results"><div class="results-table noscroll" tabindex="-1"><div class="floatThead-wrapper" style="position: relative; clear:both;"><div class="inner"><table class="table table-bordered table-condensed table-hover" style="table-layout: fixed; min-width: 2380px;"><colgroup><col style="width: 58.4px;"><col style="width: 239.2px;"><col style="width: 52px;"><col style="width: 92px;"><col style="width: 67.2px;"><col style="width: 90.4px;"><col style="width: 125.6px;"><col style="width: 117.6px;"><col style="width: 98.4px;"><col style="width: 103.2px;"><col style="width: 56px;"><col style="width: 54.4px;"><col style="width: 104px;"><col style="width: 104px;"><col style="width: 132px;"><col style="width: 121.6px;"><col style="width: 74.4px;"><col style="width: 312px;"><col style="width: 285.6px;"><col style="width: 92px;"></colgroup><thead><tr class="size-row" style="height: 36px;"><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th></tr></thead><tbody><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,29,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,26,58426,9,50]]</td><td>26</td><td> Private</td><td>58426</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>50</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.25873328482870595,-0.25873328482870595]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5643248797009943,0.43567512029900574]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,29,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,30,83253,9,55]]</td><td>30</td><td> Private</td><td>83253</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>55</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.23884764095141953,-0.23884764095141953]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5594296489835735,0.4405703510164266]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,29,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,31,62374,9,50]]</td><td>31</td><td> Private</td><td>62374</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>50</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.2409086757382164,-0.2409086757382164]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.559937565953373,0.4400624340466271]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,29,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,32,32732,9,50]]</td><td>32</td><td> Private</td><td>32732</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>50</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.21452578973107994,-0.21452578973107994]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5534267071472767,0.4465732928527233]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,29,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,39,181705,9,45]]</td><td>39</td><td> Private</td><td>181705</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>45</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.3190019725053903,-0.3190019725053903]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5790810059633363,0.4209189940366636]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,29,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,47,76612,9,50]]</td><td>47</td><td> Private</td><td>76612</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>50</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.1850729242480167,-0.1850729242480167]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5461366169429546,0.45386338305704543]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,29,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,50,81548,9,40]]</td><td>50</td><td> Private</td><td>81548</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.22004971984717847,-0.22004971984717847]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5547915158380016,0.44520848416199843]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,29,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,51,95469,9,40]]</td><td>51</td><td> Private</td><td>95469</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.2263308729956266,-0.2263308729956266]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.556342408566416,0.443657591433584]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,29,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,60,198727,9,30]]</td><td>60</td><td> Private</td><td>198727</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>30</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.3100887987047689,-0.3100887987047689]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5769069357406095,0.42309306425939053]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,29,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,61,128230,9,30]]</td><td>61</td><td> Private</td><td>128230</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>30</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.2530723631326024,-0.2530723631326024]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5629325691417378,0.43706743085826216]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,29,44,49,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,26,187248,9,40]]</td><td>26</td><td> Private</td><td>187248</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Not-in-family</td><td> Black</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[1.5128077382426097,-1.5128077382426097]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8194769408002279,0.180523059199772]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,29,45,48,55,94,95,96,99],[1,1,1,1,1,1,1,20,219266,9,36]]</td><td>20</td><td> Private</td><td>219266</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Own-child</td><td> White</td><td> Female</td><td>0</td><td>0</td><td>36</td><td> ?</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[1.9974152674364092,-1.9974152674364092]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8805254304185095,0.11947456958149048]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,29,47,48,53,94,95,96,97,99],[1,1,1,1,1,1,1,35,145704,9,3942,35]]</td><td>35</td><td> Private</td><td>145704</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Wife</td><td> White</td><td> Female</td><td>3942</td><td>0</td><td>35</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.11745722377527823,-0.11745722377527823]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5293305928026657,0.4706694071973343]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,29,47,48,53,94,95,96,99],[1,1,1,1,1,1,1,48,199763,9,8]]</td><td>48</td><td> Private</td><td>199763</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Wife</td><td> White</td><td> Female</td><td>0</td><td>0</td><td>8</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.4112016147160876,-0.4112016147160876]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6013759684873637,0.3986240315126362]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,29,47,49,53,94,95,96,99],[1,1,1,1,1,1,1,27,161087,9,40]]</td><td>27</td><td> Private</td><td>161087</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Wife</td><td> Black</td><td> Female</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.4871470874188163,-0.4871470874188163]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6194341291345838,0.3805658708654161]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,97,99],[1,1,1,1,1,1,1,1,20,34568,9,3781,35]]</td><td>20</td><td> Private</td><td>34568</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>3781</td><td>0</td><td>35</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7534708613258998,-0.7534708613258998]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6799345116804474,0.32006548831955256]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,97,99],[1,1,1,1,1,1,1,1,28,190836,9,3411,40]]</td><td>28</td><td> Private</td><td>190836</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>3411</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8332657020051615,-0.8332657020051615]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.697045002227209,0.3029549977727911]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,97,99],[1,1,1,1,1,1,1,1,32,400535,9,3781,40]]</td><td>32</td><td> Private</td><td>400535</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>3781</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.9561201347340096,-0.9561201347340096]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7223443193787578,0.27765568062124224]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,97,99],[1,1,1,1,1,1,1,1,36,267556,9,4064,40]]</td><td>36</td><td> Private</td><td>267556</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>4064</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8262048692824718,-0.8262048692824718]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6955518719212233,0.30444812807877675]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,97,99],[1,1,1,1,1,1,1,1,46,248059,9,3464,40]]</td><td>46</td><td> Private</td><td>248059</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>3464</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7988037411620789,-0.7988037411620789]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.689718531626417,0.3102814683735829]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,97,99],[1,1,1,1,1,1,1,1,56,235826,9,5013,40]]</td><td>56</td><td> Private</td><td>235826</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>5013</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6737413808892624,-0.6737413808892624]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6623404100945687,0.3376595899054314]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,97,99],[1,1,1,1,1,1,1,1,64,116084,9,2635,40]]</td><td>64</td><td> Private</td><td>116084</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>2635</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6647968258974029,-0.6647968258974029]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6603371042353773,0.3396628957646227]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,98,99],[1,1,1,1,1,1,1,1,34,58305,9,1573,40]]</td><td>34</td><td> Private</td><td>58305</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>1573</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.17155482451103388,-0.17155482451103388]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5427838264564497,0.45721617354355026]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,98,99],[1,1,1,1,1,1,1,1,37,193855,9,1902,50]]</td><td>37</td><td> Private</td><td>193855</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>1902</td><td>50</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.07034568578416511,-0.07034568578416511]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5175791728097471,0.482420827190253]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,98,99],[1,1,1,1,1,1,1,1,37,295949,9,1628,40]]</td><td>37</td><td> Private</td><td>295949</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>1628</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.31275974631831305,-0.31275974631831305]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5775587405746128,0.42244125942538724]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,98,99],[1,1,1,1,1,1,1,1,45,187033,9,2051,40]]</td><td>45</td><td> Private</td><td>187033</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>2051</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.009315100416321442,-0.009315100416321442]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5023287582650292,0.4976712417349708]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,98,99],[1,1,1,1,1,1,1,1,58,225394,9,1902,40]]</td><td>58</td><td> Private</td><td>225394</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>1902</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.05044420332702071,-0.05044420332702071]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5126083773201827,0.48739162267981734]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,19,187352,9,40]]</td><td>19</td><td> Private</td><td>187352</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[1.0317240591921057,-1.0317240591921057]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7372500041171216,0.2627499958828784]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,19,378114,9,25]]</td><td>19</td><td> Private</td><td>378114</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>25</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[1.2403795713624066,-1.2403795713624066]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7756300772479011,0.22436992275209888]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,20,157595,9,40]]</td><td>20</td><td> Private</td><td>157595</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[1.0052549448604073,-1.0052549448604073]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7320905081544862,0.2679094918455138]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,20,266467,9,40]]</td><td>20</td><td> Private</td><td>266467</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[1.0868884244404822,-1.0868884244404822]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7477953389228482,0.25220466107715184]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,22,112693,9,35]]</td><td>22</td><td> Private</td><td>112693</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>35</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.9851462845593166,-0.9851462845593166]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7281281573646706,0.2718718426353294]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,22,173736,9,40]]</td><td>22</td><td> Private</td><td>173736</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[1.0090437065860047,-1.0090437065860047]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7328329593797542,0.2671670406202459]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,23,119156,9,40]]</td><td>23</td><td> Private</td><td>119156</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.9639620209447299,-0.9639620209447299]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.723914366053952,0.276085633946048]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,24,32732,9,50]]</td><td>24</td><td> Private</td><td>32732</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>50</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8512566924018667,-0.8512566924018667]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7008306959210451,0.299169304078955]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,24,172612,9,40]]</td><td>24</td><td> Private</td><td>172612</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.9998869724545405,-0.9998869724545405]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7310363554854269,0.26896364451457305]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,24,223515,9,45]]</td><td>24</td><td> Private</td><td>223515</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>45</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[1.0161813056894184,-1.0161813056894184]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7342280969781179,0.2657719030218821]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,24,230475,9,44]]</td><td>24</td><td> Private</td><td>230475</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>44</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[1.0257746583466738,-1.0257746583466738]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7360959055887193,0.26390409441128077]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,24,235894,9,38]]</td><td>24</td><td> Private</td><td>235894</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>38</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[1.0560858739171117,-1.0560858739171117]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7419418404680627,0.2580581595319374]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,24,403671,9,60]]</td><td>24</td><td> Private</td><td>403671</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>60</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[1.0856443821266768,-1.0856443821266768]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7475606433710484,0.2524393566289516]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,24,418405,9,40]]</td><td>24</td><td> Private</td><td>418405</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[1.1841853948811085,-1.1841853948811085]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7656995142244214,0.23430048577557852]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,24,456367,9,40]]</td><td>24</td><td> Private</td><td>456367</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[1.212649739724767,-1.212649739724767]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7707674541332756,0.22923254586672445]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,26,88449,9,36]]</td><td>26</td><td> Private</td><td>88449</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>36</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.9459652976555374,-0.9459652976555374]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7203030433577007,0.2796969566422994]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,26,106548,9,50]]</td><td>26</td><td> Private</td><td>106548</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>50</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8982908334240767,-0.8982908334240767]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7105981417714906,0.28940185822850945]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,26,213258,9,40]]</td><td>26</td><td> Private</td><td>213258</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[1.0220498654270123,-1.0220498654270123]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7353716960327251,0.2646283039672748]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,27,138705,9,53]]</td><td>27</td><td> Private</td><td>138705</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>53</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.9051215559361085,-0.9051215559361085]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7120008457855574,0.2879991542144425]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,27,160972,9,50]]</td><td>27</td><td> Private</td><td>160972</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>50</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.9349416024832434,-0.9349416024832434]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7180767531928864,0.2819232468071135]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,27,189777,9,40]]</td><td>27</td><td> Private</td><td>189777</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[1.0002865681818427,-1.0002865681818427]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7311149176234247,0.26888508237657527]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,28,62535,9,43]]</td><td>28</td><td> Private</td><td>62535</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>43</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8875980845473507,-0.8875980845473507]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.708394252951434,0.29160574704856596]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,28,205337,9,40]]</td><td>28</td><td> Private</td><td>205337</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[1.007796662408178,-1.007796662408178]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7325887311996548,0.2674112688003452]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,28,250679,9,40]]</td><td>28</td><td> Private</td><td>250679</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[1.04179461625416,-1.04179461625416]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.739196130044236,0.260803869955764]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,28,268726,9,46]]</td><td>28</td><td> Private</td><td>268726</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>46</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[1.0290784777634672,-1.0290784777634672]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7367372005257823,0.26326279947421777]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,29,58522,9,40]]</td><td>29</td><td> Private</td><td>58522</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8935561114106298,-0.8935561114106298]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7096234836236781,0.2903765163763218]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,29,132874,9,40]]</td><td>29</td><td> Private</td><td>132874</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.9493060973917611,-0.9493060973917611]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7209756071938809,0.27902439280611907]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,29,206250,9,45]]</td><td>29</td><td> Private</td><td>206250</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>45</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.9824509448690798,-0.9824509448690798]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7275942665827577,0.2724057334172423]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,29,210498,9,40]]</td><td>29</td><td> Private</td><td>210498</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[1.0075094666595592,-1.0075094666595592]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.732532465081541,0.2674675349184589]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,29,267989,9,45]]</td><td>29</td><td> Private</td><td>267989</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>45</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[1.02874355817456,-1.02874355817456]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7366722358798589,0.2633277641201412]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,29,307812,9,60]]</td><td>29</td><td> Private</td><td>307812</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>60</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.992983334866148,-0.992983334866148]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7296767839529841,0.2703232160470159]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,30,87054,9,50]]</td><td>30</td><td> Private</td><td>87054</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>50</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8670461157229276,-0.8670461157229276]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.70413068461344,0.29586931538656]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,30,219110,9,46]]</td><td>30</td><td> Private</td><td>219110</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>46</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.9835618835045417,-0.9835618835045417]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.72781439988254,0.27218560011745985]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,30,229504,9,50]]</td><td>30</td><td> Private</td><td>229504</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>50</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.9738567664520558,-0.9738567664520558]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7258875653384441,0.2741124346615558]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,30,236770,9,40]]</td><td>30</td><td> Private</td><td>236770</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[1.0230515418659607,-1.0230515418659607]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7355665764701965,0.2644334235298034]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,31,39054,9,20]]</td><td>31</td><td> Private</td><td>39054</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>20</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.9581381246435089,-0.9581381246435089]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7227488718409595,0.27725112815904057]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,31,128567,9,40]]</td><td>31</td><td> Private</td><td>128567</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.9377627131987256,-0.9377627131987256]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7186475144612129,0.2813524855387871]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,31,162160,9,47]]</td><td>31</td><td> Private</td><td>162160</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>47</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.9323284800733103,-0.9323284800733103]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7175474447505833,0.28245255524941665]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,31,228873,9,40]]</td><td>31</td><td> Private</td><td>228873</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[1.0129733073162122,-1.0129733073162122]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7336016269680986,0.26639837303190145]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,31,236861,9,60]]</td><td>31</td><td> Private</td><td>236861</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>60</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.9314695118721859,-0.9314695118721859]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7173733224675994,0.2826266775324006]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,31,377850,9,65]]</td><td>31</td><td> Private</td><td>377850</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>65</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[1.0153113655113055,-1.0153113655113055]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7340583047019049,0.2659416952980951]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,31,402361,9,40]]</td><td>31</td><td> Private</td><td>402361</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[1.1430566079388516,-1.1430566079388516]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7582403937989062,0.24175960620109385]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,32,108256,9,40]]</td><td>32</td><td> Private</td><td>108256</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.918376318465394,-0.918376318465394]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7147111539142581,0.28528884608574184]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,32,152109,9,48]]</td><td>32</td><td> Private</td><td>152109</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>48</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.9162604870214779,-0.9162604870214779]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7142795418267971,0.2857204581732029]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,32,170017,9,50]]</td><td>32</td><td> Private</td><td>170017</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>50</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.9209387826996431,-0.9209387826996431]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7152333505247291,0.28476664947527086]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,32,207668,9,50]]</td><td>32</td><td> Private</td><td>207668</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>50</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.9491699361612255,-0.9491699361612255]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7209482148448028,0.27905178515519724]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,32,295282,9,48]]</td><td>32</td><td> Private</td><td>295282</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>48</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[1.0236132514780696,-1.0236132514780696]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.735675819243523,0.26432418075647707]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,32,391874,9,40]]</td><td>32</td><td> Private</td><td>391874</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[1.1310363615576644,-1.1310363615576644]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7560301052353551,0.24396989476464487]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,33,125856,9,40]]</td><td>33</td><td> Private</td><td>125856</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.9274160281883066,-0.9274160281883066]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7165507597085089,0.2834492402914911]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,33,136331,9,40]]</td><td>33</td><td> Private</td><td>136331</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.9352703038386233,-0.9352703038386233]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7181432915565806,0.28185670844341937]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,33,143540,9,40]]</td><td>33</td><td> Private</td><td>143540</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.9406756950713806,-0.9406756950713806]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7192361244637488,0.28076387553625115]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,33,143653,9,30]]</td><td>33</td><td> Private</td><td>143653</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>30</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.9845070686975324,-0.9845070686975324]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7280016013122114,0.2719983986877887]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,33,159929,9,40]]</td><td>33</td><td> Private</td><td>159929</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.9529643560387354,-0.9529643560387354]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7217109430296119,0.27828905697038797]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,33,170769,9,40]]</td><td>33</td><td> Private</td><td>170769</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.9610923128930966,-0.9610923128930966]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7233404510537372,0.2766595489462628]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,33,205950,9,40]]</td><td>33</td><td> Private</td><td>205950</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.9874714319053919,-0.9874714319053919]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7285881935973094,0.2714118064026906]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,33,216145,9,40]]</td><td>33</td><td> Private</td><td>216145</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.9951157603306882,-0.9951157603306882]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7300971957731454,0.26990280422685464]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,33,261511,9,40]]</td><td>33</td><td> Private</td><td>261511</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[1.0291317096531005,-1.0291317096531005]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7367475250133282,0.26325247498667176]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,33,285131,9,40]]</td><td>33</td><td> Private</td><td>285131</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[1.046842257706607,-1.046842257706607]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7401680651135716,0.2598319348864284]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,34,85374,9,40]]</td><td>34</td><td> Private</td><td>85374</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.892905185326809,-0.892905185326809]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7094893368003629,0.29051066319963714]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,34,170772,9,50]]</td><td>34</td><td> Private</td><td>170772</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>50</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.9131909444103694,-0.9131909444103694]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7136526846223774,0.28634731537762265]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,34,195860,9,40]]</td><td>34</td><td> Private</td><td>195860</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.9757488606968228,-0.9757488606968228]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7262638834763318,0.27373611652366825]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,34,198091,9,72]]</td><td>34</td><td> Private</td><td>198091</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>72</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8374324264345228,-0.8374324264345228]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6979241799328305,0.30207582006716954]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,34,424988,9,45]]</td><td>34</td><td> Private</td><td>424988</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>45</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[1.1256783517147746,-1.1256783517147746]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7550404726781846,0.24495952732181542]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,35,22463,9,40]]</td><td>35</td><td> Private</td><td>22463</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8415768199296594,-0.8415768199296594]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6987972085408382,0.30120279145916184]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,35,54159,9,38]]</td><td>35</td><td> Private</td><td>54159</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>38</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8740921747868937,-0.8740921747868937]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7055964804308049,0.294403519569195]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,35,205338,9,40]]</td><td>35</td><td> Private</td><td>205338</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.9786986012711079,-0.9786986012711079]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7268499140803197,0.2731500859196802]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,35,259846,9,55]]</td><td>35</td><td> Private</td><td>259846</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>55</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.9539493601034978,-0.9539493601034978]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7219087322294514,0.2780912677705486]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,36,111545,9,70]]</td><td>36</td><td> Private</td><td>111545</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>70</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7729746218033674,-0.7729746218033674]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6841640126112524,0.3158359873887476]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,36,144169,9,50]]</td><td>36</td><td> Private</td><td>144169</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>50</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8849297626135668,-0.8849297626135668]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7078427464471903,0.29215725355280975]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,36,183279,9,40]]</td><td>36</td><td> Private</td><td>183279</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.9580015360044346,-0.9580015360044346]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7227215009751633,0.27727849902483676]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,37,35309,9,40]]</td><td>37</td><td> Private</td><td>35309</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8428949527036773,-0.8428949527036773]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.699074575970136,0.30092542402986394]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,37,76893,9,40]]</td><td>37</td><td> Private</td><td>76893</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.8740751148652783,-0.8740751148652783]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7055929365593697,0.29440706344063033]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,37,200153,9,40]]</td><td>37</td><td> Private</td><td>200153</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.96649688256533,-0.96649688256533]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7244207018080773,0.2755792981919228]]</td><td>1</td></tr></tbody><fthfoot style="display:table-footer-group;border-spacing:0;height:0;border-collapse:collapse;"><fthtr style="display:table-row;border-spacing:0;height:0;border-collapse:collapse"><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd></fthtr></fthfoot></table></div><div style="overflow: hidden; position: absolute; margin-top: 0px; top: 0px; z-index: 1; left: 0px; width: 1385px;" aria-hidden="true" class="floatThead-floatContainer floatThead-container"><table class="table table-bordered table-condensed table-hover floatThead-table" style="margin: 0px; border-bottom-width: 0px; table-layout: fixed; width: 171.841%;"><colgroup><col style="width: 58.4px;"><col style="width: 239.2px;"><col style="width: 52px;"><col style="width: 92px;"><col style="width: 67.2px;"><col style="width: 90.4px;"><col style="width: 125.6px;"><col style="width: 117.6px;"><col style="width: 98.4px;"><col style="width: 103.2px;"><col style="width: 56px;"><col style="width: 54.4px;"><col style="width: 104px;"><col style="width: 104px;"><col style="width: 132px;"><col style="width: 121.6px;"><col style="width: 74.4px;"><col style="width: 312px;"><col style="width: 285.6px;"><col style="width: 92px;"></colgroup><thead><tr><th data-column-name="label" style="padding-right: 23px;">label</th><th data-column-name="features" style="padding-right: 23px;">features</th><th data-column-name="age" style="padding-right: 23px;">age</th><th data-column-name="workclass" style="padding-right: 23px;">workclass</th><th data-column-name="fnlwgt" style="padding-right: 23px;">fnlwgt</th><th data-column-name="education" style="padding-right: 23px;">education</th><th data-column-name="education_num" style="padding-right: 23px;">education_num</th><th data-column-name="marital_status" style="padding-right: 23px;">marital_status</th><th data-column-name="occupation" style="padding-right: 23px;">occupation</th><th data-column-name="relationship" style="padding-right: 23px;">relationship</th><th data-column-name="race" style="padding-right: 23px;">race</th><th data-column-name="sex" style="padding-right: 23px;">sex</th><th data-column-name="capital_gain" style="padding-right: 23px;">capital_gain</th><th data-column-name="capital_loss" style="padding-right: 23px;">capital_loss</th><th data-column-name="hours_per_week" style="padding-right: 23px;">hours_per_week</th><th data-column-name="native_country" style="padding-right: 23px;">native_country</th><th data-column-name="income" style="padding-right: 23px;">income</th><th data-column-name="rawPrediction" style="padding-right: 23px;">rawPrediction</th><th data-column-name="probability" style="padding-right: 23px;">probability</th><th data-column-name="prediction" style="padding-right: 23px;">prediction</th></tr></thead></table></div></div></div><p class="plotWarning">Showing the first 1000 rows.</p></div><div class="control-wrapper"><!-- plotControlsTemplate -->
<div class="plot-controls">
  
  <a class="btn btn-small display-type-button active" data-type="table" title="Raw table">
    <i class="fa fa-table"></i>
  </a>
  <div class="btn-group btn-small" style="padding-left: 4px; padding-right: 4px;">
    <a class="btn btn-small display-type-button" data-type="barChart" title="Bar chart">
      <i class="icon-db-bar"></i>
    </a><a class="btn btn-small dropdown-toggle" data-toggle="dropdown" style="padding-left: 6px; padding-right: 6px">
    <b class="caret"></b>
  </a>
    
    <div class="dropdown-menu" role="menu">
      <div class="row-fluid" style="width: 240px">
        
        <ul class="span6 multicol-menu" style="width: 80px">
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="barChart">
              <i class="icon-db-bar fa fa-fw"></i>
              Bar
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="scatterPlot">
              <i class="icon-db-scatter fa fa-fw"></i>
              Scatter
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="mapPlot">
              <i class="icon-db-map fa fa-fw"></i>
              Map
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="mgLine">
              <i class="icon-db-line fa fa-fw"></i>
              Line
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="areaChart">
              <i class="fa fa-area-chart fa fa-fw"></i>
              Area
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="pieChart">
              <i class="icon-db-pie fa fa-fw"></i>
              Pie
            </a>
          </li>
          
          
        </ul>

        
        <ul class="span6 multicol-menu" style="width: 140px">
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="quantilePlot">
              <i class="icon-db-quantile fa fa-fw"></i>
              Quantile
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="histogram">
              <i class="icon-db-histogram fa fa-fw"></i>
              Histogram
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="boxPlot">
              <i class="icon-db-boxplot fa fa-fw"></i>
              Box plot
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="qqPlot">
              <i class="icon-db-qq fa fa-fw"></i>
              Q-Q plot
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="pivotTable">
              <i class="icon-db-pivot fa fa-fw"></i>
              Pivot
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="lineChart">
              <i class="icon-db-line fa fa-fw"></i>
              Line (deprecated)
            </a>
          </li>
          
          
        </ul>

        
      </div>
      
    </div>
  </div>
  
</div><!-- downloadControlsTemplate -->
<div class="download-controls">
  
  <div class="btn-group btn-small" style="padding-left: 4px; padding-right: 4px;">
    <a class="btn btn-small results-download-preview" title="Download CSV">
      <i class="fa fa-download"></i>
    </a><a class="btn btn-small dropdown-toggle" data-toggle="dropdown" style="padding-left: 6px; padding-right: 6px">
    <b class="caret"></b>
  </a>
    <div class="dropdown-menu" role="menu">
      <div class="row-fluid" style="">
        <ul class="span12 multicol-menu">
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="results-download-preview">
              Download preview
            </a>
          </li>
          
            <li>
              <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="results-download">
                Download full results (max 1 million rows)
              </a>
            </li>
          
        </ul>
      </div>
    </div>
  </div>
  
</div></div><div style="height: 32px;"></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div><div class="command-result-stats"><span>Command took</span> <span>3.72 seconds</span> <span class="command-provenance">-- by jeffreyzhangma@gmail.com</span><span> at 12/24/2019, 1:14:41 PM</span><span title="1224-170603-cleat207"> on My Cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"><i class="fa fa-minus-square-o"></i></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298388"><i class="fa fa-link"></i>Cmd 74</a><div class="new-notebook command mainCommand command-finished cellIndex-73 cell-825169771298314-825169771298388"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-73 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-73 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>#</span><span>#</span><span>#</span><span>#</span><span>GBM</span><span> </span><span>-</span><span> </span><span>CV</span><span> </span><span>Model</span><span> </span><span>Predict</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="de947375-246a-49a2-a25c-41dd96425048" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h4>GBM - CV Model Predict</h4>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298389"><i class="fa fa-link"></i>Cmd 75</a><div class="new-notebook command mainCommand command-finished cellIndex-74 cell-825169771298314-825169771298389"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="dashboard-button dashboard-button-74 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-74 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 12px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="1"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 72px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 10px; top: 0px; height: 18.4px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">gbCvPredictions</span> <span class="cm-operator">=</span> <span class="cm-variable">gbCvModel</span>.<span class="cm-property">transform</span>(<span class="cm-variable">testData</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">display</span>(<span class="cm-variable">gbCvPredictions</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 72px;"></div><div class="CodeMirror-gutters" style="height: 85px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-fw fa-caret-right"></i>(1) Spark Jobs</p></div></div><div class="dataset-info-view"><div class=""><a class="tree-toggler"><i class="fa fa-caret-right fa-fw"></i><i class="fa fa-list-alt fa-fw"></i><span class="spacing-left">gbCvPredictions:</span><span class="spacing-left">pyspark.sql.dataframe.DataFrame = [label: double, features: udt ... 18 more fields]</span></a></div><div class="outer-most-struct"></div></div><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget ui-resizable" data-guid="b12b6171-c6e0-46af-a225-58198b363ecc" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se" style="z-index: 90; display: block;"></div><div class="widget-content dashboard"><div class="results"><div class="results-table noscroll" tabindex="-1"><div class="floatThead-wrapper" style="position: relative; clear:both;"><div class="inner"><table class="table table-bordered table-condensed table-hover" style="table-layout: fixed; min-width: 2380px;"><colgroup><col style="width: 58.4px;"><col style="width: 239.2px;"><col style="width: 52px;"><col style="width: 92px;"><col style="width: 67.2px;"><col style="width: 90.4px;"><col style="width: 125.6px;"><col style="width: 117.6px;"><col style="width: 98.4px;"><col style="width: 103.2px;"><col style="width: 56px;"><col style="width: 54.4px;"><col style="width: 104px;"><col style="width: 104px;"><col style="width: 132px;"><col style="width: 121.6px;"><col style="width: 74.4px;"><col style="width: 312px;"><col style="width: 285.6px;"><col style="width: 92px;"></colgroup><thead><tr class="size-row" style="height: 36px;"><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th><th class="floatThead-col" style="height: 35px;"></th></tr></thead><tbody><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,29,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,26,58426,9,50]]</td><td>26</td><td> Private</td><td>58426</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>50</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6261239907822065,-0.6261239907822065]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7776887549580277,0.2223112450419723]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,29,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,30,83253,9,55]]</td><td>30</td><td> Private</td><td>83253</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>55</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.579228976517955,-0.579228976517955]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.761052403965968,0.23894759603403204]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,29,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,31,62374,9,50]]</td><td>31</td><td> Private</td><td>62374</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>50</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.579228976517955,-0.579228976517955]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.761052403965968,0.23894759603403204]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,29,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,32,32732,9,50]]</td><td>32</td><td> Private</td><td>32732</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>50</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.527582412679731,-0.527582412679731]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7417654533990462,0.2582345466009538]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,29,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,39,181705,9,45]]</td><td>39</td><td> Private</td><td>181705</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>45</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.13706626043250142,-0.13706626043250142]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5681071501571155,0.43189284984288445]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,29,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,47,76612,9,50]]</td><td>47</td><td> Private</td><td>76612</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>50</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.13706626043250142,-0.13706626043250142]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5681071501571155,0.43189284984288445]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,29,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,50,81548,9,40]]</td><td>50</td><td> Private</td><td>81548</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.24374606175972935,-0.24374606175972935]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6195154630359191,0.3804845369640809]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,29,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,51,95469,9,40]]</td><td>51</td><td> Private</td><td>95469</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.24374606175972935,-0.24374606175972935]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6195154630359191,0.3804845369640809]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,29,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,60,198727,9,30]]</td><td>60</td><td> Private</td><td>198727</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>30</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.29386972644898085,-0.29386972644898085]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6428463032932863,0.3571536967067137]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,29,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,61,128230,9,30]]</td><td>61</td><td> Private</td><td>128230</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>30</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.29386972644898085,-0.29386972644898085]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6428463032932863,0.3571536967067137]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,29,44,49,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,26,187248,9,40]]</td><td>26</td><td> Private</td><td>187248</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Not-in-family</td><td> Black</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.634262214006959,-0.634262214006959]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7804900496850983,0.21950995031490173]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,29,45,48,55,94,95,96,99],[1,1,1,1,1,1,1,20,219266,9,36]]</td><td>20</td><td> Private</td><td>219266</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Own-child</td><td> White</td><td> Female</td><td>0</td><td>0</td><td>36</td><td> ?</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6843858786962105,-0.6843858786962105]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7971816400145028,0.20281835998549724]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,29,47,48,53,94,95,96,97,99],[1,1,1,1,1,1,1,35,145704,9,3942,35]]</td><td>35</td><td> Private</td><td>145704</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Wife</td><td> White</td><td> Female</td><td>3942</td><td>0</td><td>35</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.46672618416557954,-0.46672618416557954]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7177751709754785,0.2822248290245215]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,29,47,48,53,94,95,96,99],[1,1,1,1,1,1,1,48,199763,9,8]]</td><td>48</td><td> Private</td><td>199763</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Wife</td><td> White</td><td> Female</td><td>0</td><td>0</td><td>8</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.29386972644898085,-0.29386972644898085]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6428463032932863,0.3571536967067137]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,29,47,49,53,94,95,96,99],[1,1,1,1,1,1,1,27,161087,9,40]]</td><td>27</td><td> Private</td><td>161087</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Prof-specialty</td><td> Wife</td><td> Black</td><td> Female</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.634262214006959,-0.634262214006959]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7804900496850983,0.21950995031490173]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,97,99],[1,1,1,1,1,1,1,1,20,34568,9,3781,35]]</td><td>20</td><td> Private</td><td>34568</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>3781</td><td>0</td><td>35</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.46672618416557954,-0.46672618416557954]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7177751709754785,0.2822248290245215]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,97,99],[1,1,1,1,1,1,1,1,28,190836,9,3411,40]]</td><td>28</td><td> Private</td><td>190836</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>3411</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5218141669813997,-0.5218141669813997]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7395494886117862,0.26045051138821385]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,97,99],[1,1,1,1,1,1,1,1,32,400535,9,3781,40]]</td><td>32</td><td> Private</td><td>400535</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>3781</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.4166025194763281,-0.4166025194763281]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.697032191659094,0.302967808340906]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,97,99],[1,1,1,1,1,1,1,1,36,267556,9,4064,40]]</td><td>36</td><td> Private</td><td>267556</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>4064</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.026086367229098406,-0.026086367229098406]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5130402257971277,0.4869597742028723]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,97,99],[1,1,1,1,1,1,1,1,46,248059,9,3464,40]]</td><td>46</td><td> Private</td><td>248059</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>3464</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.13129801473417002,-0.13129801473417002]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5652743459254678,0.43472565407453223]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,97,99],[1,1,1,1,1,1,1,1,56,235826,9,5013,40]]</td><td>56</td><td> Private</td><td>235826</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>5013</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.026086367229098406,-0.026086367229098406]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5130402257971277,0.4869597742028723]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,97,99],[1,1,1,1,1,1,1,1,64,116084,9,2635,40]]</td><td>64</td><td> Private</td><td>116084</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>2635</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.29036029269528546,-0.29036029269528546]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6412331961638319,0.3587668038361681]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,98,99],[1,1,1,1,1,1,1,1,34,58305,9,1573,40]]</td><td>34</td><td> Private</td><td>58305</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>1573</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6808764449425151,-0.6808764449425151]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7960444405567255,0.20395555944327448]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,98,99],[1,1,1,1,1,1,1,1,37,193855,9,1902,50]]</td><td>37</td><td> Private</td><td>193855</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>1902</td><td>50</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[-0.1605359121989849,0.1605359121989849]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.42041455826383173,0.5795854417361683]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,98,99],[1,1,1,1,1,1,1,1,37,295949,9,1628,40]]</td><td>37</td><td> Private</td><td>295949</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>1628</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.29036029269528546,-0.29036029269528546]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6412331961638319,0.3587668038361681]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,98,99],[1,1,1,1,1,1,1,1,45,187033,9,2051,40]]</td><td>45</td><td> Private</td><td>187033</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>2051</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[-0.09619647244206576,0.09619647244206576]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.45204957986031874,0.5479504201396812]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,98,99],[1,1,1,1,1,1,1,1,58,225394,9,1902,40]]</td><td>58</td><td> Private</td><td>225394</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>1902</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[-0.09619647244206576,0.09619647244206576]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.45204957986031874,0.5479504201396812]]</td><td>1</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,19,187352,9,40]]</td><td>19</td><td> Private</td><td>187352</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6808764449425151,-0.6808764449425151]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7960444405567255,0.20395555944327448]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,19,378114,9,25]]</td><td>19</td><td> Private</td><td>378114</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>25</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7310001096317665,-0.7310001096317665]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.811838412489659,0.18816158751034096]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,20,157595,9,40]]</td><td>20</td><td> Private</td><td>157595</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6808764449425151,-0.6808764449425151]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7960444405567255,0.20395555944327448]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,20,266467,9,40]]</td><td>20</td><td> Private</td><td>266467</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6808764449425151,-0.6808764449425151]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7960444405567255,0.20395555944327448]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,22,112693,9,35]]</td><td>22</td><td> Private</td><td>112693</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>35</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7310001096317665,-0.7310001096317665]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.811838412489659,0.18816158751034096]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,22,173736,9,40]]</td><td>22</td><td> Private</td><td>173736</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6808764449425151,-0.6808764449425151]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7960444405567255,0.20395555944327448]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,23,119156,9,40]]</td><td>23</td><td> Private</td><td>119156</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6808764449425151,-0.6808764449425151]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7960444405567255,0.20395555944327448]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,24,32732,9,50]]</td><td>24</td><td> Private</td><td>32732</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>50</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6727382217177625,-0.6727382217177625]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7933890980393711,0.20661090196062892]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,24,172612,9,40]]</td><td>24</td><td> Private</td><td>172612</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6808764449425151,-0.6808764449425151]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7960444405567255,0.20395555944327448]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,24,223515,9,45]]</td><td>24</td><td> Private</td><td>223515</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>45</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6727382217177625,-0.6727382217177625]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7933890980393711,0.20661090196062892]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,24,230475,9,44]]</td><td>24</td><td> Private</td><td>230475</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>44</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6727382217177625,-0.6727382217177625]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7933890980393711,0.20661090196062892]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,24,235894,9,38]]</td><td>24</td><td> Private</td><td>235894</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>38</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7310001096317665,-0.7310001096317665]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.811838412489659,0.18816158751034096]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,24,403671,9,60]]</td><td>24</td><td> Private</td><td>403671</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>60</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6727382217177625,-0.6727382217177625]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7933890980393711,0.20661090196062892]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,24,418405,9,40]]</td><td>24</td><td> Private</td><td>418405</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6808764449425151,-0.6808764449425151]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7960444405567255,0.20395555944327448]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,24,456367,9,40]]</td><td>24</td><td> Private</td><td>456367</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6808764449425151,-0.6808764449425151]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7960444405567255,0.20395555944327448]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,26,88449,9,36]]</td><td>26</td><td> Private</td><td>88449</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>36</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7310001096317665,-0.7310001096317665]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.811838412489659,0.18816158751034096]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,26,106548,9,50]]</td><td>26</td><td> Private</td><td>106548</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>50</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6727382217177625,-0.6727382217177625]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7933890980393711,0.20661090196062892]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,26,213258,9,40]]</td><td>26</td><td> Private</td><td>213258</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6808764449425151,-0.6808764449425151]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7960444405567255,0.20395555944327448]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,27,138705,9,53]]</td><td>27</td><td> Private</td><td>138705</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>53</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6727382217177625,-0.6727382217177625]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7933890980393711,0.20661090196062892]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,27,160972,9,50]]</td><td>27</td><td> Private</td><td>160972</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>50</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6727382217177625,-0.6727382217177625]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7933890980393711,0.20661090196062892]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,27,189777,9,40]]</td><td>27</td><td> Private</td><td>189777</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6808764449425151,-0.6808764449425151]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7960444405567255,0.20395555944327448]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,28,62535,9,43]]</td><td>28</td><td> Private</td><td>62535</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>43</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6727382217177625,-0.6727382217177625]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7933890980393711,0.20661090196062892]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,28,205337,9,40]]</td><td>28</td><td> Private</td><td>205337</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6808764449425151,-0.6808764449425151]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7960444405567255,0.20395555944327448]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,28,250679,9,40]]</td><td>28</td><td> Private</td><td>250679</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6808764449425151,-0.6808764449425151]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7960444405567255,0.20395555944327448]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,28,268726,9,46]]</td><td>28</td><td> Private</td><td>268726</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>46</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6727382217177625,-0.6727382217177625]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7933890980393711,0.20661090196062892]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,29,58522,9,40]]</td><td>29</td><td> Private</td><td>58522</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6808764449425151,-0.6808764449425151]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7960444405567255,0.20395555944327448]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,29,132874,9,40]]</td><td>29</td><td> Private</td><td>132874</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6808764449425151,-0.6808764449425151]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7960444405567255,0.20395555944327448]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,29,206250,9,45]]</td><td>29</td><td> Private</td><td>206250</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>45</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6727382217177625,-0.6727382217177625]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7933890980393711,0.20661090196062892]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,29,210498,9,40]]</td><td>29</td><td> Private</td><td>210498</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6808764449425151,-0.6808764449425151]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7960444405567255,0.20395555944327448]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,29,267989,9,45]]</td><td>29</td><td> Private</td><td>267989</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>45</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6727382217177625,-0.6727382217177625]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7933890980393711,0.20661090196062892]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,29,307812,9,60]]</td><td>29</td><td> Private</td><td>307812</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>60</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6727382217177625,-0.6727382217177625]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7933890980393711,0.20661090196062892]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,30,87054,9,50]]</td><td>30</td><td> Private</td><td>87054</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>50</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6258432074535111,-0.6258432074535111]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7775916511453718,0.22240834885462824]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,30,219110,9,46]]</td><td>30</td><td> Private</td><td>219110</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>46</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6258432074535111,-0.6258432074535111]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7775916511453718,0.22240834885462824]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,30,229504,9,50]]</td><td>30</td><td> Private</td><td>229504</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>50</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6258432074535111,-0.6258432074535111]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7775916511453718,0.22240834885462824]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,30,236770,9,40]]</td><td>30</td><td> Private</td><td>236770</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6808764449425151,-0.6808764449425151]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7960444405567255,0.20395555944327448]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,31,39054,9,20]]</td><td>31</td><td> Private</td><td>39054</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>20</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7310001096317665,-0.7310001096317665]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.811838412489659,0.18816158751034096]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,31,128567,9,40]]</td><td>31</td><td> Private</td><td>128567</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6808764449425151,-0.6808764449425151]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7960444405567255,0.20395555944327448]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,31,162160,9,47]]</td><td>31</td><td> Private</td><td>162160</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>47</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6258432074535111,-0.6258432074535111]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7775916511453718,0.22240834885462824]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,31,228873,9,40]]</td><td>31</td><td> Private</td><td>228873</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6808764449425151,-0.6808764449425151]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7960444405567255,0.20395555944327448]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,31,236861,9,60]]</td><td>31</td><td> Private</td><td>236861</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>60</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6258432074535111,-0.6258432074535111]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7775916511453718,0.22240834885462824]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,31,377850,9,65]]</td><td>31</td><td> Private</td><td>377850</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>65</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6258432074535111,-0.6258432074535111]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7775916511453718,0.22240834885462824]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,31,402361,9,40]]</td><td>31</td><td> Private</td><td>402361</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6808764449425151,-0.6808764449425151]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7960444405567255,0.20395555944327448]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,32,108256,9,40]]</td><td>32</td><td> Private</td><td>108256</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6808764449425151,-0.6808764449425151]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7960444405567255,0.20395555944327448]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,32,152109,9,48]]</td><td>32</td><td> Private</td><td>152109</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>48</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5741966436152871,-0.5741966436152871]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7592173219459192,0.24078267805408082]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,32,170017,9,50]]</td><td>32</td><td> Private</td><td>170017</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>50</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5741966436152871,-0.5741966436152871]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7592173219459192,0.24078267805408082]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,32,207668,9,50]]</td><td>32</td><td> Private</td><td>207668</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>50</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5741966436152871,-0.5741966436152871]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7592173219459192,0.24078267805408082]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,32,295282,9,48]]</td><td>32</td><td> Private</td><td>295282</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>48</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5741966436152871,-0.5741966436152871]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7592173219459192,0.24078267805408082]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,32,391874,9,40]]</td><td>32</td><td> Private</td><td>391874</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6808764449425151,-0.6808764449425151]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7960444405567255,0.20395555944327448]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,33,125856,9,40]]</td><td>33</td><td> Private</td><td>125856</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6808764449425151,-0.6808764449425151]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7960444405567255,0.20395555944327448]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,33,136331,9,40]]</td><td>33</td><td> Private</td><td>136331</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6808764449425151,-0.6808764449425151]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7960444405567255,0.20395555944327448]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,33,143540,9,40]]</td><td>33</td><td> Private</td><td>143540</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6808764449425151,-0.6808764449425151]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7960444405567255,0.20395555944327448]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,33,143653,9,30]]</td><td>33</td><td> Private</td><td>143653</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>30</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7310001096317665,-0.7310001096317665]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.811838412489659,0.18816158751034096]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,33,159929,9,40]]</td><td>33</td><td> Private</td><td>159929</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6808764449425151,-0.6808764449425151]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7960444405567255,0.20395555944327448]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,33,170769,9,40]]</td><td>33</td><td> Private</td><td>170769</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6808764449425151,-0.6808764449425151]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7960444405567255,0.20395555944327448]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,33,205950,9,40]]</td><td>33</td><td> Private</td><td>205950</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6808764449425151,-0.6808764449425151]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7960444405567255,0.20395555944327448]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,33,216145,9,40]]</td><td>33</td><td> Private</td><td>216145</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6808764449425151,-0.6808764449425151]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7960444405567255,0.20395555944327448]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,33,261511,9,40]]</td><td>33</td><td> Private</td><td>261511</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6808764449425151,-0.6808764449425151]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7960444405567255,0.20395555944327448]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,33,285131,9,40]]</td><td>33</td><td> Private</td><td>285131</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6808764449425151,-0.6808764449425151]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7960444405567255,0.20395555944327448]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,34,85374,9,40]]</td><td>34</td><td> Private</td><td>85374</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6808764449425151,-0.6808764449425151]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7960444405567255,0.20395555944327448]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,34,170772,9,50]]</td><td>34</td><td> Private</td><td>170772</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>50</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5741966436152871,-0.5741966436152871]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7592173219459192,0.24078267805408082]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,34,195860,9,40]]</td><td>34</td><td> Private</td><td>195860</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6808764449425151,-0.6808764449425151]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7960444405567255,0.20395555944327448]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,34,198091,9,72]]</td><td>34</td><td> Private</td><td>198091</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>72</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5741966436152871,-0.5741966436152871]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7592173219459192,0.24078267805408082]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,34,424988,9,45]]</td><td>34</td><td> Private</td><td>424988</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>45</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5741966436152871,-0.5741966436152871]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7592173219459192,0.24078267805408082]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,35,22463,9,40]]</td><td>35</td><td> Private</td><td>22463</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6808764449425151,-0.6808764449425151]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7960444405567255,0.20395555944327448]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,35,54159,9,38]]</td><td>35</td><td> Private</td><td>54159</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>38</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7310001096317665,-0.7310001096317665]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.811838412489659,0.18816158751034096]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,35,205338,9,40]]</td><td>35</td><td> Private</td><td>205338</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6808764449425151,-0.6808764449425151]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7960444405567255,0.20395555944327448]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,35,259846,9,55]]</td><td>35</td><td> Private</td><td>259846</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>55</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5741966436152871,-0.5741966436152871]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.7592173219459192,0.24078267805408082]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,36,111545,9,70]]</td><td>36</td><td> Private</td><td>111545</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>70</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.18368049136805753,-0.18368049136805753]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5908211452441715,0.4091788547558285]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,36,144169,9,50]]</td><td>36</td><td> Private</td><td>144169</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>50</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.18368049136805753,-0.18368049136805753]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.5908211452441715,0.4091788547558285]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,36,183279,9,40]]</td><td>36</td><td> Private</td><td>183279</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.29036029269528546,-0.29036029269528546]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6412331961638319,0.3587668038361681]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,37,35309,9,40]]</td><td>37</td><td> Private</td><td>35309</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.29036029269528546,-0.29036029269528546]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6412331961638319,0.3587668038361681]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,37,76893,9,40]]</td><td>37</td><td> Private</td><td>76893</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.29036029269528546,-0.29036029269528546]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6412331961638319,0.3587668038361681]]</td><td>0</td></tr><tr><td>0</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[0,100,[0,8,23,30,43,48,52,53,94,95,96,99],[1,1,1,1,1,1,1,1,37,200153,9,40]]</td><td>37</td><td> Private</td><td>200153</td><td> HS-grad</td><td>9</td><td> Married-civ-spouse</td><td> Craft-repair</td><td> Husband</td><td> White</td><td> Male</td><td>0</td><td>0</td><td>40</td><td> United-States</td><td> &lt;=50K</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.29036029269528546,-0.29036029269528546]]</td><td class="nestify nestify-expandable"><i class="nestify-expand fa fa-caret-right"></i>[1,2,[],[0.6412331961638319,0.3587668038361681]]</td><td>0</td></tr></tbody><fthfoot style="display:table-footer-group;border-spacing:0;height:0;border-collapse:collapse;"><fthtr style="display:table-row;border-spacing:0;height:0;border-collapse:collapse"><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd><fthtd style="display:table-cell;height:0;width:auto;"></fthtd></fthtr></fthfoot></table></div><div style="overflow: hidden; position: absolute; margin-top: 0px; top: 0px; z-index: 1; left: 0px; width: 1385px;" aria-hidden="true" class="floatThead-floatContainer floatThead-container"><table class="table table-bordered table-condensed table-hover floatThead-table" style="margin: 0px; border-bottom-width: 0px; table-layout: fixed; width: 171.841%;"><colgroup><col style="width: 58.4px;"><col style="width: 239.2px;"><col style="width: 52px;"><col style="width: 92px;"><col style="width: 67.2px;"><col style="width: 90.4px;"><col style="width: 125.6px;"><col style="width: 117.6px;"><col style="width: 98.4px;"><col style="width: 103.2px;"><col style="width: 56px;"><col style="width: 54.4px;"><col style="width: 104px;"><col style="width: 104px;"><col style="width: 132px;"><col style="width: 121.6px;"><col style="width: 74.4px;"><col style="width: 312px;"><col style="width: 285.6px;"><col style="width: 92px;"></colgroup><thead><tr><th data-column-name="label" style="padding-right: 23px;">label</th><th data-column-name="features" style="padding-right: 23px;">features</th><th data-column-name="age" style="padding-right: 23px;">age</th><th data-column-name="workclass" style="padding-right: 23px;">workclass</th><th data-column-name="fnlwgt" style="padding-right: 23px;">fnlwgt</th><th data-column-name="education" style="padding-right: 23px;">education</th><th data-column-name="education_num" style="padding-right: 23px;">education_num</th><th data-column-name="marital_status" style="padding-right: 23px;">marital_status</th><th data-column-name="occupation" style="padding-right: 23px;">occupation</th><th data-column-name="relationship" style="padding-right: 23px;">relationship</th><th data-column-name="race" style="padding-right: 23px;">race</th><th data-column-name="sex" style="padding-right: 23px;">sex</th><th data-column-name="capital_gain" style="padding-right: 23px;">capital_gain</th><th data-column-name="capital_loss" style="padding-right: 23px;">capital_loss</th><th data-column-name="hours_per_week" style="padding-right: 23px;">hours_per_week</th><th data-column-name="native_country" style="padding-right: 23px;">native_country</th><th data-column-name="income" style="padding-right: 23px;">income</th><th data-column-name="rawPrediction" style="padding-right: 23px;">rawPrediction</th><th data-column-name="probability" style="padding-right: 23px;">probability</th><th data-column-name="prediction" style="padding-right: 23px;">prediction</th></tr></thead></table></div></div></div><p class="plotWarning">Showing the first 1000 rows.</p></div><div class="control-wrapper"><!-- plotControlsTemplate -->
<div class="plot-controls">
  
  <a class="btn btn-small display-type-button active" data-type="table" title="Raw table">
    <i class="fa fa-table"></i>
  </a>
  <div class="btn-group btn-small" style="padding-left: 4px; padding-right: 4px;">
    <a class="btn btn-small display-type-button" data-type="barChart" title="Bar chart">
      <i class="icon-db-bar"></i>
    </a><a class="btn btn-small dropdown-toggle" data-toggle="dropdown" style="padding-left: 6px; padding-right: 6px">
    <b class="caret"></b>
  </a>
    
    <div class="dropdown-menu" role="menu">
      <div class="row-fluid" style="width: 240px">
        
        <ul class="span6 multicol-menu" style="width: 80px">
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="barChart">
              <i class="icon-db-bar fa fa-fw"></i>
              Bar
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="scatterPlot">
              <i class="icon-db-scatter fa fa-fw"></i>
              Scatter
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="mapPlot">
              <i class="icon-db-map fa fa-fw"></i>
              Map
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="mgLine">
              <i class="icon-db-line fa fa-fw"></i>
              Line
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="areaChart">
              <i class="fa fa-area-chart fa fa-fw"></i>
              Area
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="pieChart">
              <i class="icon-db-pie fa fa-fw"></i>
              Pie
            </a>
          </li>
          
          
        </ul>

        
        <ul class="span6 multicol-menu" style="width: 140px">
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="quantilePlot">
              <i class="icon-db-quantile fa fa-fw"></i>
              Quantile
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="histogram">
              <i class="icon-db-histogram fa fa-fw"></i>
              Histogram
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="boxPlot">
              <i class="icon-db-boxplot fa fa-fw"></i>
              Box plot
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="qqPlot">
              <i class="icon-db-qq fa fa-fw"></i>
              Q-Q plot
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="pivotTable">
              <i class="icon-db-pivot fa fa-fw"></i>
              Pivot
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="lineChart">
              <i class="icon-db-line fa fa-fw"></i>
              Line (deprecated)
            </a>
          </li>
          
          
        </ul>

        
      </div>
      
    </div>
  </div>
  
</div><!-- downloadControlsTemplate -->
<div class="download-controls">
  
  <div class="btn-group btn-small" style="padding-left: 4px; padding-right: 4px;">
    <a class="btn btn-small results-download-preview" title="Download CSV">
      <i class="fa fa-download"></i>
    </a><a class="btn btn-small dropdown-toggle" data-toggle="dropdown" style="padding-left: 6px; padding-right: 6px">
    <b class="caret"></b>
  </a>
    <div class="dropdown-menu" role="menu">
      <div class="row-fluid" style="">
        <ul class="span12 multicol-menu">
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="results-download-preview">
              Download preview
            </a>
          </li>
          
            <li>
              <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="results-download">
                Download full results (max 1 million rows)
              </a>
            </li>
          
        </ul>
      </div>
    </div>
  </div>
  
</div></div><div style="height: 32px;"></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div><div class="command-result-stats"><span>Command took</span> <span>3.40 seconds</span> <span class="command-provenance">-- by jeffreyzhangma@gmail.com</span><span> at 12/24/2019, 1:14:49 PM</span><span title="1224-170603-cleat207"> on My Cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"><i class="fa fa-minus-square-o"></i></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298390"><i class="fa fa-link"></i>Cmd 76</a><div class="new-notebook command mainCommand command-finished cellIndex-75 cell-825169771298314-825169771298390"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-75 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-75 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>#</span><span>#</span><span>#</span><span>#</span><span>Logistic</span><span> </span><span>Regression</span><span> </span><span>-</span><span> </span><span>CV</span><span> </span><span>Model</span><span> </span><span>Evaluate</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="c5af64af-64e2-4fe6-b9e0-16b19b8a0191" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h4>Logistic Regression - CV Model Evaluate</h4>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298391"><i class="fa fa-link"></i>Cmd 77</a><div class="new-notebook command mainCommand command-finished cellIndex-76 cell-825169771298314-825169771298391"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="edit-button edit-button-76 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 12px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="1"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 35px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 10px; top: 0px; height: 18.4px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">print_performance_metrics</span>(<span class="cm-variable">lrCvPredictions</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 35px;"></div><div class="CodeMirror-gutters" style="height: 48px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-fw fa-caret-right"></i>(17) Spark Jobs</p></div></div><div class="results"><div class="ansiout">auc = 0.8857251239148407
aupr = 0.7241684115655654
Area under PR = 0.5010764347874727
Area under ROC = 0.798374810188236
Accuracy = 0.773423840378484
DenseMatrix([[5508., 1840.],
             [ 363., 2012.]])
F1 = 0.7876369354932344
Precision = 0.8365938991668678
Recall = 0.773423840378484
FPR = 0.17667422000201208
TPR = 0.773423840378484
</div></div><div class="command-result-stats"><span>Command took</span> <span>14.34 seconds</span> <span class="command-provenance">-- by jeffreyzhangma@gmail.com</span><span> at 12/24/2019, 1:14:56 PM</span><span title="1224-170603-cleat207"> on My Cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"><i class="fa fa-minus-square-o"></i></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298392"><i class="fa fa-link"></i>Cmd 78</a><div class="new-notebook command mainCommand command-finished cellIndex-77 cell-825169771298314-825169771298392"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-77 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-77 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>#</span><span>#</span><span>#</span><span>#</span><span>GBM</span><span> </span><span>-</span><span> </span><span>CV</span><span> </span><span>Model</span><span> </span><span>Evaluate</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="ecb546d4-e38a-4fd9-9d7c-98633a768a06" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h4>GBM - CV Model Evaluate</h4>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298393"><i class="fa fa-link"></i>Cmd 79</a><div class="new-notebook command mainCommand command-finished cellIndex-78 cell-825169771298314-825169771298393"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="edit-button edit-button-78 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-variable">print_performance_metrics</span><span>(</span><span class="cm-variable">gbCvPredictions</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-fw fa-caret-right"></i>(17) Spark Jobs</p></div></div><div class="results"><div class="ansiout">auc = 0.8971935363722316
aupr = 0.7643217889056158
Area under PR = 0.6463576078807106
Area under ROC = 0.7461873477924533
Accuracy = 0.8480921526277898
DenseMatrix([[6947.,  401.],
             [1076., 1299.]])
F1 = 0.8388462581029346
Precision = 0.8410271157015711
Recall = 0.8480921526277898
FPR = 0.35571745704288305
TPR = 0.8480921526277898
</div></div><div class="command-result-stats"><span>Command took</span> <span>12.20 seconds</span> <span class="command-provenance">-- by jeffreyzhangma@gmail.com</span><span> at 12/24/2019, 1:15:14 PM</span><span title="1224-170603-cleat207"> on My Cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"><i class="fa fa-minus-square-o"></i></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298394"><i class="fa fa-link"></i>Cmd 80</a><div class="new-notebook command mainCommand command-finished cellIndex-79 cell-825169771298314-825169771298394"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-79 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-79 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>#</span><span>#</span><span>#</span><span>#</span><span>Logistic</span><span> </span><span>Regression</span><span> </span><span>-</span><span> </span><span>Model</span><span> </span><span>Explore</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="56b3c716-3029-466f-a003-6a04d1a438d2" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h4>Logistic Regression - Model Explore</h4>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298395"><i class="fa fa-link"></i>Cmd 81</a><div class="new-notebook command mainCommand command-finished cellIndex-80 cell-825169771298314-825169771298395"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="edit-button edit-button-80 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-builtin">print</span><span>(</span><span class="cm-string">'Model Intercept: '</span><span>,</span><span> </span><span class="cm-variable">lrCvModel</span><span>.</span><span class="cm-property">bestModel</span><span>.</span><span class="cm-property">intercept</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="results"><div class="ansiout">Model Intercept:  -1.247913441799743
</div></div><div class="command-result-stats"><span>Command took</span> <span>0.02 seconds</span> <span class="command-provenance">-- by jeffreyzhangma@gmail.com</span><span> at 12/24/2019, 1:15:29 PM</span><span title="1224-170603-cleat207"> on My Cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298396"><i class="fa fa-link"></i>Cmd 82</a><div class="new-notebook command mainCommand command-finished cellIndex-81 cell-825169771298314-825169771298396"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="dashboard-button dashboard-button-81 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-81 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 12px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="1"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 90px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 10px; top: 0px; height: 18.4px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">lrWeights</span> <span class="cm-operator">=</span> <span class="cm-variable">lrCvModel</span>.<span class="cm-property">bestModel</span>.<span class="cm-property">coefficients</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">lrWeights</span> <span class="cm-operator">=</span> [(<span class="cm-builtin">float</span>(<span class="cm-variable">w</span>),) <span class="cm-keyword">for</span> <span class="cm-variable">w</span> <span class="cm-keyword">in</span> <span class="cm-variable">lrWeights</span>] &nbsp;<span class="cm-comment"># convert numpy type to float, and to tuple</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">lrWeightsDF</span> <span class="cm-operator">=</span> <span class="cm-variable">sqlContext</span>.<span class="cm-property">createDataFrame</span>(<span class="cm-variable">lrWeights</span>, [<span class="cm-string">"Feature Weight"</span>])</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">display</span>(<span class="cm-variable">lrWeightsDF</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 90px;"></div><div class="CodeMirror-gutters" style="height: 103px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-fw fa-caret-right"></i>(3) Spark Jobs</p></div></div><div class="dataset-info-view"><div class=""><a class="tree-toggler"><i class="fa fa-caret-right fa-fw"></i><i class="fa fa-list-alt fa-fw"></i><span class="spacing-left">lrWeightsDF:</span><span class="spacing-left">pyspark.sql.dataframe.DataFrame = [Feature Weight: double]</span></a></div><div class="outer-most-struct"></div></div><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget ui-resizable" data-guid="c8999bd6-2133-45f1-a2be-12b33c20de76" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se" style="z-index: 90; display: block;"></div><div class="widget-content dashboard"><div class="results"><div class="results-table noscroll" tabindex="-1"><div class="floatThead-wrapper" style="position: relative; clear:both;"><div class="inner"><table class="table table-bordered table-condensed table-hover" style="table-layout: fixed; min-width: 1384px;"><colgroup><col style="width: 1384px;"></colgroup><thead><tr class="size-row" style="height: 18px;"><th class="floatThead-col" style="height: 17px;"></th></tr></thead><tbody><tr><td>-0.22413336981436774</td></tr><tr><td>-0.3455553822296018</td></tr><tr><td>-0.13203533849479424</td></tr><tr><td>-0.4680986801474529</td></tr><tr><td>-0.24553588692884637</td></tr><tr><td>0.43228384563178</td></tr><tr><td>0.4075811047761166</td></tr><tr><td>-1.159748876366615</td></tr><tr><td>-0.4380095204656964</td></tr><tr><td>-0.19291567917419333</td></tr><tr><td>0.44057901085127404</td></tr><tr><td>0.8010313520657025</td></tr><tr><td>-0.06184804343502925</td></tr><tr><td>-0.6362002864270917</td></tr><tr><td>-0.04723760168375637</td></tr><tr><td>-0.6577699123771692</td></tr><tr><td>-0.9051719166934321</td></tr><tr><td>1.2097502743922959</td></tr><tr><td>-0.8060890483753571</td></tr><tr><td>-0.5385350858042632</td></tr><tr><td>1.2251375510421643</td></tr><tr><td>-0.796892530719512</td></tr><tr><td>-0.8210515525985117</td></tr><tr><td>0.643512484716488</td></tr><tr><td>-0.7775786378567093</td></tr><tr><td>-0.40766858012217727</td></tr><tr><td>-0.466421954303193</td></tr><tr><td>-0.3051117149736568</td></tr><tr><td>-0.43822873683930746</td></tr><tr><td>0.4096262092779579</td></tr><tr><td>-0.19384890945158545</td></tr><tr><td>0.6645505603678841</td></tr><tr><td>-0.25811489553061495</td></tr><tr><td>0.09499069986310053</td></tr><tr><td>-0.6732046465594632</td></tr><tr><td>-0.4729836968388401</td></tr><tr><td>-0.4699534828918116</td></tr><tr><td>-0.3056968192868742</td></tr><tr><td>-0.6782282304063623</td></tr><tr><td>-0.7430429605688853</td></tr><tr><td>0.31718129148346436</td></tr><tr><td>0.20355382329040855</td></tr><tr><td>-0.7377453081669949</td></tr><tr><td>0.5382320714706103</td></tr><tr><td>-0.4178655037726627</td></tr><tr><td>-0.7451284478609003</td></tr><tr><td>-0.5218005248666443</td></tr><tr><td>0.7589803243394615</td></tr><tr><td>-0.22757247429077593</td></tr><tr><td>-0.385210488174003</td></tr><tr><td>-0.37635121344167555</td></tr><tr><td>-0.6145559968346481</td></tr><tr><td>0.17495796940155287</td></tr><tr><td>-0.39398123211347963</td></tr><tr><td>-0.8322622703281153</td></tr><tr><td>-0.4675579005938502</td></tr><tr><td>-0.06427790678087629</td></tr><tr><td>0.008191202924590106</td></tr><tr><td>-0.008477188794048572</td></tr><tr><td>-0.5967255493435729</td></tr><tr><td>-0.6228859751499788</td></tr><tr><td>-0.374260675572393</td></tr><tr><td>-0.11537871743977483</td></tr><tr><td>-0.14810631123098406</td></tr><tr><td>-0.26279825287839254</td></tr><tr><td>-0.7465534229906876</td></tr><tr><td>-0.9719411515722386</td></tr><tr><td>-0.05696215448403663</td></tr><tr><td>-0.8646429040566657</td></tr><tr><td>-0.9330669988255139</td></tr><tr><td>-0.5882573982342706</td></tr><tr><td>0.08105795516566225</td></tr><tr><td>-0.5668513757165377</td></tr><tr><td>-1.1404752258890554</td></tr><tr><td>-0.27871465351808317</td></tr><tr><td>-0.6112315892203539</td></tr><tr><td>0.002611785243947157</td></tr><tr><td>-0.3087034875218959</td></tr><tr><td>-0.9708062525888738</td></tr><tr><td>-0.8441931751406039</td></tr><tr><td>0.24808195766129623</td></tr><tr><td>-0.8397553890126919</td></tr><tr><td>-0.7953933445719499</td></tr><tr><td>-0.20064341444695036</td></tr><tr><td>-0.15113626009820005</td></tr><tr><td>-0.48708303634410177</td></tr><tr><td>0.34442988461020135</td></tr><tr><td>-0.5636169728170162</td></tr><tr><td>-0.7724214785329083</td></tr><tr><td>-0.1664461596012903</td></tr><tr><td>-0.9644832513818281</td></tr><tr><td>-0.6189447744059106</td></tr><tr><td>-1.0343843305032483</td></tr><tr><td>0.03767878990569867</td></tr><tr><td>0.004156972992655434</td></tr><tr><td>-7.498115179299983e-7</td></tr><tr><td>0.024837998233684086</td></tr><tr><td>0.0000479794616187375</td></tr><tr><td>0.0004456794105765595</td></tr><tr><td>0.004374664492462556</td></tr></tbody><fthfoot style="display:table-footer-group;border-spacing:0;height:0;border-collapse:collapse;"><fthtr style="display:table-row;border-spacing:0;height:0;border-collapse:collapse"><fthtd style="display:table-cell;height:0;width:auto;"></fthtd></fthtr></fthfoot></table></div><div style="overflow: hidden; position: absolute; margin-top: 0px; top: 0px; z-index: 1; left: 0px; width: 1385px;" aria-hidden="true" class="floatThead-floatContainer floatThead-container"><table class="table table-bordered table-condensed table-hover floatThead-table" style="margin: 0px; border-bottom-width: 0px; table-layout: fixed; width: 99.9278%;"><colgroup><col style="width: 1384px;"></colgroup><thead><tr><th data-column-name="Feature Weight" style="padding-right: 23px;">Feature Weight</th></tr></thead></table></div></div></div></div><div class="control-wrapper"><!-- plotControlsTemplate -->
<div class="plot-controls">
  
  <a class="btn btn-small display-type-button active" data-type="table" title="Raw table">
    <i class="fa fa-table"></i>
  </a>
  <div class="btn-group btn-small" style="padding-left: 4px; padding-right: 4px;">
    <a class="btn btn-small display-type-button" data-type="barChart" title="Bar chart">
      <i class="icon-db-bar"></i>
    </a><a class="btn btn-small dropdown-toggle" data-toggle="dropdown" style="padding-left: 6px; padding-right: 6px">
    <b class="caret"></b>
  </a>
    
    <div class="dropdown-menu" role="menu">
      <div class="row-fluid" style="width: 240px">
        
        <ul class="span6 multicol-menu" style="width: 80px">
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="barChart">
              <i class="icon-db-bar fa fa-fw"></i>
              Bar
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="scatterPlot">
              <i class="icon-db-scatter fa fa-fw"></i>
              Scatter
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="mapPlot">
              <i class="icon-db-map fa fa-fw"></i>
              Map
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="mgLine">
              <i class="icon-db-line fa fa-fw"></i>
              Line
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="areaChart">
              <i class="fa fa-area-chart fa fa-fw"></i>
              Area
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="pieChart">
              <i class="icon-db-pie fa fa-fw"></i>
              Pie
            </a>
          </li>
          
          
        </ul>

        
        <ul class="span6 multicol-menu" style="width: 140px">
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="quantilePlot">
              <i class="icon-db-quantile fa fa-fw"></i>
              Quantile
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="histogram">
              <i class="icon-db-histogram fa fa-fw"></i>
              Histogram
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="boxPlot">
              <i class="icon-db-boxplot fa fa-fw"></i>
              Box plot
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="qqPlot">
              <i class="icon-db-qq fa fa-fw"></i>
              Q-Q plot
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="pivotTable">
              <i class="icon-db-pivot fa fa-fw"></i>
              Pivot
            </a>
          </li>
          
          <li>
            <a href="https://community.cloud.databricks.com/?o=2015575843351761#" class="display-type-button" data-type="lineChart">
              <i class="icon-db-line fa fa-fw"></i>
              Line (deprecated)
            </a>
          </li>
          
          
        </ul>

        
      </div>
      
    </div>
  </div>
  
</div><!-- downloadControlsTemplate -->
<div class="download-controls">
  
  <a class="btn btn-small results-download-preview" title="Download CSV">
    <i class="fa fa-download"></i>
  </a>
  
</div></div><div style="height: 32px;"></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div><div class="command-result-stats"><span>Command took</span> <span>0.39 seconds</span> <span class="command-provenance">-- by jeffreyzhangma@gmail.com</span><span> at 12/24/2019, 1:15:31 PM</span><span title="1224-170603-cleat207"> on My Cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"><i class="fa fa-minus-square-o"></i></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298397"><i class="fa fa-link"></i>Cmd 83</a><div class="new-notebook command mainCommand command-finished cellIndex-82 cell-825169771298314-825169771298397"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-82 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-82 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-header header-3">### </span><span class="cm-header header-3">Feature</span><span class="cm-header header-3"> </span><span class="cm-header header-3">Importance</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="a807fcb7-926e-4481-9bb6-0f8cedadef6c" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h3>Feature Importance</h3>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"><i class="fa fa-minus-square-o"></i></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298398"><i class="fa fa-link"></i>Cmd 84</a><div class="new-notebook command mainCommand command-finished cellIndex-83 cell-825169771298314-825169771298398"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-83 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-83 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>#</span><span>#</span><span>#</span><span>#</span><span class="cm-tag bracket">&lt;</span><span class="cm-tag">span</span><span> </span><span class="cm-attribute">style</span><span>=</span><span class="cm-string">"color:darkblue"</span><span class="cm-tag bracket">&gt;</span><span>Question 8</span><span class="cm-tag bracket">&lt;/</span><span class="cm-tag">span</span><span class="cm-tag bracket">&gt;</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span class="cm-variable-2">1. </span><span class="cm-variable-2">Print</span><span class="cm-variable-2"></span><span class="cm-variable-2"> </span><span class="cm-variable-2">out</span><span class="cm-variable-2"> </span><span class="cm-variable-2">a</span><span class="cm-variable-2"> </span><span class="cm-variable-2">table</span><span class="cm-variable-2"> </span><span class="cm-variable-2">of</span><span class="cm-variable-2"> </span><span class="cm-variable-2">feature</span><span class="cm-variable-2">_</span><span class="cm-variable-2">name</span><span class="cm-variable-2"> </span><span class="cm-variable-2">and</span><span class="cm-variable-2"> </span><span class="cm-variable-2">feature</span><span class="cm-variable-2">_</span><span class="cm-variable-2">coefficient</span><span class="cm-variable-2"> </span><span class="cm-variable-2">from</span><span class="cm-variable-2"> </span><span class="cm-variable-2">the</span><span class="cm-variable-2"> </span><span class="cm-variable-2">Logistic</span><span class="cm-variable-2"> </span><span class="cm-variable-2">Regression</span><span class="cm-variable-2"> </span><span class="cm-variable-2">model.</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span class="cm-tag bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag bracket">&gt;</span><span class="cm-tag bracket">&lt;</span><span class="cm-tag">br</span><span class="cm-tag bracket">&gt;</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">5</div></div><span>Hint</span><span>:</span><span> </span><span>Adapt</span><span> </span><span>the</span><span> </span><span>code</span><span> </span><span>from</span><span> </span><span>here</span><span>:</span><span> </span><span>https</span><span>:</span><span>//stackoverflow.com/questions/42935914/how-to-map-features-from-the-output-of-a-vectorassembler-back-to-the-column-name</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="1ddaed76-60d7-40f2-9d2c-5aec4a4d04ce" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h4><span style="color:darkblue;">Question 8</span></h4>
<ol>
<li>Print out a table of feature_name and feature_coefficient from the Logistic Regression model.
<br><br>
Hint: Adapt the code from here: <a href="https://stackoverflow.com/questions/42935914/how-to-map-features-from-the-output-of-a-vectorassembler-back-to-the-column-name">https://stackoverflow.com/questions/42935914/how-to-map-features-from-the-output-of-a-vectorassembler-back-to-the-column-name</a></li>
</ol>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298399"><i class="fa fa-link"></i>Cmd 85</a><div class="new-notebook command mainCommand command-finished cellIndex-84 cell-825169771298314-825169771298399"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="edit-button edit-button-84 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 196px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="1"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 274px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>14</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 10px; top: 184px; height: 18.4px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">### Question 8.1 Answer ###</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment"># from: https://stackoverflow.com/questions/42935914/how-to-map-features-from-the-output-of-a-vectorassembler-back-to-the-column-name</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">itertools</span> <span class="cm-keyword">import</span> <span class="cm-variable">chain</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">attrs</span> <span class="cm-operator">=</span> <span class="cm-builtin">sorted</span>(</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp;  (<span class="cm-variable">attr</span>[<span class="cm-string">"idx"</span>], <span class="cm-variable">attr</span>[<span class="cm-string">"name"</span>]) <span class="cm-keyword">for</span> <span class="cm-variable">attr</span> <span class="cm-keyword">in</span> (<span class="cm-variable">chain</span>(<span class="cm-operator">*</span><span class="cm-variable">lrCvPredictions</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  .<span class="cm-property">schema</span>[<span class="cm-variable">lrCvModel</span>.<span class="cm-property">bestModel</span>.<span class="cm-property">summary</span>.<span class="cm-property">featuresCol</span>]</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">10</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  .<span class="cm-property">metadata</span>[<span class="cm-string">"ml_attr"</span>][<span class="cm-string">"attrs"</span>].<span class="cm-property">values</span>())))</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">11</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">12</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">lrCvFeatureCoefficients</span> <span class="cm-operator">=</span> <span class="cm-variable">pd</span>.<span class="cm-property">DataFrame</span>([(<span class="cm-variable">name</span>, <span class="cm-variable">lrCvModel</span>.<span class="cm-property">bestModel</span>.<span class="cm-property">coefficients</span>[<span class="cm-variable">idx</span>]) <span class="cm-keyword">for</span> <span class="cm-variable">idx</span>, <span class="cm-variable">name</span> <span class="cm-keyword">in</span> <span class="cm-variable">attrs</span>],<span class="cm-variable">columns</span><span class="cm-operator">=</span>[<span class="cm-string">'feature_name'</span>,<span class="cm-string">'feature_coefficient'</span>])</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">13</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">14</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">lrCvFeatureCoefficients</span>.<span class="cm-property">sort_values</span>(<span class="cm-variable">by</span><span class="cm-operator">=</span>[<span class="cm-string">'feature_coefficient'</span>],<span class="cm-variable">ascending</span><span class="cm-operator">=</span><span class="cm-keyword">False</span>))</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 274px;"></div><div class="CodeMirror-gutters" style="height: 287px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="resizable-wrapper ui-resizable" style="height: 400px;"><div class="noscroll-wrapper noscroll" tabindex="-1"><div class="inner"><div class="results"><div class="ansiout">                                         feature_name  feature_coefficient
20                       educationclassVec_ Doctorate         1.225138e+00
17                     educationclassVec_ Prof-school         1.209750e+00
11                         educationclassVec_ Masters         8.010314e-01
47                         relationshipclassVec_ Wife         7.589803e-01
31                occupationclassVec_ Exec-managerial         6.645506e-01
23         marital_statusclassVec_ Married-civ-spouse         6.435125e-01
43                      relationshipclassVec_ Husband         5.382321e-01
10                       educationclassVec_ Bachelors         4.405790e-01
5                     workclassclassVec_ Self-emp-inc         4.322838e-01
29                 occupationclassVec_ Prof-specialty         4.096262e-01
6                      workclassclassVec_ Federal-gov         4.075811e-01
86                   native_countryclassVec_ Cambodia         3.444299e-01
40                   occupationclassVec_ Tech-support         3.171813e-01
80                     native_countryclassVec_ France         2.480820e-01
41                occupationclassVec_ Protective-serv         2.035538e-01
52                                  sexclassVec_ Male         1.749580e-01
33                          occupationclassVec_ Sales         9.499070e-02
71                      native_countryclassVec_ Japan         8.105796e-02
93                   native_countryclassVec_ Scotland         3.767879e-02
96                                      education_num         2.483800e-02
57                    native_countryclassVec_ Germany         8.191203e-03
99                                     hours_per_week         4.374664e-03
94                                                age         4.156973e-03
76                       native_countryclassVec_ Iran         2.611785e-03
98                                       capital_loss         4.456794e-04
97                                       capital_gain         4.797946e-05
95                                             fnlwgt        -7.498115e-07
58                     native_countryclassVec_ Canada        -8.477189e-03
14                      educationclassVec_ Assoc-acdm        -4.723760e-02
67                      native_countryclassVec_ Italy        -5.696215e-02
..                                                ...                  ...
75                      native_countryclassVec_ Haiti        -6.112316e-01
51                   raceclassVec_ Amer-Indian-Eskimo        -6.145560e-01
91                   native_countryclassVec_ Honduras        -6.189448e-01
60                native_countryclassVec_ El-Salvador        -6.228860e-01
13                            educationclassVec_ 11th        -6.362003e-01
15                            educationclassVec_ 10th        -6.577699e-01
34                  occupationclassVec_ Other-service        -6.732046e-01
38              occupationclassVec_ Handlers-cleaners        -6.782282e-01
42                occupationclassVec_ Priv-house-serv        -7.377453e-01
39                occupationclassVec_ Farming-fishing        -7.430430e-01
45                    relationshipclassVec_ Own-child        -7.451284e-01
65                      native_countryclassVec_ South        -7.465534e-01
88                   native_countryclassVec_ Thailand        -7.724215e-01
24              marital_statusclassVec_ Never-married        -7.775786e-01
82                    native_countryclassVec_ Ecuador        -7.953933e-01
21                         educationclassVec_ 5th-6th        -7.968925e-01
18                             educationclassVec_ 9th        -8.060890e-01
22                         educationclassVec_ 1st-4th        -8.210516e-01
54                     native_countryclassVec_ Mexico        -8.322623e-01
81                     native_countryclassVec_ Greece        -8.397554e-01
79                       native_countryclassVec_ Peru        -8.441932e-01
68         native_countryclassVec_ Dominican-Republic        -8.646429e-01
16                         educationclassVec_ 7th-8th        -9.051719e-01
69                    native_countryclassVec_ Vietnam        -9.330670e-01
90  native_countryclassVec_ Outlying-US(Guam-USVI-...        -9.644833e-01
78                  native_countryclassVec_ Nicaragua        -9.708063e-01
66                      native_countryclassVec_ China        -9.719412e-01
92                    native_countryclassVec_ Hungary        -1.034384e+00
73                   native_countryclassVec_ Columbia        -1.140475e+00
7                      workclassclassVec_ Without-pay        -1.159749e+00

[100 rows x 2 columns]
</div></div></div></div><div class="ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se" style="z-index: 90;"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.92 seconds</span> <span class="command-provenance">-- by jeffreyzhangma@gmail.com</span><span> at 12/24/2019, 1:18:26 PM</span><span title="1224-170603-cleat207"> on My Cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298400"><i class="fa fa-link"></i>Cmd 86</a><div class="new-notebook command mainCommand command-finished cellIndex-85 cell-825169771298314-825169771298400"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="edit-button edit-button-85 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 12px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="1"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 72px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 10px; top: 0px; height: 18.4px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">gbCvFeatureImportance</span> <span class="cm-operator">=</span> <span class="cm-variable">pd</span>.<span class="cm-property">DataFrame</span>([(<span class="cm-variable">name</span>, <span class="cm-variable">gbCvModel</span>.<span class="cm-property">bestModel</span>.<span class="cm-property">featureImportances</span>[<span class="cm-variable">idx</span>]) <span class="cm-keyword">for</span> <span class="cm-variable">idx</span>, <span class="cm-variable">name</span> <span class="cm-keyword">in</span> <span class="cm-variable">attrs</span>],<span class="cm-variable">columns</span><span class="cm-operator">=</span>[<span class="cm-string">'feature_name'</span>,<span class="cm-string">'feature_importance'</span>])</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">gbCvFeatureImportance</span>.<span class="cm-property">sort_values</span>(<span class="cm-variable">by</span><span class="cm-operator">=</span>[<span class="cm-string">'feature_importance'</span>],<span class="cm-variable">ascending</span> <span class="cm-operator">=</span><span class="cm-keyword">False</span>))</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 72px;"></div><div class="CodeMirror-gutters" style="height: 85px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div><div class="resizable-wrapper ui-resizable" style="height: 400px;"><div class="noscroll-wrapper noscroll" tabindex="-1"><div class="inner"><div class="results"><div class="ansiout">                                     feature_name  feature_importance
23     marital_statusclassVec_ Married-civ-spouse        2.501910e-01
97                                   capital_gain        1.719953e-01
96                                  education_num        1.130327e-01
98                                   capital_loss        1.069467e-01
99                                 hours_per_week        9.154046e-02
94                                            age        8.105352e-02
31            occupationclassVec_ Exec-managerial        7.180660e-02
1             workclassclassVec_ Self-emp-not-inc        2.732816e-02
6                  workclassclassVec_ Federal-gov        1.760526e-02
29             occupationclassVec_ Prof-specialty        1.601360e-02
39            occupationclassVec_ Farming-fishing        1.299973e-02
34              occupationclassVec_ Other-service        1.155313e-02
10                   educationclassVec_ Bachelors        4.363659e-03
33                      occupationclassVec_ Sales        3.806693e-03
17                 educationclassVec_ Prof-school        3.610881e-03
14                  educationclassVec_ Assoc-acdm        2.905214e-03
47                     relationshipclassVec_ Wife        2.534018e-03
21                     educationclassVec_ 5th-6th        2.158829e-03
2                    workclassclassVec_ Local-gov        1.888265e-03
27                marital_statusclassVec_ Widowed        1.755568e-03
0                      workclassclassVec_ Private        1.616216e-03
16                     educationclassVec_ 7th-8th        1.216410e-03
9                 educationclassVec_ Some-college        1.154054e-03
11                     educationclassVec_ Masters        7.583156e-04
54                 native_countryclassVec_ Mexico        1.123170e-04
37           occupationclassVec_ Transport-moving        5.337762e-05
15                        educationclassVec_ 10th        2.337447e-17
3                            workclassclassVec_ ?        2.251147e-21
20                   educationclassVec_ Doctorate        0.000000e+00
74                 native_countryclassVec_ Taiwan        0.000000e+00
..                                            ...                 ...
35          occupationclassVec_ Machine-op-inspct        0.000000e+00
12                   educationclassVec_ Assoc-voc        0.000000e+00
13                        educationclassVec_ 11th        0.000000e+00
32               occupationclassVec_ Adm-clerical        0.000000e+00
30               occupationclassVec_ Craft-repair        0.000000e+00
28  marital_statusclassVec_ Married-spouse-absent        0.000000e+00
18                         educationclassVec_ 9th        0.000000e+00
26              marital_statusclassVec_ Separated        0.000000e+00
25               marital_statusclassVec_ Divorced        0.000000e+00
24          marital_statusclassVec_ Never-married        0.000000e+00
19                        educationclassVec_ 12th        0.000000e+00
42            occupationclassVec_ Priv-house-serv        0.000000e+00
43                  relationshipclassVec_ Husband        0.000000e+00
44            relationshipclassVec_ Not-in-family        0.000000e+00
55                      native_countryclassVec_ ?        0.000000e+00
61                  native_countryclassVec_ India        0.000000e+00
22                     educationclassVec_ 1st-4th        0.000000e+00
59            native_countryclassVec_ Puerto-Rico        0.000000e+00
58                 native_countryclassVec_ Canada        0.000000e+00
57                native_countryclassVec_ Germany        0.000000e+00
56            native_countryclassVec_ Philippines        0.000000e+00
53          native_countryclassVec_ United-States        0.000000e+00
45                relationshipclassVec_ Own-child        0.000000e+00
52                              sexclassVec_ Male        0.000000e+00
51               raceclassVec_ Amer-Indian-Eskimo        0.000000e+00
8                      educationclassVec_ HS-grad        0.000000e+00
49                            raceclassVec_ Black        0.000000e+00
48                            raceclassVec_ White        0.000000e+00
46                relationshipclassVec_ Unmarried        0.000000e+00
50               raceclassVec_ Asian-Pac-Islander        0.000000e+00

[100 rows x 2 columns]
</div></div></div></div><div class="ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se" style="z-index: 90;"></div></div><div class="command-result-stats"><span>Command took</span> <span>0.91 seconds</span> <span class="command-provenance">-- by jeffreyzhangma@gmail.com</span><span> at 12/24/2019, 1:20:04 PM</span><span title="1224-170603-cleat207"> on My Cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"><i class="fa fa-minus-square-o"></i></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298401"><i class="fa fa-link"></i>Cmd 87</a><div class="new-notebook command mainCommand command-finished cellIndex-86 cell-825169771298314-825169771298401"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="dashboard-button dashboard-button-86 command-button" title="Show in Dashboard Menu"><i class="fa fa-bar-chart fa-fw"></i></a><a class="edit-button edit-button-86 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>#</span><span>#</span><span>#</span><span>#</span><span class="cm-tag bracket">&lt;</span><span class="cm-tag">span</span><span> </span><span class="cm-attribute">style</span><span>=</span><span class="cm-string">"color:darkblue"</span><span class="cm-tag bracket">&gt;</span><span>Question 9</span><span class="cm-tag bracket">&lt;/</span><span class="cm-tag">span</span><span class="cm-tag bracket">&gt;</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span class="cm-variable-2">1. </span><span class="cm-variable-2">Build</span><span class="cm-variable-2"></span><span class="cm-variable-2"> </span><span class="cm-variable-2">and</span><span class="cm-variable-2"> </span><span class="cm-variable-2">train</span><span class="cm-variable-2"> </span><span class="cm-variable-2">a</span><span class="cm-variable-2"> </span><span class="cm-variable-2">RandomForestClassifier</span><span class="cm-variable-2"> </span><span class="cm-variable-2">and</span><span class="cm-variable-2"> </span><span class="cm-variable-2">print</span><span class="cm-variable-2"> </span><span class="cm-variable-2">out</span><span class="cm-variable-2"> </span><span class="cm-variable-2">a</span><span class="cm-variable-2"> </span><span class="cm-variable-2">table</span><span class="cm-variable-2"> </span><span class="cm-variable-2">of</span><span class="cm-variable-2"> </span><span class="cm-variable-2">feature</span><span class="cm-variable-2"> </span><span class="cm-variable-2">importances</span><span class="cm-variable-2"> </span><span class="cm-variable-2">from</span><span class="cm-variable-2"> </span><span class="cm-variable-2">it.</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="8425218f-2aee-4b2c-80aa-191277c51c4c" style="left: 0px; top: 0px; width: auto; height: auto;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h4><span style="color:darkblue;">Question 9</span></h4>
<ol>
<li>Build and train a RandomForestClassifier and print out a table of feature importances from it.</li>
</ol>
</div></div></div></div></div><!-- dashboardRefreshControlsTemplate -->
<div class="refresh-controls" style="position: absolute; left: 0px; top: 0px; display: none;">
  <hr>
  Last refresh: <span class="last-refresh">Never</span>
  <button class="btn btn-small refresh-now-button">Refresh now</button>
</div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298402"><i class="fa fa-link"></i>Cmd 88</a><div class="new-notebook command mainCommand command-finished cellIndex-87 cell-825169771298314-825169771298402"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="edit-button edit-button-87 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 30.4px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="1"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 238px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>12</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 10px; top: 18.4px; height: 18.4px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">### Question 9.1 Answer ###</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">pyspark</span>.<span class="cm-property">ml</span>.<span class="cm-property">classification</span> <span class="cm-keyword">import</span> <span class="cm-variable">RandomForestClassifier</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">rf</span> <span class="cm-operator">=</span> <span class="cm-variable">RandomForestClassifier</span>(<span class="cm-variable">labelCol</span><span class="cm-operator">=</span><span class="cm-string">"label"</span>, <span class="cm-variable">featuresCol</span><span class="cm-operator">=</span><span class="cm-string">"features"</span>, <span class="cm-variable">numTrees</span><span class="cm-operator">=</span><span class="cm-number">10</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">rfModel</span> <span class="cm-operator">=</span> <span class="cm-variable">rf</span>.<span class="cm-property">fit</span>(<span class="cm-variable">trainingData</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">transformed</span> <span class="cm-operator">=</span> <span class="cm-variable">rfModel</span>.<span class="cm-property">transform</span>(<span class="cm-variable">trainingData</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">10</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">attrs</span> <span class="cm-operator">=</span> <span class="cm-builtin">sorted</span>((<span class="cm-variable">attr</span>[<span class="cm-string">"idx"</span>], <span class="cm-variable">attr</span>[<span class="cm-string">"name"</span>]) <span class="cm-keyword">for</span> <span class="cm-variable">attr</span> <span class="cm-keyword">in</span> (<span class="cm-variable">chain</span>(<span class="cm-operator">*</span><span class="cm-variable">transformed</span>.<span class="cm-property">schema</span>[<span class="cm-string">"features"</span>].<span class="cm-property">metadata</span>[<span class="cm-string">"ml_attr"</span>][<span class="cm-string">"attrs"</span>].<span class="cm-property">values</span>())))</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">11</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">rfFeatureImportance</span> <span class="cm-operator">=</span> <span class="cm-variable">pd</span>.<span class="cm-property">DataFrame</span>([(<span class="cm-variable">name</span>, <span class="cm-variable">rfModel</span>.<span class="cm-property">featureImportances</span>[<span class="cm-variable">idx</span>]) <span class="cm-keyword">for</span> <span class="cm-variable">idx</span>, <span class="cm-variable">name</span> <span class="cm-keyword">in</span> <span class="cm-variable">attrs</span>], <span class="cm-variable">columns</span><span class="cm-operator">=</span>[<span class="cm-string">'feature_name'</span>,<span class="cm-string">'feature_importance'</span>])</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">12</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-builtin">print</span>(<span class="cm-variable">rfFeatureImportance</span>.<span class="cm-property">sort_values</span>(<span class="cm-variable">by</span><span class="cm-operator">=</span>[<span class="cm-string">'feature_importance'</span>],<span class="cm-variable">ascending</span><span class="cm-operator">=</span><span class="cm-keyword">False</span>))</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 238px;"></div><div class="CodeMirror-gutters" style="height: 251px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"><div><p class="clickable-text"><i class="fa fa-fw fa-caret-right"></i>(9) Spark Jobs</p></div></div><div class="dataset-info-view"><div class=""><a class="tree-toggler"><i class="fa fa-caret-right fa-fw"></i><i class="fa fa-list-alt fa-fw"></i><span class="spacing-left">transformed:</span><span class="spacing-left">pyspark.sql.dataframe.DataFrame = [label: double, features: udt ... 18 more fields]</span></a></div><div class="outer-most-struct"></div></div><div class="resizable-wrapper ui-resizable" style="height: 400px;"><div class="noscroll-wrapper noscroll" tabindex="-1"><div class="inner"><div class="results"><div class="ansiout">                                  feature_name  feature_importance
97                                capital_gain            0.187828
96                               education_num            0.129013
23  marital_statusclassVec_ Married-civ-spouse            0.105783
43               relationshipclassVec_ Husband            0.105568
99                              hours_per_week            0.075887
94                                         age            0.071729
45             relationshipclassVec_ Own-child            0.061277
44         relationshipclassVec_ Not-in-family            0.055491
98                                capital_loss            0.046234
31         occupationclassVec_ Exec-managerial            0.043883
10                educationclassVec_ Bachelors            0.027799
52                           sexclassVec_ Male            0.026103
29          occupationclassVec_ Prof-specialty            0.019410
17              educationclassVec_ Prof-school            0.009151
25            marital_statusclassVec_ Divorced            0.008332
47                  relationshipclassVec_ Wife            0.007641
5              workclassclassVec_ Self-emp-inc            0.004276
8                   educationclassVec_ HS-grad            0.002455
3                         workclassclassVec_ ?            0.002046
11                  educationclassVec_ Masters            0.001102
20                educationclassVec_ Doctorate            0.000919
38       occupationclassVec_ Handlers-cleaners            0.000738
33                   occupationclassVec_ Sales            0.000611
36                       occupationclassVec_ ?            0.000588
1          workclassclassVec_ Self-emp-not-inc            0.000556
46             relationshipclassVec_ Unmarried            0.000541
30            occupationclassVec_ Craft-repair            0.000484
26           marital_statusclassVec_ Separated            0.000389
95                                      fnlwgt            0.000360
6               workclassclassVec_ Federal-gov            0.000324
..                                         ...                 ...
7               workclassclassVec_ Without-pay            0.000000
2                 workclassclassVec_ Local-gov            0.000000
14               educationclassVec_ Assoc-acdm            0.000000
41         occupationclassVec_ Protective-serv            0.000000
72              native_countryclassVec_ Poland            0.000000
71               native_countryclassVec_ Japan            0.000000
40            occupationclassVec_ Tech-support            0.000000
27             marital_statusclassVec_ Widowed            0.000000
48                         raceclassVec_ White            0.000000
49                         raceclassVec_ Black            0.000000
22                  educationclassVec_ 1st-4th            0.000000
51            raceclassVec_ Amer-Indian-Eskimo            0.000000
21                  educationclassVec_ 5th-6th            0.000000
53       native_countryclassVec_ United-States            0.000000
19                     educationclassVec_ 12th            0.000000
18                      educationclassVec_ 9th            0.000000
57             native_countryclassVec_ Germany            0.000000
59         native_countryclassVec_ Puerto-Rico            0.000000
60         native_countryclassVec_ El-Salvador            0.000000
61               native_countryclassVec_ India            0.000000
62                native_countryclassVec_ Cuba            0.000000
63             native_countryclassVec_ England            0.000000
64             native_countryclassVec_ Jamaica            0.000000
16                  educationclassVec_ 7th-8th            0.000000
66               native_countryclassVec_ China            0.000000
67               native_countryclassVec_ Italy            0.000000
68  native_countryclassVec_ Dominican-Republic            0.000000
69             native_countryclassVec_ Vietnam            0.000000
42         occupationclassVec_ Priv-house-serv            0.000000
70           native_countryclassVec_ Guatemala            0.000000

[100 rows x 2 columns]
</div></div></div></div><div class="ui-resizable-handle ui-resizable-se ui-icon ui-icon-gripsmall-diagonal-se" style="z-index: 90;"></div></div><div class="command-result-stats"><span>Command took</span> <span>9.50 seconds</span> <span class="command-provenance">-- by jeffreyzhangma@gmail.com</span><span> at 12/24/2019, 1:23:27 PM</span><span title="1224-170603-cleat207"> on My Cluster</span></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="heading-command-wrapper"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314/command/825169771298405"><i class="fa fa-link"></i>Cmd 89</a><div class="new-notebook command mainCommand command-active is-editing command-input cellIndex-88 cell-825169771298314-825169771298405"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort"></i></a><div class="command-buttons"><a class="run-command-button command-button" title="Run Cell"><i class="fa fa-fw fa-play"></i><i class="fa fa-fw fa-caret-down"></i></a><a class="edit-button edit-button-88 command-button" title="Edit Menu"><i class="fa fa-fw fa-chevron-down"></i></a><a class="toggle-collapse-button command-button" title="Minimize"><i class="fa fa-fw fa-minus"></i></a><a class="remove-button command-button" title="Delete"><i class="fa fa-fw fa-remove"></i></a></div><div class="command-input previousPrompt primaryPrompt"><div class="command-text command-text-edit command-text-input"><div class="command-box wrappable"><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap CodeMirror-focused"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 12px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;" tabindex="1"></textarea></div><div class="CodeMirror-vscrollbar" tabindex="-1" cm-not-content="true"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" tabindex="-1" cm-not-content="true"><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 35px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 10px; top: 0px; height: 18.4px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 21px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 35px;"></div><div class="CodeMirror-gutters" style="height: 48px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 29px;"></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner command-stage-info"></div></div></div><div style="clear: both;"></div></div></div></div></div><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell"><i class="fa fa-plus fa-fw"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw"></i></a></div></div><div class="submit-hint">Shift+Enter to run &nbsp;&nbsp;&nbsp;<a class="shortcuts-link" title="View keyboard shortcuts">shortcuts</a></div><div class="contentSpacer" style="background: rgb(255, 255, 255); height: 0px;"></div><div style="min-height: 353px;"></div></div><div class="notebook-footer"></div></div></div><div id="selection-popover" class="hidden add-comment" style="top: 24884.6px; left: 1406px;"><a class="btn btn-default btn-circle"><i class="fa fa-comment-o fa-fw fa-stack"></i></a></div></div></div></div></div>
</div>

<div id="filebrowser-popup" style="left: -316px; display: none;">
    <div class="filebrowser-header">Workspace</div>
    <div class="filebrowser filetree" style="width: 392px; display: none;" data-state="invisible" data-history-size="30"><div class="inner"><div class="ft-panel ui-droppable ui-resizable" style="width: 196px;" data-panel="Workspace"><ul class="ft-panel-list"><li class="filetree-list-item top-link has-menu"><a href="https://community.cloud.databricks.com/?o=2015575843351761#" data-name="Workspace" class="filetree-link" title="Workspace"><i class="fa fa-databricks-does-not-exist fa-fw"></i><span class="filetree-display-name">Workspace</span><div class="dropdown"><i class="fa fa-chevron-down"></i></div></a></li><li class="filetree-list-item"><a href="https://docs.databricks.com/index.html" data-name="Documentation" class="filetree-link" title="Documentation"><i class="fa fa-question fa-fw"></i><span class="filetree-display-name">Documentation</span></a></li><li class="filetree-list-item"><a href="https://docs.databricks.com/release-notes/product/index.html" data-name="Release Notes" class="filetree-link" title="Release Notes"><i class="fa fa-code fa-fw"></i><span class="filetree-display-name">Release Notes</span></a></li><li class="filetree-list-item"><a href="https://docs.databricks.com/spark/latest/training/index.html" data-name="Training &amp; Tutorials" class="filetree-link" title="Training &amp; Tutorials"><i class="fa fa-graduation-cap fa-fw"></i><span class="filetree-display-name">Training &amp; Tutorials</span></a></li><li class="filetree-list-item has-menu"><a href="https://community.cloud.databricks.com/?o=2015575843351761#" data-name="Shared" class="filetree-link ui-droppable" title="Shared"><i class="fa fa-share-alt-square fa-fw"></i><span class="filetree-display-name">Shared</span><div class="dropdown"><i class="fa fa-caret-down"></i></div></a></li><li class="filetree-list-item has-menu"><a href="https://community.cloud.databricks.com/?o=2015575843351761#" data-name="Users" class="filetree-link ui-droppable" title="Users"><i class="fa fa-users fa-fw"></i><span class="filetree-display-name">Users</span><div class="dropdown"><i class="fa fa-caret-down"></i></div></a></li><li class="filetree-list-item has-menu selected"><a href="https://community.cloud.databricks.com/?o=2015575843351761#" data-name="Springboard" class="filetree-link ui-draggable ui-draggable-handle ui-droppable" title="Springboard"><i class="fa fa-folder-o fa-fw"></i><span class="filetree-display-name">Springboard</span><div class="dropdown"><i class="fa fa-caret-down"></i></div></a></li></ul><div class="ui-resizable-handle ui-resizable-e" style="z-index: 90;"></div></div><div class="ft-panel ui-droppable ui-resizable" data-panel="Springboard" style="width: 0px;"><ul class="ft-panel-list"><li class="filetree-list-item top-link has-menu selected"><a href="https://community.cloud.databricks.com/?o=2015575843351761#" data-name="Springboard" class="filetree-link" title="Springboard"><i class="fa fa-databricks-does-not-exist fa-fw"></i><span class="filetree-display-name">Springboard</span><div class="dropdown"><i class="fa fa-chevron-down"></i></div></a></li><li class="filetree-list-item has-menu"><a href="https://community.cloud.databricks.com/?o=2015575843351761#notebook/825169771298314" data-name="Spark DF, SQL, ML Exercise" class="filetree-link ui-draggable ui-draggable-handle" title="Spark DF, SQL, ML Exercise"><i class="fa fa-file-text-o fa-fw" data-cluster-ready="false"></i><span class="filetree-display-name">Spark DF, SQL, ML Exercise</span><div class="dropdown"><i class="fa fa-caret-down"></i></div></a></li></ul><div class="ui-resizable-handle ui-resizable-e" style="z-index: 90;"></div></div></div></div>
<a class="ft-pin-button" href="https://community.cloud.databricks.com/?o=2015575843351761#" title="Pin side panels"></a><a class="ft-scroll-angle-left hidden" href="https://community.cloud.databricks.com/?o=2015575843351761#" title="Scroll to left"><i class="fa fa-angle-left"></i></a><a class="ft-scroll-angle-right hidden" href="https://community.cloud.databricks.com/?o=2015575843351761#" title="Scroll to right"><i class="fa fa-angle-right"></i></a></div>

<div id="projects-filebrowser-popup" style="display: none;">
    <div class="filebrowser-header">
        Projects
        <a class="btn btn-secondary create-project">Create</a>
    </div>
    <div class="filebrowser" style="display: none;"></div>
</div>

<div id="searchpanel-popup">
    <div class="searchpanel ui-resizable" data-panel="Search" style="display: none;" data-state="invisible"><div class="search-panel-content"><a class="ft-pin-button" title="Pin side panels"></a><div class="newsearch"><input class="newsearch searchbox" type="text" placeholder="Search Workspace"><span class="search-mixin-spinner"><i class="fa fa-spinner fa-spin"></i></span></div><ul></ul></div><div class="ui-resizable-handle ui-resizable-e" style="z-index: 90;"></div></div>
</div>

<div id="title-menu" class="tb-title-menu dropdown-menu" role="menu"></div>

<div id="user-menu" class="dropdown-menu"><div class="user-menu-view"><div class="account-section"><div class="header" title="jeffreyzhangma@gmail.com">Signed in as <br><b>jeffreyzhangma@gmail.com</b></div><ul><li><a href="https://community.cloud.databricks.com/?o=2015575843351761#setting/account" class="accounts-link settings-button"><div class="accounts-text">User Settings</div></a></li><li><a href="https://community.cloud.databricks.com/?o=2015575843351761#setting/accounts" class="accounts-link admin-console-button"><div class="accounts-text">Admin Console</div></a></li><li><a href="https://accounts.cloud.databricks.com/registration.html#login" class="accounts-link manage-account-button"><div class="accounts-text">Manage Account</div></a></li><li><a href="https://community.cloud.databricks.com/?o=2015575843351761#setting/logout" class="accounts-link logout-button"><div class="accounts-text">Log Out</div></a></li></ul></div><hr><div><div class="org-section"><div class="header">Workspaces</div><ul class="confirmed-workspaces"><li><a class="workspace-link" data-name="Springboard" target="_blank" title="Springboard (jeffreyzhangma@gmail.com)"><div class="workspace-item"><div class="workspace-text"><div class="icon"><i class="fa fa-check"></i></div><div class="workspace-name">Springboard</div></div><div class="workspace-owner">jeffreyzhangma@gmail.com</div></div></a></li></ul></div></div></div></div>

<ul id="help-menu" class="dropdown-menu newhelp"><div><div class="input"><i class="fa fa-search fa-fw"></i><input class="newsearch" type="text" placeholder="Search guide &amp; forum"><span class="search-mixin-spinner"><i class="fa fa-spinner fa-spin"></i></span></div><ul style="max-height: 592.6px;"><li class="result"><a href="https://docs.databricks.com/" class="" data-name="Documentation" title="Documentation"><i class="fa fa-book fa-fw"></i><span>Documentation</span></a></li><li class="result"><a href="https://docs.databricks.com/api/index.html" class="" data-name="REST API Docs" title="REST API Docs"><i class="fa fa-book fa-fw"></i><span>REST API Docs</span></a></li><li class="result"><a href="http://forums.databricks.com/" class="" data-name="Community Forum" title="Community Forum"><i class="fa fa-question fa-fw"></i><span>Community Forum</span></a></li><li class="result"><a href="https://community.cloud.databricks.com/SHORTCUT_URL" class="" data-name="Shortcuts" title="Shortcuts"><i class="fa fa-keyboard-o fa-fw"></i><span>Shortcuts</span></a></li><li class="result"><a href="mailto:feedback@databricks.com" class="" data-name="Feedback" title="Feedback"><i class="fa fa-envelope fa-fw"></i><span>Feedback</span></a></li></ul></div></ul>


<div id="hidden" style="display: none;"></div>
<div id="history" style="display: none;"><div id="history-head">
  
  <h3 class="history-title">
    Recent Activity
    <i class="hide-recent-activity remove-button fa fa-remove fa-fw"></i>
  </h3>
  
</div>

<div id="history-list">
  <ul>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        J
      </div>
      <div class="history-item-action">
        <p class="user-name">jeffreyzhangma@gmail.com:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2019-12-24 13:23:26</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        J
      </div>
      <div class="history-item-action">
        <p class="user-name">jeffreyzhangma@gmail.com:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2019-12-24 13:20:04</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        J
      </div>
      <div class="history-item-action">
        <p class="user-name">jeffreyzhangma@gmail.com:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2019-12-24 13:18:26</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        J
      </div>
      <div class="history-item-action">
        <p class="user-name">jeffreyzhangma@gmail.com:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2019-12-24 13:17:57</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        J
      </div>
      <div class="history-item-action">
        <p class="user-name">jeffreyzhangma@gmail.com:</p>
        <p class="user-message">Added a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2019-12-24 13:17:57</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        J
      </div>
      <div class="history-item-action">
        <p class="user-name">jeffreyzhangma@gmail.com:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2019-12-24 13:17:27</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        J
      </div>
      <div class="history-item-action">
        <p class="user-name">jeffreyzhangma@gmail.com:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2019-12-24 13:17:23</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        J
      </div>
      <div class="history-item-action">
        <p class="user-name">jeffreyzhangma@gmail.com:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2019-12-24 13:16:23</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        J
      </div>
      <div class="history-item-action">
        <p class="user-name">jeffreyzhangma@gmail.com:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2019-12-24 13:16:13</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        J
      </div>
      <div class="history-item-action">
        <p class="user-name">jeffreyzhangma@gmail.com:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2019-12-24 13:15:31</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        J
      </div>
      <div class="history-item-action">
        <p class="user-name">jeffreyzhangma@gmail.com:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2019-12-24 13:15:29</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        J
      </div>
      <div class="history-item-action">
        <p class="user-name">jeffreyzhangma@gmail.com:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2019-12-24 13:15:14</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        J
      </div>
      <div class="history-item-action">
        <p class="user-name">jeffreyzhangma@gmail.com:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2019-12-24 13:14:56</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        J
      </div>
      <div class="history-item-action">
        <p class="user-name">jeffreyzhangma@gmail.com:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2019-12-24 13:14:48</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        J
      </div>
      <div class="history-item-action">
        <p class="user-name">jeffreyzhangma@gmail.com:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2019-12-24 13:14:40</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        J
      </div>
      <div class="history-item-action">
        <p class="user-name">jeffreyzhangma@gmail.com:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2019-12-24 13:08:12</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        J
      </div>
      <div class="history-item-action">
        <p class="user-name">jeffreyzhangma@gmail.com:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2019-12-24 13:07:36</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        J
      </div>
      <div class="history-item-action">
        <p class="user-name">jeffreyzhangma@gmail.com:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2019-12-24 13:06:02</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        J
      </div>
      <div class="history-item-action">
        <p class="user-name">jeffreyzhangma@gmail.com:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2019-12-24 13:05:54</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        J
      </div>
      <div class="history-item-action">
        <p class="user-name">jeffreyzhangma@gmail.com:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2019-12-24 12:37:28</p>
      </div>
    </li>
    
  </ul>
</div>
</div>

<div id="debugHelper" style="background-color: white; z-index: 1000; display: none; position: fixed; right: 190px; bottom: 0px;">
    <div id="debugRoute" style="position: fixed; right: 190px; bottom: 40px;">shard-ce1-webapp-5bff4bb659-chpp7</div>
    <div id="debugCounters" style="position: fixed; right: 50px; bottom: 20px;"></div>
    <a href="https://community.cloud.databricks.com/ops/">[OPS]</a>
    <a href="https://community.cloud.databricks.com/ops/debug">Debug</a>
    <a href="https://community.cloud.databricks.com/ops/metrics">Metrics</a>
    <a href="https://community.cloud.databricks.com/ops/requests">Requests</a>
</div>

<!--
  This HTML file is a template.
  If you open it directly in the browser, you will see an empty page.

  You can add webfonts, meta tags, or analytics to this file.
  The build step will place the bundled scripts into the <body> tag.

  To begin the development, run `npm start` or `yarn start`.
  To create a production bundle, use `npm run build` or `yarn build`.
-->
<script type="text/javascript" src="./Spark DF, SQL, ML Exercise - Databricks Community Edition_files/metrics-graphics.82840a7f.js.download"></script><script type="text/javascript" src="./Spark DF, SQL, ML Exercise - Databricks Community Edition_files/main.407da55d.js.download"></script>

<div class="filebrowser-context-menu dropdown-menu active" data-id="825169771298313" role="menu" style="display: none; left: 422px; top: 82px;"><li class="dropdown-submenu"><a href="https://community.cloud.databricks.com/?o=2015575843351761#" data-name="Create">Create</a><ul class="dropdown-menu"><li><a href="https://community.cloud.databricks.com/?o=2015575843351761#" data-name="Notebook">Notebook</a></li><li><a href="https://community.cloud.databricks.com/?o=2015575843351761#" data-name="Library">Library</a></li><li><a href="https://community.cloud.databricks.com/?o=2015575843351761#" data-name="Folder">Folder</a></li><li><a href="https://community.cloud.databricks.com/?o=2015575843351761#" data-name="MLflow Experiment">MLflow Experiment</a></li></ul></li><li><a href="https://community.cloud.databricks.com/?o=2015575843351761#" data-name="Clone">Clone</a></li><li><a href="https://community.cloud.databricks.com/?o=2015575843351761#" data-name="Rename">Rename</a></li><li><a href="https://community.cloud.databricks.com/?o=2015575843351761#" data-name="Move">Move</a></li><li><a href="https://community.cloud.databricks.com/?o=2015575843351761#" data-name="Delete">Delete</a></li><li><a href="https://community.cloud.databricks.com/?o=2015575843351761#" data-name="Import">Import</a></li><li class="dropdown-submenu"><a href="https://community.cloud.databricks.com/?o=2015575843351761#" data-name="Export">Export</a><ul class="dropdown-menu"><li><a href="https://community.cloud.databricks.com/?o=2015575843351761#" data-name="DBC Archive">DBC Archive</a></li><li><a href="https://community.cloud.databricks.com/?o=2015575843351761#" data-name="HTML">HTML</a></li></ul></li><li><a href="https://community.cloud.databricks.com/?o=2015575843351761#" data-name="Permissions" disabled="true">Permissions</a></li></div><input type="file" multiple="multiple" class="dz-hidden-input" style="visibility: hidden; position: absolute; top: 0px; left: 0px; height: 0px; width: 0px;"><input type="file" class="dz-hidden-input" accept=".dbc, .scala, .py, .sql, .r, .ipynb, .Rmd, .html" style="visibility: hidden; position: absolute; top: 0px; left: 0px; height: 0px; width: 0px;"><input type="file" class="dz-hidden-input" accept=".dbc, .scala, .py, .sql, .r, .ipynb, .Rmd, .html" style="visibility: hidden; position: absolute; top: 0px; left: 0px; height: 0px; width: 0px;"><div class="ReactModalPortal"></div><div style="position: absolute; top: 0px; left: 0px; width: 100%;"><div><div class="rc-tooltip  rc-tooltip-placement-bottom  rc-tooltip-hidden" style="left: 1014px; top: 78px;"><div class="rc-tooltip-content"><div class="rc-tooltip-arrow"></div><div class="rc-tooltip-inner">This notebook will be published publicly and anyone with the link can view it</div></div></div></div></div><div style="position: absolute; top: 0px; left: 0px; width: 100%;"><div><div class="rc-tooltip  rc-tooltip-placement-bottom  rc-tooltip-hidden" style="left: 62px; top: 76px;"><div class="rc-tooltip-content"><div class="rc-tooltip-arrow"></div><div class="rc-tooltip-inner">Not attached to a cluster. Select a cluster to attach.</div></div></div></div></div><div style="position: absolute; top: 0px; left: 0px; width: 100%;"><div><div class="rc-tooltip  rc-tooltip-placement-bottom  rc-tooltip-hidden" style="left: 61px; top: 39px;"><div class="rc-tooltip-content"><div class="rc-tooltip-arrow"></div><div class="rc-tooltip-inner">Workspace/Springboard/Spark DF, SQL, ML Exercise</div></div></div></div></div></body></html>